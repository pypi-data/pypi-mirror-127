import numpy as np
from cgmml.models.HRNET.code.utils.utils import rot

keypoints = np.array([[224.1867, 124.185524],
                      [244.67937, 99.59434],
                      [195.497, 95.495804],
                      [265.17203, 107.791405],
                      [142.21608, 107.791405],
                      [265.17203, 197.95909],
                      [125.82196, 197.95909],
                      [355.33972, 197.95909],
                      [31.555733, 197.95909],
                      [297.96027, 132.38258],
                      [101.23077, 132.38258],
                      [240.58084, 411.08273],
                      [162.70874, 415.18127],
                      [248.77791, 497.1519],
                      [170.9058, 497.1519],
                      [256.97498, 579.1225],
                      [170.9058, 575.024]])

rotated_keypoints_counterclockwise = [[124.185524, 855.8133], [99.59434, 835.3206299999999],
                                      [95.495804, 884.5029999999999],
                                      [107.791405, 814.82797], [107.791405, 937.78392], [197.95909, 814.82797],
                                      [197.95909, 954.17804], [197.95909, 724.6602800000001], [197.95909, 1048.444267],
                                      [132.38258, 782.03973], [132.38258, 978.76923], [411.08273, 839.41916],
                                      [415.18127, 917.29126], [497.1519, 831.22209], [497.1519, 909.0942],
                                      [579.1225, 823.02502], [575.024, 909.0942]]

rotated_keypoints_clockwise = [[1795.814476, 224.1867], [1820.40566, 244.67937], [1824.504196, 195.497],
                               [1812.208595, 265.17203], [1812.208595, 142.21608], [1722.04091, 265.17203],
                               [1722.04091, 125.82196], [1722.04091, 355.33972], [1722.04091, 31.555733],
                               [1787.61742, 297.96027], [1787.61742, 101.23077], [1508.91727, 240.58084],
                               [1504.81873, 162.70874], [1422.8481, 248.77791], [1422.8481, 170.9058],
                               [1340.8775, 256.97498], [1344.976, 170.9058]]


def test_rot_counterclockwise():
    height = 1080
    width = 1920
    pose_keypoints = rot(keypoints, 'ROTATE_90_COUNTERCLOCKWISE', height, width)
    assert pose_keypoints == rotated_keypoints_counterclockwise


def test_rot_clockwise():
    height = 1080
    width = 1920
    pose_keypoints = rot(keypoints, 'ROTATE_90_CLOCKWISE', height, width)
    assert pose_keypoints == rotated_keypoints_clockwise
