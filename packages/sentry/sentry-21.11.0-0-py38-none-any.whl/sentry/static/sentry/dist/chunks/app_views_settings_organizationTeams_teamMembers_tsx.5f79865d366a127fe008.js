"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_organizationTeams_teamMembers_tsx"],{"./app/actionCreators/teams.tsx":(e,t,s)=>{s.d(t,{PX:()=>d,eM:()=>c,z_:()=>p,fs:()=>l,um:()=>u,s:()=>h,Cm:()=>g,tT:()=>b}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=s("./app/actionCreators/indicator.tsx"),r=s("./app/actions/teamActions.tsx"),o=s("./app/locale.tsx"),n=s("./app/utils/callIfFunction.tsx"),i=s("./app/utils/guid.tsx");const m=(e={},t,...s)=>{(0,n.g)(e[t],...s)};async function d(e,t){const s=await e.requestPromise("/organizations/".concat(t.orgId,"/user-teams/"));r.Z.loadUserTeams(s)}function c(e,t,s){return r.Z.fetchDetails(t.teamId),e.request("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{success:e=>{r.Z.fetchDetailsSuccess(t.teamId,e),m(s,"success",e)},error:e=>{r.Z.fetchDetailsError(t.teamId,e),m(s,"error",e)}})}function p(e,t){r.Z.updateSuccess(e,t)}function l(e,t,s){const a="/teams/".concat(t.orgId,"/").concat(t.teamId,"/");return r.Z.update(t.teamId,t.data),e.request(a,{method:"PUT",data:t.data,success:e=>{p(t.teamId,e),m(s,"success",e)},error:e=>{r.Z.updateError(t.teamId,e),m(s,"error",e)}})}function u(e,t,s){var a;const o="/organizations/".concat(t.orgId,"/members/").concat(null!==(a=t.memberId)&&void 0!==a?a:"me","/teams/").concat(t.teamId,"/"),n=(0,i.E)();return r.Z.update(n,t.teamId),e.request(o,{method:"POST",success:e=>{r.Z.updateSuccess(t.teamId,e),m(s,"success",e)},error:e=>{r.Z.updateError(n,t.teamId,e),m(s,"error",e)}})}function h(e,t,s){const a="/organizations/".concat(t.orgId,"/members/").concat(t.memberId||"me","/teams/").concat(t.teamId,"/"),o=(0,i.E)();return r.Z.update(o,t.teamId),e.request(a,{method:"DELETE",success:e=>{r.Z.updateSuccess(t.teamId,e),m(s,"success",e)},error:e=>{r.Z.updateError(o,t.teamId,e),m(s,"error",e)}})}function g(e,t,s){return r.Z.createTeam(t),e.requestPromise("/organizations/".concat(s.orgId,"/teams/"),{method:"POST",data:t}).then((e=>(r.Z.createTeamSuccess(e),(0,a.S9)((0,o._N)("[team] has been added to the [organization] organization",{team:"#".concat(e.slug),organization:s.orgId})),e)),(e=>{throw r.Z.createTeamError(t.slug,e),(0,a.Iw)((0,o._N)("Unable to create [team] in the [organization] organization",{team:"#".concat(t.slug),organization:s.orgId})),e}))}function b(e,t){return r.Z.removeTeam(t.teamId),e.requestPromise("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{method:"DELETE"}).then((e=>(r.Z.removeTeamSuccess(t.teamId,e),(0,a.S9)((0,o._N)("[team] has been removed from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e)),(e=>{throw r.Z.removeTeamError(t.teamId,e),(0,a.Iw)((0,o._N)("Unable to remove [team] from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e}))}},"./app/views/settings/organizationTeams/teamMembers.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),n=s("../node_modules/lodash/debounce.js"),i=s.n(n),m=s("./app/actionCreators/indicator.tsx"),d=s("./app/actionCreators/modal.tsx"),c=s("./app/actionCreators/teams.tsx"),p=s("./app/components/avatar/userAvatar.tsx"),l=s("./app/components/button.tsx"),u=s("./app/components/dropdownAutoComplete/index.tsx"),h=s("./app/components/dropdownButton.tsx"),g=s("./app/components/idBadge/index.tsx"),b=s("./app/components/links/link.tsx"),I=s("./app/components/loadingError.tsx"),Z=s("./app/components/loadingIndicator.tsx"),f=s("./app/components/panels/index.tsx"),w=s("./app/icons/index.tsx"),x=s("./app/locale.tsx"),M=s("./app/styles/overflowEllipsis.tsx"),v=s("./app/styles/space.tsx"),z=s("./app/utils/withApi.tsx"),y=s("./app/utils/withConfig.tsx"),S=s("./app/utils/withOrganization.tsx"),T=s("./app/views/settings/components/emptyMessage.tsx"),q=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class _ extends o.Component{constructor(...e){super(...e),(0,a.Z)(this,"state",{loading:!0,error:!1,dropdownBusy:!1,teamMemberList:[],orgMemberList:[]}),(0,a.Z)(this,"debouncedFetchMembersRequest",i()((e=>this.setState({dropdownBusy:!0},(()=>this.fetchMembersRequest(e)))),200)),(0,a.Z)(this,"fetchMembersRequest",(async e=>{const{params:t,api:s}=this.props,{orgId:a}=t;try{const t=await s.requestPromise("/organizations/".concat(a,"/members/"),{query:{query:e}});this.setState({orgMemberList:t,dropdownBusy:!1})}catch(e){(0,m.Iw)((0,x.t)("Unable to load organization members."),{duration:2e3}),this.setState({dropdownBusy:!1})}})),(0,a.Z)(this,"fetchData",(async()=>{const{api:e,params:t}=this.props;try{const s=await e.requestPromise("/teams/".concat(t.orgId,"/").concat(t.teamId,"/members/"));this.setState({teamMemberList:s,loading:!1,error:!1})}catch(e){this.setState({loading:!1,error:!0})}this.fetchMembersRequest("")})),(0,a.Z)(this,"addTeamMember",(e=>{const{params:t}=this.props;this.setState({loading:!0}),this.debouncedFetchMembersRequest(""),(0,c.um)(this.props.api,{orgId:t.orgId,teamId:t.teamId,memberId:e.value},{success:()=>{const t=this.state.orgMemberList.find((t=>t.id===e.value));void 0!==t&&(this.setState({loading:!1,error:!1,teamMemberList:this.state.teamMemberList.concat([t])}),(0,m.S9)((0,x.t)("Successfully added member to team.")))},error:()=>{this.setState({loading:!1}),(0,m.Iw)((0,x.t)("Unable to add team member."))}})})),(0,a.Z)(this,"handleMemberFilterChange",(e=>{this.setState({dropdownBusy:!0}),this.debouncedFetchMembersRequest(e.target.value)}))}componentDidMount(){this.fetchData()}UNSAFE_componentWillReceiveProps(e){const t=this.props.params;e.params.teamId===t.teamId&&e.params.orgId===t.orgId||this.setState({loading:!0,error:!1},this.fetchData)}removeMember(e){const{params:t}=this.props;(0,c.s)(this.props.api,{orgId:t.orgId,teamId:t.teamId,memberId:e.id},{success:()=>{this.setState({teamMemberList:this.state.teamMemberList.filter((t=>t.id!==e.id))}),(0,m.S9)((0,x.t)("Successfully removed member from team."))},error:()=>(0,m.Iw)((0,x.t)("There was an error while trying to remove a member from the team."))})}renderDropdown(e){const{organization:t,params:s}=this.props,a=new Set(this.state.teamMemberList.map((e=>e.id))),r=!(null==t||!t.openMembership)||e,o=(this.state.orgMemberList||[]).filter((e=>!a.has(e.id))).map((e=>({searchKey:"".concat(e.name," ").concat(e.email),value:e.id,label:(0,q.BX)(E,{children:[(0,q.tZ)(k,{user:e,size:24,className:"avatar"}),(0,q.tZ)(L,{children:e.name||e.email})]})}))),n=(0,q.BX)(B,{children:[(0,x.t)("Members"),(0,q.tZ)(j,{to:"",onClick:()=>(0,d.openInviteMembersModal)({source:"teams"}),"data-test-id":"invite-member",children:(0,x.t)("Invite Member")})]});return(0,q.tZ)(u.Z,{items:o,alignMenu:"right",onSelect:r?this.addTeamMember:e=>(0,d.openTeamAccessRequestModal)({teamId:s.teamId,orgId:s.orgId,memberId:e.value}),menuHeader:n,emptyMessage:(0,x.t)("No members"),onChange:this.handleMemberFilterChange,busy:this.state.dropdownBusy,onClose:()=>this.debouncedFetchMembersRequest(""),children:({isOpen:e})=>(0,q.tZ)(h.Z,{isOpen:e,size:"xsmall","data-test-id":"add-member",children:(0,x.t)("Add Member")})})}removeButton(e){return(0,q.tZ)(l.ZP,{size:"small",icon:(0,q.tZ)(w.JZ,{size:"xs",isCircled:!0}),onClick:()=>this.removeMember(e),label:(0,x.t)("Remove"),children:(0,x.t)("Remove")})}render(){if(this.state.loading)return(0,q.tZ)(Z.Z,{});if(this.state.error)return(0,q.tZ)(I.Z,{onRetry:this.fetchData});const{params:e,organization:t,config:s}=this.props,{access:a}=t,r=a.includes("org:write")||a.includes("team:admin");return(0,q.BX)(f.s_,{children:[(0,q.BX)(f.V9,{hasButtons:!0,children:[(0,q.tZ)("div",{children:(0,x.t)("Members")}),(0,q.tZ)("div",{style:{textTransform:"none"},children:this.renderDropdown(r)})]}),this.state.teamMemberList.length?this.state.teamMemberList.map((t=>{const a=t.email===s.user.email,o=r||a;return(0,q.BX)(C,{children:[(0,q.tZ)(g.Z,{avatarSize:36,member:t,useLink:!0,orgId:e.orgId}),o&&this.removeButton(t)]},t.id)})):(0,q.tZ)(T.Z,{icon:(0,q.tZ)(w.qO,{size:"xl"}),size:"large",children:(0,x.t)("This team has no members")})]})}}_.displayName="TeamMembers";const C=(0,r.Z)(f.Lv,{target:"ekipw4c5"})({name:"zanomh",styles:"justify-content:space-between;align-items:center"}),E=(0,r.Z)("div",{target:"ekipw4c4"})("display:grid;grid-template-columns:max-content 1fr;grid-gap:",(0,v.Z)(.5),";align-items:center;"),L=(0,r.Z)("div",{target:"ekipw4c3"})("font-size:",(e=>e.theme.fontSizeSmall),";",M.Z,";"),k=(0,r.Z)((e=>(0,q.tZ)(p.Z,{...e})),{target:"ekipw4c2"})({name:"1dy9mco",styles:"min-width:1.75em;min-height:1.75em;width:1.5em;height:1.5em"}),B=(0,r.Z)("div",{target:"ekipw4c1"})("display:grid;grid-template-columns:1fr max-content;padding:",(0,v.Z)(1)," 0;font-size:",(e=>e.theme.fontSizeExtraSmall),";text-transform:uppercase;"),j=(0,r.Z)(b.Z,{target:"ekipw4c0"})({name:"kxbue8",styles:"text-transform:none"}),D=(0,y.Z)((0,z.Z)((0,S.Z)(_)))}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationTeams_teamMembers_tsx.e15960109314bb34ed8d887131d9acf5.js.map