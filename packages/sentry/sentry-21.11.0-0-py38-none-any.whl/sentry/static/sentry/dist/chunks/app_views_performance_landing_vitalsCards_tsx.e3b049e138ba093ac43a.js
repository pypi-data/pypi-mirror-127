"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_performance_landing_vitalsCards_tsx"],{"./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx":(t,e,i)=>{i.d(e,{Z:()=>u}),i("../node_modules/core-js/modules/web.dom-collections.iterator.js"),i("../node_modules/react/index.js");var n=i("../node_modules/lodash/pick.js"),a=i.n(n),r=i("./app/utils/discover/genericDiscoverQuery.tsx"),o=i("./app/utils/performance/constants.tsx"),s=i("./app/utils/withApi.tsx"),l=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(t){const{eventView:e,vitals:i}=t,n=null==e?void 0:e.getEventsAPIPayload(t.location);return{vital:i,...a()(n,["query",...Object.values(o.s)])}}function c(t){return(0,l.tZ)(r.ZP,{getRequestPayload:d,route:"events-vitals",...t,children:({tableData:e,...i})=>t.children({vitalsData:e,...i})})}c.displayName="VitalsCardsDiscoverQuery";const u=(0,s.Z)(c)},"./app/views/performance/landing/vitalsCards.tsx":(t,e,i)=>{i.d(e,{M9:()=>W,q7:()=>X,aU:()=>J,JO:()=>tt});var n=i("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(i("../node_modules/core-js/modules/es.symbol.description.js"),i("../node_modules/react/index.js")),r=i("../node_modules/@sentry/minimal/esm/index.js"),o=i("./app/components/card.tsx"),s=i("./app/components/charts/eventsRequest.tsx"),l=i("./app/components/charts/styles.tsx"),d=i("./app/components/charts/utils.tsx"),c=i("./app/components/emptyStateWarning.tsx"),u=i("./app/components/links/link.tsx"),p=i("./app/components/placeholder.tsx"),m=i("./app/components/questionTooltip.tsx"),h=i("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),v=i("../node_modules/react-sparklines/build/index.js"),g=i("../node_modules/prop-types/index.js"),f=i.n(g);class Z extends v.Sparklines{}(0,h.Z)(Z,"propTypes",{children:f().node,data:f().array,limit:f().number,width:f().number,height:f().number,svgWidth:f().number,svgHeight:f().number,preserveAspectRatio:f().string,margin:f().number,style:f().object,min:f().number,max:f().number,onMouseMove:f().func});var x=i("./app/locale.tsx"),y=i("./app/styles/overflowEllipsis.tsx"),b=i("./app/styles/space.tsx"),w=i("./app/utils.tsx"),k=i("./app/utils/dates.tsx"),S=i("./app/utils/discover/discoverQuery.tsx"),_=i("./app/utils/discover/fields.tsx"),j=i("./app/utils/performance/vitals/constants.tsx"),P=i("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),N=i("./app/utils/queryString.tsx"),C=i("./app/utils/theme.tsx"),A=i("./app/utils/useApi.tsx"),D=i("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const H=t=>(0,D.tZ)(O,{barHeight:t.barHeight,fractions:t.colorStops.map((({percent:t})=>t)),children:t.colorStops.map((t=>(0,D.tZ)(z,{color:t.color},t.color)))});H.displayName="ColorBar";const O=(0,n.Z)("div",{target:"etd41501"})("height:",(t=>t.barHeight?"".concat(t.barHeight,"px"):"16px"),";width:100%;overflow:hidden;position:relative;background:",(t=>t.theme.gray100),";display:grid;grid-template-columns:",(t=>t.fractions.map((t=>"".concat(t,"fr"))).join(" ")),";margin-bottom:",(t=>t.barHeight?"":(0,b.Z)(1)),";border-radius:2px;"),z=(0,n.Z)("div",{target:"etd41500"})("background-color:",(t=>t.theme[t.color]),";"),B=H;var M=i("./app/views/performance/vitalDetail/utils.tsx"),q=i("./app/components/tooltip.tsx"),L=i("./app/utils/formatters.tsx");function V(t,e){const i=Array.isArray(t)||t===_.Zl.CLS?"":"ms";switch(e){case M.SP.POOR:return Array.isArray(t)?(0,x.t)("Poor"):(0,x._N)("Poor: >[threshold][unit]",{threshold:M.eE[t],unit:i});case M.SP.MEH:return Array.isArray(t)?(0,x.t)("Meh"):(0,x._N)("Meh: >[threshold][unit]",{threshold:M.MN[t],unit:i});case M.SP.GOOD:return Array.isArray(t)?(0,x.t)("Good"):(0,x._N)("Good: <[threshold][unit]",{threshold:M.MN[t],unit:i});default:return null}}function E(t){return(0,D.tZ)(F,{children:t.percents.map((e=>(0,D.tZ)(q.Z,{title:V(t.vital,e.vitalState),children:(0,D.BX)(G,{children:[M.Np[e.vitalState],(0,D.BX)("span",{children:[t.showVitalPercentNames&&(0,x.t)("".concat(e.vitalState))," ",(0,L.rl)(e.percent,0)]})]})},e.vitalState)))})}E.displayName="VitalPercents";const F=(0,n.Z)("div",{target:"ex3thpn1"})("display:inline-grid;grid-auto-flow:column;gap:",(0,b.Z)(2),";"),G=(0,n.Z)("div",{target:"ex3thpn0"})("display:flex;align-items:center;gap:",(0,b.Z)(.5),";font-size:",(t=>t.theme.fontSizeMedium),";");var I=i("./app/views/performance/landing/utils.tsx");function X(t){const{eventView:e,location:i,organization:n,projects:a,frontendOnly:r=!1}=t;if(r&&(0,I.Oo)(a,e)!==I.BY.FRONTEND_PAGELOAD)return null;const o=[_.Zl.FCP,_.Zl.LCP,_.Zl.FID,_.Zl.CLS];return(0,D.tZ)(P.Z,{eventView:e,location:i,orgSlug:n.slug,vitals:o,children:({isLoading:t,vitalsData:a})=>(0,D.tZ)($,{children:o.map((r=>{var o,s,l;const d=(0,M.i4)({orgSlug:n.slug,query:e.generateQueryStringObject(),vitalName:r,projectID:(0,N.qP)(i.query.project)}),c=t?"—":rt(null!==(o=null==a?void 0:a[r])&&void 0!==o?o:null,r),p=(0,D.tZ)(Q,{children:(0,D.tZ)(tt,{isLoading:t,vital:r,data:a})});return(0,D.tZ)(u.Z,{to:d,"data-test-id":"vitals-linked-card-".concat(M.a7[r]),children:(0,D.tZ)(it,{title:null!==(s=M.jo[r])&&void 0!==s?s:"",tooltip:null!==(l=j.r[r].description)&&void 0!==l?l:"",value:t?"—":c,chart:p,minHeight:150})},r)}))})})}X.displayName="FrontendCards";const Q=(0,n.Z)("div",{target:"e1he14ku8"})("margin-top:",(0,b.Z)(1.5),";");function R(t){const e=(0,A.Z)(),{eventView:i,location:n,organization:a,functions:o}=t,{query:l}=n,c=i.withColumns(o),u=c.getGlobalSelection(),p=u.datetime.start?(0,k.hC)(u.datetime.start):void 0,m=u.datetime.end?(0,k.hC)(u.datetime.end):void 0,h="string"==typeof l.sparkInterval?l.sparkInterval:(0,d.ZS)({start:p||null,end:m||null,period:u.datetime.period},"low"),v=c.getEventsAPIPayload(n);return(0,D.tZ)(S.Z,{location:n,eventView:c,orgSlug:a.slug,limit:1,referrer:"api.performance.vitals-cards",children:({isLoading:t,tableData:i})=>(0,D.tZ)(s.Z,{api:e,organization:a,period:u.datetime.period,project:u.projects,environment:u.environments,team:v.team,start:p,end:m,interval:h,query:v.query,includePrevious:!1,yAxis:c.getFields(),partial:!0,children:({results:e})=>{const n=null==e?void 0:e.reduce(((t,e)=>(t[e.seriesName]=e.data.map((t=>t.value)),t)),{}),s=(0,I.hv)(a);return(0,D.tZ)($,{children:o.map((e=>{var a,o;let l=(0,_.sN)(e);l.includes("apdex")&&(l="apdex()");const d=s[l];if(!d)return r.uT("Missing field '".concat(l,"' in vital cards.")),null;const{title:c,tooltip:u,formatter:p}=d,m=(0,_.LY)(l),h=null==i||null===(a=i.data)||void 0===a||null===(o=a[0])||void 0===o?void 0:o[m],v=null==n?void 0:n[l],g=t||!(0,w.ri)(h)?"—":p(h),f=(0,D.tZ)(U,{data:v});return(0,D.tZ)(it,{title:c,tooltip:u,value:g,chart:f,horizontal:!0,minHeight:96,isNotInteractive:!0},l)}))})}})})}function T(t){return(0,D.tZ)(R,{...t,functions:[{kind:"function",function:["p75","transaction.duration",void 0,void 0]},{kind:"function",function:["tpm","",void 0,void 0]},{kind:"function",function:["failure_rate","",void 0,void 0]},{kind:"function",function:["apdex","",void 0,void 0]}]})}R.displayName="GenericCards",T.displayName="_BackendCards";const W=T;function Y(t){const e=[{kind:"function",function:["p75","measurements.app_start_cold",void 0,void 0]},{kind:"function",function:["p75","measurements.app_start_warm",void 0,void 0]}];return t.showStallPercentage?e.push({kind:"function",function:["p75","measurements.stall_percentage",void 0,void 0]}):(e.push({kind:"function",function:["p75","measurements.frames_slow_rate",void 0,void 0]}),e.push({kind:"function",function:["p75","measurements.frames_frozen_rate",void 0,void 0]})),(0,D.tZ)(R,{...t,functions:e})}Y.displayName="_MobileCards";const J=Y;function U(t){const{data:e}=t,i=C.ZP.charts.getColorPalette(1)[0];return(0,D.tZ)(K,{"data-test-id":"sparkline",width:150,height:24,children:(0,D.tZ)(Z,{data:e,width:150,height:24,children:(0,D.tZ)(v.SparklinesLine,{style:{stroke:i,fill:"none",strokeWidth:3}})})})}U.displayName="SparklineChart";const K=(0,n.Z)("div",{target:"e1he14ku7"})("flex-grow:4;max-height:",(t=>t.height),"px;max-width:",(t=>t.width),"px;margin:",(0,b.Z)(1)," ",(0,b.Z)(0)," ",(0,b.Z)(.5)," ",(0,b.Z)(3),";"),$=(0,n.Z)("div",{target:"e1he14ku6"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,b.Z)(2),";@media (min-width: ",(t=>t.theme.breakpoints[0]),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(t=>t.theme.breakpoints[2]),"){grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));}");function tt(t){var e;const{isLoading:i,data:n,vital:r,value:o,showBar:s=!0,showStates:l=!1,showDurationDetail:d=!1,showVitalPercentNames:c=!1,showDetail:u=!0,barHeight:m}=t;if(i)return l?(0,D.tZ)(p.Z,{height:"48px"}):null;const h=l?(0,D.tZ)(et,{small:!0,children:(0,x.t)("No vitals found")}):null;if(!n)return h;const v={poor:0,meh:0,good:0,total:0};if((Array.isArray(r)?r:[r]).forEach((t=>{var e;const i=null!==(e=null==n?void 0:n[t])&&void 0!==e?e:{};Object.keys(v).forEach((t=>v[t]+=i[t]))})),!v.total)return h;const g=Array.isArray(r)?null:null!=o?o:rt(null!==(e=null==n?void 0:n[r])&&void 0!==e?e:null,r),f=function({poor:t,meh:e,good:i,total:n}){const a=t/n,r=e/n,o=i/n;return[{vitalState:M.SP.GOOD,percent:o},{vitalState:M.SP.MEH,percent:r},{vitalState:M.SP.POOR,percent:a}]}(v),Z=function(t){return t.map((({percent:t,vitalState:e})=>({percent:t,color:M.fL[e]})))}(f);return(0,D.BX)(a.Fragment,{children:[s&&(0,D.tZ)(B,{barHeight:m,colorStops:Z}),u&&(0,D.BX)(ot,{children:[d&&g&&(0,D.BX)("div",{"data-test-id":"vital-bar-p75",children:[(0,x.t)("The p75 for all transactions is "),(0,D.tZ)("strong",{children:g})]}),(0,D.tZ)(E,{vital:r,percents:f,showVitalPercentNames:c})]})]})}tt.displayName="VitalBar";const et=(0,n.Z)(c.Z,{target:"e1he14ku5"})("height:48px;padding:",(0,b.Z)(1.5)," 15%;");function it(t){const{chart:e,minHeight:i,horizontal:n,title:a,tooltip:r,value:o,isNotInteractive:s}=t;return(0,D.BX)(at,{interactive:!s,minHeight:i,children:[(0,D.BX)(l.Gh,{children:[(0,D.tZ)(lt,{children:(0,x.t)(a)}),(0,D.tZ)(m.Z,{size:"sm",position:"top",title:r})]}),(0,D.BX)(nt,{horizontal:n,children:[(0,D.tZ)(st,{children:o}),e]})]})}it.displayName="VitalCard";const nt=(0,n.Z)("div",{target:"e1he14ku4"})("width:100%;display:flex;flex-direction:",(t=>t.horizontal?"row":"column"),";justify-content:space-between;"),at=(0,n.Z)(o.Z,{target:"e1he14ku3"})("color:",(t=>t.theme.textColor),";padding:",(0,b.Z)(2)," ",(0,b.Z)(3),";align-items:flex-start;margin-bottom:",(0,b.Z)(2),";",(t=>t.minHeight&&"min-height: ".concat(t.minHeight,"px")),";");function rt(t,e){var i;const n=null!==(i=null==t?void 0:t.p75)&&void 0!==i?i:null;return null===n?"—":e===_.Zl.CLS?n.toFixed(2):"".concat(n.toFixed(0),"ms")}const ot=(0,n.Z)("div",{target:"e1he14ku2"})("font-size:",(t=>t.theme.fontSizeMedium),";@media (min-width: ",(t=>t.theme.breakpoints[0]),"){display:flex;justify-content:space-between;}"),st=(0,n.Z)("div",{target:"e1he14ku1"})("font-size:32px;margin-top:",(0,b.Z)(1),";"),lt=(0,n.Z)("div",{target:"e1he14ku0"})(y.Z,";")}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_landing_vitalsCards_tsx.3fd4fa347d03acc9ae61b38cb3f6a0e7.js.map