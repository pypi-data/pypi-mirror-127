"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_admin_adminOverview_index_tsx"],{"./app/views/admin/adminOverview/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});var r=s("../node_modules/react/index.js"),i=s("../node_modules/react-document-title/index.js"),a=s.n(i),n=s("./app/components/panels/index.tsx"),o=s("./app/locale.tsx"),c=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),l=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./app/components/charts/miniBarChart.tsx")),p=s("./app/components/loadingError.tsx"),d=s("./app/components/loadingIndicator.tsx"),h=s("./app/utils/theme.tsx"),u=s("./app/utils/withApi.tsx"),m=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const x={error:!1,loading:!0,rawData:{"client-api.all-versions.responses.2xx":[],"client-api.all-versions.responses.4xx":[],"client-api.all-versions.responses.5xx":[]}};class v extends r.Component{constructor(...e){super(...e),(0,c.Z)(this,"state",x),(0,c.Z)(this,"fetchData",(()=>{["client-api.all-versions.responses.2xx","client-api.all-versions.responses.4xx","client-api.all-versions.responses.5xx"].forEach((e=>{this.props.api.request("/internal/stats/",{method:"GET",data:{since:this.props.since,resolution:this.props.resolution,key:e},success:t=>{this.setState((s=>{const r=s.rawData;return r[e]=t,{rawData:r}}),this.requestFinished)},error:()=>{this.setState({error:!0})}})}))})),(0,c.Z)(this,"requestFinished",(()=>{const{rawData:e}=this.state;e["client-api.all-versions.responses.2xx"]&&e["client-api.all-versions.responses.4xx"]&&e["client-api.all-versions.responses.5xx"]&&this.setState({loading:!1})}))}componentWillMount(){this.fetchData()}componentWillReceiveProps(e){this.props.since!==e.since&&this.setState(x,this.fetchData)}processRawSeries(e){return e.map((e=>({name:1e3*e[0],value:e[1]})))}getChartSeries(){const{rawData:e}=this.state;return[{seriesName:"2xx",data:this.processRawSeries(e["client-api.all-versions.responses.2xx"]),color:h.ZP.green200},{seriesName:"4xx",data:this.processRawSeries(e["client-api.all-versions.responses.4xx"]),color:h.ZP.blue300},{seriesName:"5xx",data:this.processRawSeries(e["client-api.all-versions.responses.5xx"]),color:h.ZP.red200}]}render(){const{loading:e,error:t}=this.state;if(e)return(0,m.tZ)(d.Z,{});if(t)return(0,m.tZ)(p.Z,{onRetry:this.fetchData});const s=this.getChartSeries(),r=s.map((({color:e})=>e));return(0,m.tZ)(l.Z,{series:s,colors:r,height:110,stacked:!0,isGroupedByDate:!0,showTimeInTooltip:!0,labelYAxisExtents:!0})}}v.displayName="ApiChart";const Z=(0,u.Z)(v),w={error:!1,loading:!0,rawData:{"events.total":[],"events.dropped":[]},stats:{received:[],rejected:[]}};class D extends r.Component{constructor(...e){super(...e),(0,c.Z)(this,"state",w),(0,c.Z)(this,"fetchData",(()=>{["events.total","events.dropped"].forEach((e=>{this.props.api.request("/internal/stats/",{method:"GET",data:{since:this.props.since,resolution:this.props.resolution,key:e},success:t=>{this.setState((s=>{const r=s.rawData;return r[e]=t,{rawData:r}}),this.requestFinished)},error:()=>{this.setState({error:!0})}})}))}))}componentWillMount(){this.fetchData()}componentWillReceiveProps(e){this.props.since!==e.since&&this.setState(w,this.fetchData)}requestFinished(){const{rawData:e}=this.state;e["events.total"]&&e["events.dropped"]&&this.processOrgData()}processOrgData(){const{rawData:e}=this.state,t={},s={},r=[0,0];e["events.total"].forEach(((i,a)=>{var n;const o=i[1],c=null===(n=e["events.dropped"][a])||void 0===n?void 0:n[1],l=i[0];void 0===t[l]?(t[l]=o,s[l]=c):(t[l]+=o,s[l]+=c),o>0&&(r[0]+=o,r[1]+=1)})),this.setState({stats:{rejected:Object.keys(s).map((e=>({name:1e3*parseInt(e,10),value:s[e]||0}))),accepted:Object.keys(t).map((e=>({name:1e3*parseInt(e,10),value:t[e]-s[e]})))},loading:!1})}getChartSeries(){const{stats:e}=this.state;return[{seriesName:(0,o.t)("Accepted"),data:e.accepted,color:h.ZP.blue300},{seriesName:(0,o.t)("Dropped"),data:e.rejected,color:h.ZP.red200}]}render(){const{loading:e,error:t}=this.state;if(e)return(0,m.tZ)(d.Z,{});if(t)return(0,m.tZ)(p.Z,{onRetry:this.fetchData});const s=this.getChartSeries(),r=s.map((({color:e})=>e));return(0,m.tZ)(l.Z,{series:s,colors:r,height:110,stacked:!0,isGroupedByDate:!0,showTimeInTooltip:!0,labelYAxisExtents:!0})}}D.displayName="EventChart";const g=(0,u.Z)(D),f=()=>{const e=(new Date).getTime()/1e3-604800;return(0,m.tZ)(a(),{title:"Admin Overview - Sentry",children:(0,m.BX)(r.Fragment,{children:[(0,m.tZ)("h3",{children:(0,o.t)("System Overview")}),(0,m.BX)(n.s_,{children:[(0,m.tZ)(n.V9,{children:(0,o.t)("Event Throughput")}),(0,m.tZ)(n.N,{withPadding:!0,children:(0,m.tZ)(g,{since:e,resolution:"1h"})})]},"events"),(0,m.BX)(n.s_,{children:[(0,m.tZ)(n.V9,{children:(0,o.t)("API Responses")}),(0,m.tZ)(n.N,{withPadding:!0,children:(0,m.tZ)(Z,{since:e,resolution:"1h"})})]},"api")]})})};f.displayName="AdminOverview";const S=f}}]);
//# sourceMappingURL=../sourcemaps/app_views_admin_adminOverview_index_tsx.3372f2ca608660f4038549dea5eff12c.js.map