"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_projectIssueGrouping_index_tsx"],{"./app/utils/routeTitle.tsx":(e,t,n)=>{n.d(t,{Z:()=>s});const s=function(e,t,n=!0,s){const o="".concat(e," - ").concat(t),i=s?"".concat(o," - ").concat(s):o;return n?"".concat(i," - Sentry"):i}},"./app/views/asyncView.tsx":(e,t,n)=>{n.d(t,{Z:()=>a}),n("../node_modules/react/index.js");var s=n("../node_modules/react-document-title/index.js"),o=n.n(s),i=n("./app/components/asyncComponent.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends i.Z{getTitle(){return""}render(){const e=this.getTitle();return(0,r.tZ)(o(),{title:"".concat(e?"".concat(e," - "):"","Sentry"),children:this.renderComponent()})}}a.displayName="AsyncView"},"./app/views/settings/projectIssueGrouping/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>G});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),i=n("./app/actions/projectActions.tsx"),r=n("./app/components/acl/feature.tsx"),a=n("./app/components/links/externalLink.tsx"),p=n("./app/data/forms/projectIssueGrouping.tsx"),c=n("./app/locale.tsx"),l=n("./app/utils/routeTitle.tsx"),d=n("./app/views/asyncView.tsx"),u=n("./app/views/settings/components/forms/form.tsx"),g=n("./app/views/settings/components/forms/jsonForm.tsx"),h=n("./app/views/settings/components/settingsPageHeader.tsx"),f=n("./app/views/settings/components/text/textBlock.tsx"),m=n("./app/actionCreators/indicator.tsx"),Z=n("./app/components/alert.tsx"),x=n("./app/components/button.tsx"),y=n("./app/components/confirm.tsx"),w=n("./app/components/panels/index.tsx"),j=n("./app/utils/handleXhrErrorResponse.tsx"),v=n("./app/utils/marked.tsx"),b=n("./app/views/settings/components/forms/field/index.tsx"),k=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const C="upgrade-grouping";function T({groupingConfigs:e,organization:t,projectId:n,project:s,onUpgrade:r,api:a,location:p}){const l=t.access.includes("project:write"),{updateNotes:d,riskLevel:u,latestGroupingConfig:g}=function(e,t){const n={};let s="",o=0,i=null;if(t.forEach((t=>{n[t.id]=t,t.latest&&e.groupingConfig!==t.id&&(s=t.changelog,i=t,o=t.risk)})),i){var r;let t=null!==(r=i.base)&&void 0!==r?r:"";for(;t!==e.groupingConfig;){var a;const e=n[t];if(!e)break;o=Math.max(o,e.risk),s=e.changelog+"\n"+s,t=null!==(a=e.base)&&void 0!==a?a:""}}return{updateNotes:s,riskLevel:o,latestGroupingConfig:i}}(s,e),{riskNote:h,alertType:T}=function(e){switch(e){case 0:return{riskNote:(0,c.t)("This upgrade has the chance to create some new issues."),alertType:"info"};case 1:return{riskNote:(0,c.t)("This upgrade will create some new issues."),alertType:"warning"};case 2:return{riskNote:(0,k.tZ)("strong",{children:(0,c.t)("The new grouping strategy is incompatible with the current and will create entirely new issues.")}),alertType:"error"};default:return{riskNote:void 0,alertType:void 0}}}(u),_=!g,S=u>=2?"danger":"primary";if((0,o.useEffect)((()=>{p.hash==="#".concat(C)&&!_&&e&&l&&I()}),[p.hash]),!e)return null;async function G(){const e={};if(g){const t=Math.floor((new Date).getTime()/1e3),n=7776e3;e.groupingConfig=g.id,e.secondaryGroupingConfig=s.groupingConfig,e.secondaryGroupingExpiry=t+n}(0,m.E3)((0,c.t)("Changing groupingâ€¦"));try{const s=await a.requestPromise("/projects/".concat(t.slug,"/").concat(n,"/"),{method:"PUT",data:e});(0,m.B8)(),i.Z.updateSuccess(s),r()}catch{(0,j.Z)((0,c.t)("Unable to upgrade config"))}}function I(){(0,y._)({confirmText:(0,c.t)("Upgrade"),priority:S,onConfirm:G,message:(0,k.BX)(o.Fragment,{children:[(0,k.tZ)(f.Z,{children:(0,k.tZ)("strong",{children:(0,c.t)("Upgrade Grouping Strategy")})}),(0,k.tZ)(f.Z,{children:(0,c.t)("You can upgrade the grouping strategy to the latest but this is an irreversible operation.")}),(0,k.BX)(f.Z,{children:[(0,k.tZ)("strong",{children:(0,c.t)("New Behavior")}),(0,k.tZ)("div",{dangerouslySetInnerHTML:{__html:(0,v.Z)(d)}})]}),(0,k.tZ)(f.Z,{children:(0,k.tZ)(Z.Z,{type:T,children:h})})]})})}return(0,k.BX)(w.s_,{id:C,children:[(0,k.tZ)(w.V9,{children:(0,c.t)("Upgrade Grouping")}),(0,k.tZ)(w.N,{children:(0,k.tZ)(b.Z,{label:(0,c.t)("Upgrade Grouping Strategy"),help:(0,c._N)("If the project uses an old grouping strategy an update is possible.[linebreak]Doing so will cause new events to group differently.",{linebreak:(0,k.tZ)("br",{})}),disabled:!0,children:(0,k.tZ)("div",{children:(0,k.tZ)(x.ZP,{onClick:I,disabled:!l||_,title:l?_?(0,c.t)("You are already on the latest version"):void 0:(0,c.t)("You do not have sufficient permissions to do this"),type:"button",priority:S,children:(0,c.t)("Upgrade Grouping Strategy")})})})})]})}T.displayName="UpgradeGrouping";const _=T;class S extends d.Z{constructor(...e){super(...e),(0,s.Z)(this,"handleSubmit",(e=>{i.Z.updateSuccess(e)}))}getTitle(){const{projectId:e}=this.props.params;return(0,l.Z)((0,c.t)("Issue Grouping"),e,!1)}getDefaultState(){return{...super.getDefaultState(),groupingConfigs:[]}}getEndpoints(){const{projectId:e,orgId:t}=this.props.params;return[["groupingConfigs","/projects/".concat(t,"/").concat(e,"/grouping-configs/")]]}renderBody(){const{groupingConfigs:e}=this.state,{organization:t,project:n,params:s,location:i}=this.props,{orgId:l,projectId:d}=s,m="/projects/".concat(l,"/").concat(d,"/"),Z=new Set(t.access),x={additionalFieldProps:{organization:t,groupingConfigs:e},features:new Set(t.features),access:Z,disabled:!Z.has("project:write")};return(0,k.BX)(o.Fragment,{children:[(0,k.tZ)(h.Z,{title:(0,c.t)("Issue Grouping")}),(0,k.tZ)(f.Z,{children:(0,c._N)("All events have a fingerprint. Events with the same fingerprint are grouped together into an issue. To learn more about issue grouping, [link: read the docs].",{link:(0,k.tZ)(a.Z,{href:"https://docs.sentry.io/product/data-management-settings/event-grouping/"})})}),(0,k.BX)(u.Z,{saveOnBlur:!0,allowUndo:!0,initialData:n,apiMethod:"PUT",apiEndpoint:m,onSubmitSuccess:this.handleSubmit,children:[(0,k.tZ)(g.Z,{...x,title:(0,c.t)("Fingerprint Rules"),fields:[p.fields.fingerprintingRules]}),(0,k.tZ)(g.Z,{...x,title:(0,c.t)("Stack Trace Rules"),fields:[p.fields.groupingEnhancements]}),(0,k.tZ)(r.Z,{features:["set-grouping-config"],organization:t,children:(0,k.tZ)(g.Z,{...x,title:(0,c.t)("Change defaults"),fields:[p.fields.groupingConfig,p.fields.secondaryGroupingConfig,p.fields.secondaryGroupingExpiry]})}),(0,k.tZ)(_,{groupingConfigs:null!=e?e:[],organization:t,projectId:s.projectId,project:n,api:this.api,onUpgrade:this.fetchData,location:i})]})]})}}const G=S}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_projectIssueGrouping_index_tsx.f4b7d47508830ab58f6fca809963af94.js.map