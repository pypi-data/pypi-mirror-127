"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_alerts_incidentRules_presets_tsx-app_views_alerts_utils_index_tsx"],{"./app/utils/discover/charts.tsx":(t,e,n)=>{n.d(e,{CX:()=>i,gu:()=>o});var r=n("./app/locale.tsx"),a=n("./app/utils/discover/fields.tsx"),s=n("./app/utils/formatters.tsx");function i(t,e=""){switch((0,a.Px)(e)){case"integer":case"number":return t.toLocaleString();case"percentage":return(0,s.rl)(t,2);case"duration":return(0,s.g9)(t/1e3,2,!0);default:return t.toString()}}function o(t,e,n=!1){switch((0,a.Px)(e)){case"integer":case"number":return n?(0,s.Du)(t):t.toLocaleString();case"percentage":return(0,s.rl)(t,0);case"duration":return function(t){if(0===t)return"0";if(t>=s.ps){const e=(t/s.ps).toFixed(0);return(0,r.t)("%swk",e)}if(t>=s.x4){const e=(t/s.x4).toFixed(0);return(0,r.t)("%sd",e)}if(t>=s.kr){const e=(t/s.kr).toFixed(0);return(0,r.t)("%shr",e)}if(t>=s.EB){const e=(t/s.EB).toFixed(0);return(0,r.t)("%smin",e)}if(t>=s.sh){const e=(t/s.sh).toFixed(0);return(0,r.t)("%ss",e)}const e=t.toFixed(0);return(0,r.t)("%sms",e)}(t);default:return t.toString()}}},"./app/views/alerts/incidentRules/presets.tsx":(t,e,n)=>{n.d(e,{g:()=>R}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=n("./app/locale.tsx"),a=n("./app/utils/discover/types.tsx"),s=n("./app/utils/tokenizeSearch.tsx"),i=n("./app/views/alerts/utils/index.tsx"),o=n("./app/utils/discover/eventView.tsx"),u=n("./app/utils/discover/fields.tsx"),c=n("./app/views/alerts/incidentRules/types.tsx");function l(t){var e;const{orgSlug:n,projects:r,incident:a,stats:s,extraQueryParams:l}=t;if(!(r&&r.length&&a&&s))return"";const d="".concat(a.alertRule.timeWindow,"m"),{start:R,end:p}=(0,i.Eq)(s),S={id:void 0,name:a&&a.title||"",orderby:"-".concat((0,u.LY)(a.alertRule.aggregate)),yAxis:a.alertRule.aggregate?[a.alertRule.aggregate]:void 0,query:null!==(e=null==a?void 0:a.discoverQuery)&&void 0!==e?e:"",projects:r.filter((({slug:t})=>a.projects.includes(t))).map((({id:t})=>Number(t))),version:2,fields:a.alertRule.dataset===c.qz.ERRORS?["issue","count()","count_unique(user)"]:["transaction",a.alertRule.aggregate],start:R,end:p,...l},E=o.ZP.fromSavedQuery(S),{query:T,...v}=E.getResultsViewUrlTarget(n);return{query:{...T,interval:d},...v}}var d=n("./app/views/performance/transactionSummary/utils.tsx");const R=[{name:(0,r.t)("Error count"),match:/^count\(\)/,validDataset:[c.qz.ERRORS],default:"count()",makeCtaParams:S},{name:(0,r.t)("Users affected"),match:/^count_unique\(tags\[sentry:user\]\)/,validDataset:[c.qz.ERRORS],default:"count_unique(tags[sentry:user])",makeCtaParams:S},{name:(0,r.t)("Latency"),match:/^(p[0-9]{2,3}|percentile\(transaction\.duration,[^)]+\)|avg\([^)]+\))/,validDataset:[c.qz.TRANSACTIONS],default:"percentile(transaction.duration, 0.95)",makeCtaParams:t=>p({opts:t,tooltip:(0,r.t)("Latency by Transaction")})},{name:(0,r.t)("Apdex"),match:/^apdex\([0-9.]+\)/,validDataset:[c.qz.TRANSACTIONS],default:"apdex(300)",makeCtaParams:t=>p({opts:t,tooltip:(0,r.t)("Apdex by Transaction")})},{name:(0,r.t)("Transaction Count"),match:/^count\(\)/,validDataset:[c.qz.TRANSACTIONS],default:"count()",makeCtaParams:t=>p({opts:t})},{name:(0,r.t)("Failure rate"),match:/^failure_rate\(\)/,validDataset:[c.qz.TRANSACTIONS],default:"failure_rate()",makeCtaParams:function({orgSlug:t,incident:e,projects:n,stats:i}){var o,u;if(!e||!i)return{to:"",buttonText:(0,r.t)("Incident details")};const c=null===(u=new s.MY(null!==(o=e.discoverQuery)&&void 0!==o?o:"").getFilterValues("transaction"))||void 0===u?void 0:u.find((t=>!t.includes("*")));return{to:l({orgSlug:t,projects:n,incident:e,stats:i,extraQueryParams:void 0!==c?{fields:["transaction.status","count()"],orderby:"-count",display:a.DC.TOP5}:{fields:["transaction","failure_rate()"],orderby:"-failure_rate",display:a.DC.TOP5}}),buttonText:(0,r.t)("Open in Discover"),title:void 0===c?(0,r.t)("Failure rate by transaction"):void 0}}}];function p(t){var e,n;const{opts:{orgSlug:o,projects:u,incident:c,stats:R},tooltip:p}=t;if(!c||!R)return{to:"",buttonText:(0,r.t)("Incident details")};const S=null===(n=new s.MY(null!==(e=c.discoverQuery)&&void 0!==e?e:"").getFilterValues("transaction"))||void 0===n?void 0:n.find((t=>!t.includes("*")));if(void 0!==S){const t=(0,i.Eq)(R);return{to:(0,d.e1)({orgSlug:o,transaction:S,projectID:u.filter((({slug:t})=>c.projects.includes(t))).map((({id:t})=>t)),query:{...t}}),buttonText:(0,r.t)("View Transaction Summary"),title:S}}const E={fields:[...new Set(["transaction","count()",c.alertRule.aggregate])],orderby:"-count",display:a.DC.TOP5};return{to:l({orgSlug:o,projects:u,incident:c,stats:R,extraQueryParams:E}),buttonText:(0,r.t)("Open in Discover"),title:p}}function S({orgSlug:t,projects:e,incident:n,stats:s}){if(!n)return{buttonText:(0,r.t)("Open in Discover"),to:""};const i={display:a.DC.TOP5};return{buttonText:(0,r.t)("Open in Discover"),to:l({orgSlug:t,projects:e,incident:n,stats:s,extraQueryParams:i})}}},"./app/views/alerts/incidentRules/types.tsx":(t,e,n)=>{n.d(e,{lT:()=>a,t6:()=>s,qz:()=>i,GM:()=>o,Yh:()=>u,lK:()=>c,XH:()=>l,Tb:()=>d,Us:()=>R,LO:()=>p,Lm:()=>S,hd:()=>E});var r=n("./app/locale.tsx");let a,s,i,o,u,c,l,d,R;!function(t){t[t.ABOVE=0]="ABOVE",t[t.BELOW=1]="BELOW"}(a||(a={})),function(t){t.COUNT="count",t.CHANGE="change"}(s||(s={})),function(t){t.ERRORS="events",t.TRANSACTIONS="transactions",t.SESSIONS="sessions"}(i||(i={})),function(t){t.DEFAULT="default",t.ERROR="error",t.TRANSACTION="transaction",t.USER="user",t.SESSION="session"}(o||(o={})),function(t){t.ERROR_DEFAULT="error_default",t.DEFAULT="default",t.ERROR="error",t.TRANSACTION="transaction"}(u||(u={})),function(t){t.CRASH_FREE_SESSIONS="percentage(sessions_crashed, sessions) AS _crash_rate_alert_aggregate",t.CRASH_FREE_USERS="percentage(users_crashed, users) AS _crash_rate_alert_aggregate"}(c||(c={})),function(t){t.SIX_HOURS="6h",t.ONE_DAY="1d",t.THREE_DAYS="3d",t.SEVEN_DAYS="10000m",t.FOURTEEN_DAYS="14d",t.THIRTY_DAYS="30d"}(l||(l={})),function(t){t[t.ONE_MINUTE=1]="ONE_MINUTE",t[t.FIVE_MINUTES=5]="FIVE_MINUTES",t[t.TEN_MINUTES=10]="TEN_MINUTES",t[t.FIFTEEN_MINUTES=15]="FIFTEEN_MINUTES",t[t.THIRTY_MINUTES=30]="THIRTY_MINUTES",t[t.ONE_HOUR=60]="ONE_HOUR",t[t.TWO_HOURS=120]="TWO_HOURS",t[t.FOUR_HOURS=240]="FOUR_HOURS",t[t.ONE_DAY=1440]="ONE_DAY"}(d||(d={})),function(t){t.EMAIL="email",t.SLACK="slack",t.PAGERDUTY="pagerduty",t.MSTEAMS="msteams",t.SENTRY_APP="sentry_app"}(R||(R={}));const p={[R.EMAIL]:(0,r.t)("Email"),[R.SLACK]:(0,r.t)("Slack"),[R.PAGERDUTY]:(0,r.t)("Pagerduty"),[R.MSTEAMS]:(0,r.t)("MS Teams"),[R.SENTRY_APP]:(0,r.t)("Notification")};let S;!function(t){t.SPECIFIC="specific",t.USER="user",t.TEAM="team",t.SENTRY_APP="sentry_app"}(S||(S={}));const E={[S.USER]:(0,r.t)("Member"),[S.TEAM]:(0,r.t)("Team")}},"./app/views/alerts/utils/index.tsx":(t,e,n)=>{n.d(e,{dX:()=>S,hl:()=>E,yN:()=>T,Un:()=>v,Eq:()=>f,Gm:()=>O,CM:()=>g,Ey:()=>_,KC:()=>A,A4:()=>m,Eb:()=>N,Vc:()=>y,lR:()=>x,qn:()=>h,t3:()=>U,QR:()=>I}),n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/core-js/modules/es.string.replace.js");var r=n("../node_modules/lodash/round.js"),a=n.n(r),s=n("./app/api.tsx"),i=n("./app/locale.tsx"),o=n("./app/types/index.tsx"),u=n("./app/utils.tsx"),c=n("./app/utils/dates.tsx"),l=n("./app/utils/discover/charts.tsx"),d=n("./app/views/alerts/incidentRules/presets.tsx"),R=n("./app/views/alerts/incidentRules/types.tsx");const p=new s.KU;function S(t,e){return p.requestPromise("/organizations/".concat(t,"/alert-rules/").concat(e,"/"))}function E(t,e,n,r){return p.requestPromise("/organizations/".concat(t,"/incidents/"),{query:{alertRule:e,includeSnapshots:!0,start:n,end:r,expand:["activities","seen_by","original_alert_rule"]}})}function T(t,e,n){return t.requestPromise("/organizations/".concat(e,"/incidents/").concat(n,"/"))}function v(t){var e,n;const r=null==t?void 0:t.alertRule,a=null!==(e=null==r?void 0:r.aggregate)&&void 0!==e?e:"",s=null!==(n=null==r?void 0:r.dataset)&&void 0!==n?n:R.qz.ERRORS;return d.g.find((t=>t.validDataset.includes(s)&&t.match.test(a)))}function f(t){return{start:(0,c.v5)(1e3*t.eventStats.data[0][0]),end:(0,c.v5)(1e3*t.eventStats.data[t.eventStats.data.length-1][0])}}function O(t){return!t.hasOwnProperty("triggers")}const g={[R.qz.ERRORS]:(0,i.t)("Errors"),[R.qz.TRANSACTIONS]:(0,i.t)("Transactions"),[R.Yh.ERROR_DEFAULT]:"event.type:error OR event.type:default",[R.Yh.ERROR]:"event.type:error",[R.Yh.DEFAULT]:"event.type:default",[R.Yh.TRANSACTION]:"event.type:transaction"},_={[R.Yh.ERROR_DEFAULT]:{dataset:R.qz.ERRORS,eventTypes:[R.GM.ERROR,R.GM.DEFAULT]},[R.Yh.ERROR]:{dataset:R.qz.ERRORS,eventTypes:[R.GM.ERROR]},[R.Yh.DEFAULT]:{dataset:R.qz.ERRORS,eventTypes:[R.GM.DEFAULT]},[R.Yh.TRANSACTION]:{dataset:R.qz.TRANSACTIONS,eventTypes:[R.GM.TRANSACTION]}};function A(t,e){return t===R.qz.TRANSACTIONS?R.Yh.TRANSACTION:e?e.includes(R.GM.DEFAULT)&&e.includes(R.GM.ERROR)?R.Yh.ERROR_DEFAULT:e.includes(R.GM.DEFAULT)?R.Yh.DEFAULT:R.Yh.ERROR:R.Yh.ERROR}function m(t){let e=t.match(/\(?\bevent\.type:(error|default|transaction)\)?\WOR\W\(?event\.type:(error|default|transaction)\)?/i);return e?"default,error"!==e.slice(1,3).sort().join(",")?null:{source:R.Yh.ERROR_DEFAULT,query:t.replace(e[0],"").trim()}:(e=t.match(/(^|\s)event\.type:(error|default|transaction)/i),e&&R.Yh[e[2].toUpperCase()]?{source:R.Yh[e[2].toUpperCase()],query:t.replace(e[0],"").trim()}:null)}function N(t){return Object.values(R.lK).includes(t)}const y={[R.lK.CRASH_FREE_SESSIONS]:o.r2.SESSIONS,[R.lK.CRASH_FREE_USERS]:o.r2.USERS};function x(t,e,n){return N(n)?(0,u.ri)(t)?"".concat(a()(t,2),"%"):"―":(0,l.gu)(t,e)}function h(t,e,n){return N(n)?(0,u.ri)(t)?"".concat(t,"%"):"―":(0,l.CX)(t,e)}const U=1.03;function I(t){return N(t)}}}]);
//# sourceMappingURL=../sourcemaps/app_views_alerts_incidentRules_presets_tsx-app_views_alerts_utils_index_tsx.b76fe087600970ed84e4e445d9be32c0.js.map