(self.webpackChunk=self.webpackChunk||[]).push([["app_views_organizationStats_teamInsights_overview_tsx-node_modules_lodash_mean_js","node_modules_lodash_mean_js"],{"./app/components/charts/components/markLine.tsx":(e,t,r)=>{"use strict";function n(e){return{symbol:["none","none"],...e}}r.d(t,{Z:()=>n}),r("../node_modules/echarts/lib/component/markLine.js")},"./app/utils/discover/discoverQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>d}),r("../node_modules/react/index.js");var n=r("./app/utils/withApi.tsx"),i=r("./app/utils/discover/genericDiscoverQuery.tsx"),o=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function s(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function a(e){return(0,o.tZ)(i.ZP,{route:"eventsv2",shouldRefetchData:s,...e})}a.displayName="DiscoverQuery";const d=(0,n.Z)(a)},"./app/views/organizationStats/teamInsights/overview.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>nt});var n=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=r("../node_modules/react/index.js"),o=r("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),s=r("../node_modules/lodash/pick.js"),a=r.n(s),d=r("../node_modules/moment/moment.js"),l=r.n(d),c=r("./app/components/forms/teamSelector.tsx"),u=r("./app/components/layouts/thirds.tsx"),p=r("./app/components/loadingIndicator.tsx"),m=r("./app/components/noProjectMessage.tsx"),g=r("./app/components/organizations/globalSelectionHeader/getParams.tsx"),h=r("./app/components/pageTimeRangeSelector.tsx"),Z=r("./app/locale.tsx"),v=r("./app/styles/space.tsx"),f=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),x=r("./app/utils/isActiveSuperuser.tsx"),y=r("./app/utils/localStorage.tsx"),b=r("./app/utils/useOrganization.tsx"),w=r("./app/utils/useTeams.tsx"),j=r("./app/views/organizationStats/header.tsx"),S=(r("../node_modules/core-js/modules/es.symbol.description.js"),r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"));function z({title:e,description:t,children:r}){return(0,S.BX)(T,{children:[(0,S.BX)(_,{children:[(0,S.tZ)(D,{children:e}),(0,S.tZ)(M,{children:t})]}),(0,S.tZ)(B,{children:r})]})}z.displayName="DescriptionCard";const k=z,T=(0,n.Z)("div",{target:"eyf29hd4"})("border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";display:flex;margin-bottom:",(0,v.Z)(3),";flex-direction:column;@media (min-width: ",(e=>e.theme.breakpoints[1]),"){flex-direction:row;}"),_=(0,n.Z)("div",{target:"eyf29hd3"})("padding:",(0,v.Z)(2)," ",(0,v.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";@media (min-width: ",(e=>e.theme.breakpoints[1]),"){max-width:250px;border-right:1px solid ",(e=>e.theme.border),";border-bottom:0;}"),D=(0,n.Z)("div",{target:"eyf29hd2"})("font-size:",(e=>e.theme.fontSizeLarge),";margin:0 0 ",(0,v.Z)(.5),";"),M=(0,n.Z)("div",{target:"eyf29hd1"})("color:",(e=>e.theme.subText),";font-size:",(e=>e.theme.fontSizeMedium),";"),B=(0,n.Z)("div",{target:"eyf29hd0"})({name:"1ff36h2",styles:"flex-grow:1"});var q=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),R=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./app/components/asyncComponent.tsx")),L=r("./app/components/charts/barChart.tsx"),N=r("../node_modules/lodash/chunk.js"),C=r.n(N);function A(e){const t=e.sort(((e,t)=>new Date(e.name).getTime()-new Date(t.name).getTime()));return C()(t,7).map((e=>({name:e[0].name,value:e.reduce(((e,t)=>e+t.value),0)})))}function P(e){return Object.entries(e).map((([e,t])=>({value:t,name:new Date(e).getTime()})))}function X(e){return[...e.filter((e=>Math.round(e.trend)<0)),...e.filter((e=>Math.round(e.trend)>0)),...e.filter((e=>0===Math.round(e.trend)))]}const E=e=>({splitNumber:e,type:"category",min:0,axisLabel:{showMaxLabel:!0,showMinLabel:!0,formatter:e=>l()(new Date(e)).format("MMM D")}});class I extends R.Z{constructor(...e){super(...e),(0,q.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),alertsTriggered:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:i,teamSlug:o}=this.props,s={start:t,end:r,period:n,utc:i};return[["alertsTriggered","/teams/".concat(e.slug,"/").concat(o,"/alerts-triggered/"),{query:{...(0,g.Q)(s)}}]]}componentDidUpdate(e){const{start:t,end:r,period:n,utc:i,teamSlug:o}=this.props;e.start===t&&e.end===r&&e.period===n&&e.utc===i&&e.teamSlug===o||this.remountComponent()}renderLoading(){return(0,S.tZ)(F,{children:(0,S.tZ)(p.Z,{})})}renderBody(){const{alertsTriggered:e}=this.state,t=A(P(null!=e?e:{}));return(0,S.tZ)(F,{children:e&&(0,S.tZ)(L.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:0,top:0},yAxis:{minInterval:1},xAxis:E(t.length),series:[{seriesName:(0,Z.t)("Alerts Triggered"),data:t,silent:!0}]})})}}const Q=I,F=(0,n.Z)("div",{target:"e1w90l1w0"})("padding:",(0,v.Z)(2)," ",(0,v.Z)(2)," 0 ",(0,v.Z)(2),";");var U=r("../node_modules/lodash/isEqual.js"),O=r.n(U),V=r("./app/components/idBadge/index.tsx"),G=r("./app/components/panels/panelTable.tsx"),H=r("./app/components/placeholder.tsx"),W=r("./app/utils/formatters.tsx");class J extends R.Z{constructor(...e){super(...e),(0,q.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),issuesBreakdown:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:i,teamSlug:o}=this.props,s={start:t,end:r,period:n,utc:i};return[["issuesBreakdown","/teams/".concat(e.slug,"/").concat(o,"/issue-breakdown/"),{query:{...(0,g.Q)(s)}}]]}componentDidUpdate(e){const{start:t,end:r,period:n,utc:i,teamSlug:o,projects:s}=this.props;e.start===t&&e.end===r&&e.period===n&&e.utc===i&&e.teamSlug===o&&O()(e.projects,s)||this.remountComponent()}renderLoading(){return this.renderBody()}renderBody(){const{issuesBreakdown:e,loading:t}=this.state,{projects:r}=this.props,n={},o={},s={};if(e)for(const[t,r]of Object.entries(e))for(const[e,{reviewed:i,total:a}]of Object.entries(r)){s[t]||(s[t]={reviewed:0,total:0}),s[t].reviewed+=i,s[t].total+=a,void 0===n[e]?n[e]=i:n[e]+=i;const r=a-i;void 0===o[e]?o[e]=r:o[e]+=r}const a=A(P(n)),d=A(P(o));return(0,S.BX)(i.Fragment,{children:[(0,S.BX)($,{children:[t&&(0,S.tZ)(H.Z,{height:"200px"}),!t&&(0,S.tZ)(L.Z,{style:{height:200},stacked:!0,isGroupedByDate:!0,useShortDate:!0,legend:{right:0,top:0},xAxis:E(a.length),yAxis:{minInterval:1},series:[{seriesName:(0,Z.t)("Reviewed"),data:a,silent:!0},{seriesName:(0,Z.t)("Not Reviewed"),data:d,silent:!0}]})]}),(0,S.tZ)(ee,{headers:[(0,Z.t)("Project"),(0,S.tZ)(ne,{children:(0,Z.t)("For Review")},"forReview"),(0,S.tZ)(ne,{children:(0,Z.t)("Reviewed")},"reviewed"),(0,S.tZ)(ne,{children:(0,Z.t)("% Reviewed")},"change")],isLoading:t,children:r.map((e=>{var t;const{total:r,reviewed:n}=null!==(t=s[e.id])&&void 0!==t?t:{};return(0,S.BX)(i.Fragment,{children:[(0,S.tZ)(te,{children:(0,S.tZ)(re,{avatarSize:18,project:e})}),(0,S.tZ)(ne,{children:r}),(0,S.tZ)(ne,{children:n}),(0,S.tZ)(ne,{children:0===r?"—":(0,W.rl)(n/r)})]},e.id)}))})]})}}const K=J,Y=(0,n.Z)("div",{target:"e1tnpmhr5"})("padding:",(0,v.Z)(2)," ",(0,v.Z)(2)," 0 ",(0,v.Z)(2),";"),$=(0,n.Z)(Y,{target:"e1tnpmhr4"})("border-bottom:1px solid ",(e=>e.theme.border),";"),ee=(0,n.Z)(G.Z,{target:"e1tnpmhr3"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,v.Z)(1)," ",(0,v.Z)(2),";}"),te=(0,n.Z)("div",{target:"e1tnpmhr2"})({name:"zjik7",styles:"display:flex"}),re=(0,n.Z)(V.Z,{target:"e1tnpmhr1"})({name:"ozd7xs",styles:"flex-shrink:0"}),ne=(0,n.Z)("div",{target:"e1tnpmhr0"})({name:"mnwtso",styles:"text-align:right;font-variant-numeric:tabular-nums"});var ie=r("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),oe=r("./app/components/links/link.tsx"),se=r("./app/components/loadingError.tsx"),ae=r("./app/icons/index.tsx"),de=r("./app/styles/overflowEllipsis.tsx"),le=r("./app/utils/discover/discoverQuery.tsx"),ce=r("./app/utils/discover/eventView.tsx"),ue=r("./app/utils/discover/fieldRenderers.tsx");function pe({organization:e,location:t,projects:r,periodTableData:n,weekTableData:o,isLoading:s,period:a,error:d}){var l;const[c,u]=(0,i.useState)(!1),p=(null==n?void 0:n.meta)&&(0,ue.Js)("user_misery",n.meta),m=X((null!==(l=null==n?void 0:n.data)&&void 0!==l?l:[]).map((e=>{const t=null==o?void 0:o.data.find((t=>t.project===e.project&&t.transaction===e.transaction)),r=t?100*(e.user_misery-t.user_misery):null;return{...e,trend:r}})).filter((e=>null!==e.trend)).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))));return d?(0,S.tZ)(se.Z,{}):(0,S.BX)(i.Fragment,{children:[(0,S.tZ)(he,{isEmpty:0===r.length||0===(null==n?void 0:n.data.length),headers:[(0,Z.t)("Key transaction"),(0,Z.t)("Project"),(0,Z._N)("Last [period]",{period:a}),(0,Z.t)("Last 7 Days"),(0,S.tZ)(xe,{children:(0,Z.t)("Change")},"change")],isLoading:s,children:m.map(((n,s)=>{const a=r.find((({slug:e})=>n.project===e)),{trend:d,project:l,transaction:u}=n,m=null==o?void 0:o.data.find((e=>e.project===l&&e.transaction===u));if(!m||null===d)return null;const g=null==p?void 0:p(n,{organization:e,location:t}),h=m&&(null==p?void 0:p(m,{organization:e,location:t})),v=Math.round(Math.abs(d));if(s>=5&&!c)return null;const f=ce.ZP.fromSavedQuery({id:void 0,name:n.transaction,projects:[Number(null==a?void 0:a.id)],query:"transaction.duration:<15m transaction:".concat(n.transaction),version:2,range:"7d",fields:["id","title","event.type","project","user.display","timestamp"]});return(0,S.BX)(i.Fragment,{children:[(0,S.tZ)(fe,{children:(0,S.tZ)(oe.Z,{to:f.getResultsViewUrlTarget(e.slug),children:n.transaction})}),(0,S.tZ)(Ze,{children:a&&(0,S.tZ)(ve,{avatarSize:18,project:a})}),(0,S.tZ)("div",{children:g}),(0,S.tZ)("div",{children:null!=h?h:"—"}),(0,S.tZ)(ye,{children:0===v?(0,S.BX)(be,{children:["0% ",(0,Z.t)("change")]}):(0,S.BX)(we,{color:d>=0?"green300":"red300",children:["".concat(v,"% "),d>=0?(0,Z.t)("better"):(0,Z.t)("worse")]})})]},s)}))}),m.length>=5&&!c&&!s&&(0,S.BX)(je,{onClick:function(){u(!0)},children:[(0,S.BX)(ze,{children:[(0,S.tZ)(Se,{color:"gray300"}),(0,Z._N)("Show [count] More",{count:m.length-1-5})]}),(0,S.tZ)(ae.g6,{color:"gray300",direction:"down"})]})]})}function me({organization:e,teamId:t,projects:r,location:n,period:i,start:o,end:s}){if(0===r.length)return(0,S.tZ)(pe,{isLoading:!1,organization:e,location:n,projects:[],period:i,periodTableData:{data:[]},weekTableData:{data:[]}});const a={id:void 0,query:"transaction.duration:<15m team_key_transaction:true",projects:[],version:2,orderby:"-tpm",teams:[Number(t)],fields:["transaction","project","tpm()","count_unique(user)","count_miserable(user)","user_misery()"]},d=ce.ZP.fromSavedQuery({...a,name:"periodMisery",range:i,start:o,end:s}),l=ce.ZP.fromSavedQuery({...a,name:"weekMisery",range:"7d"});return(0,S.tZ)(le.Z,{eventView:d,orgSlug:e.slug,location:n,children:({isLoading:t,tableData:o,error:s})=>(0,S.tZ)(le.Z,{eventView:l,orgSlug:e.slug,location:n,children:({isLoading:a,tableData:d,error:l})=>(0,S.tZ)(pe,{isLoading:t||a,organization:e,location:n,projects:r,period:i,periodTableData:o,weekTableData:d,error:null!=s?s:l})})})}pe.displayName="TeamMisery",me.displayName="TeamMiseryWrapper";const ge=me,he=(0,n.Z)(G.Z,{target:"e1uglq210"})("grid-template-columns:1fr 0.5fr 112px 112px 0.25fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,v.Z)(1)," ",(0,v.Z)(2),";}",(e=>e.isEmpty&&(0,ie.iv)("&>div:last-child{padding:48px ",(0,v.Z)(2),";}","")),";"),Ze=(0,n.Z)("div",{target:"e1uglq29"})({name:"zjik7",styles:"display:flex"}),ve=(0,n.Z)(V.Z,{target:"e1uglq28"})({name:"ozd7xs",styles:"flex-shrink:0"}),fe=(0,n.Z)("div",{target:"e1uglq27"})(de.Z,";"),xe=(0,n.Z)("span",{target:"e1uglq26"})({name:"2qga7i",styles:"text-align:right"}),ye=(0,n.Z)("div",{target:"e1uglq25"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),be=(0,n.Z)("div",{target:"e1uglq24"})("color:",(e=>e.theme.subText),";"),we=(0,n.Z)("div",{target:"e1uglq23"})("color:",(e=>e.theme[e.color]),";"),je=(0,n.Z)("div",{target:"e1uglq22"})("display:flex;align-items:center;padding:",(0,v.Z)(1)," ",(0,v.Z)(2),";font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.subText),";cursor:pointer;border-top:1px solid ",(e=>e.theme.border),";"),Se=(0,n.Z)(ae.Zd,{target:"e1uglq21"})("margin-right:",(0,v.Z)(1),";"),ze=(0,n.Z)("div",{target:"e1uglq20"})({name:"18keaja",styles:"display:flex;align-items:center;flex-grow:1"});var ke=r("../node_modules/lodash/round.js"),Te=r.n(ke),_e=r("./app/components/charts/components/markLine.tsx");class De extends R.Z{constructor(...e){super(...e),(0,q.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekReleases:null,periodReleases:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:i,teamSlug:o}=this.props,s={start:t,end:r,period:n,utc:i};return[["periodReleases","/teams/".concat(e.slug,"/").concat(o,"/release-count/"),{query:{...(0,g.Q)(s)}}],["weekReleases","/teams/".concat(e.slug,"/").concat(o,"/release-count/"),{query:{statsPeriod:"7d"}}]]}componentDidUpdate(e){const{teamSlug:t,start:r,end:n,period:i,utc:o}=this.props;e.start===r&&e.end===n&&e.period===i&&e.utc===o&&O()(e.teamSlug,t)||this.remountComponent()}getReleaseCount(e,t){const{periodReleases:r,weekReleases:n}=this.state,i="week"===t?null==n?void 0:n.last_week_totals:null==r?void 0:r.project_avgs;return null!=i&&i[e]?Math.ceil(null==i?void 0:i[e]):0}getTrend(e){const t=this.getReleaseCount(e,"period"),r=this.getReleaseCount(e,"week");return null===t||null===r?null:r-t}renderLoading(){return this.renderBody()}renderReleaseCount(e,t){const{loading:r}=this.state;if(r)return(0,S.tZ)("div",{children:(0,S.tZ)(H.Z,{width:"80px",height:"25px"})});const n=this.getReleaseCount(Number(e),t);return null===n?"—":n}renderTrend(e){const{loading:t}=this.state;if(t)return(0,S.tZ)("div",{children:(0,S.tZ)(H.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"—":(0,S.BX)(Ce,{color:r>=0?"green300":"red300",children:["".concat(Te()(Math.abs(r),3)),(0,S.tZ)(Ne,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){var e,t;const{projects:r,period:n,theme:o,organization:s}=this.props,{periodReleases:a}=this.state,d=X(r.map((e=>{var t;return{project:e,trend:null!==(t=this.getTrend(Number(e.id)))&&void 0!==t?t:0}})).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend)))),c=A(Object.entries(null!==(e=null==a?void 0:a.release_counts)&&void 0!==e?e:{}).map((([e,t])=>({value:Math.ceil(t),name:new Date(e).getTime()})))),u=Object.values(null!==(t=null==a?void 0:a.project_avgs)&&void 0!==t?t:{}),p=u.reduce(((e,t)=>e+t),0),m=Math.ceil(p/u.length);return(0,S.BX)("div",{children:[(0,S.tZ)(Be,{children:(0,S.tZ)(L.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:E(c.length),series:[{seriesName:(0,Z.t)("This Period"),silent:!0,data:c,markLine:(0,_e.Z)({silent:!0,lineStyle:{color:o.gray200,type:"dashed",width:1},data:[{yAxis:m}],label:{show:!1}})}],tooltip:{formatter:e=>{const[t]=Array.isArray(e)?e:[e],r="MMM D",i=l()(t.axisValue).format(r),o=l()(t.axisValue).add(7,"days").format(r);return['<div class="tooltip-series">','<div><span class="tooltip-label">'.concat(t.marker," <strong>").concat(t.seriesName,"</strong></span> ").concat(t.data[1],"</div>"),'<div><span class="tooltip-label"><strong>Last '.concat(n," Average</strong></span> ").concat(m,"</div>"),"</div>",'<div class="tooltip-date">'.concat(i," - ").concat(o,"</div>"),'<div class="tooltip-arrow"></div>'].join("")}}})}),(0,S.tZ)(qe,{isEmpty:0===r.length,headers:[(0,Z.t)("Project"),(0,S.tZ)(Re,{children:(0,Z._N)("Last [period] Average",{period:n})},"last"),(0,S.tZ)(Re,{children:(0,Z.t)("Last 7 Days")},"curr"),(0,S.tZ)(Re,{children:(0,Z.t)("Difference")},"diff")],children:d.map((({project:e})=>(0,S.BX)(i.Fragment,{children:[(0,S.tZ)(Ae,{children:(0,S.tZ)(Pe,{avatarSize:18,project:e})}),(0,S.tZ)(Le,{children:this.renderReleaseCount(e.id,"period")}),(0,S.tZ)(Le,{children:(0,S.tZ)(oe.Z,{to:{pathname:"/organizations/".concat(s.slug,"/releases/"),query:{project:e.id,statsPeriod:"7d"}},children:this.renderReleaseCount(e.id,"week")})}),(0,S.tZ)(Le,{children:this.renderTrend(e.id)})]},e.id)))})]})}}const Me=(0,o.b)(De),Be=(0,n.Z)("div",{target:"e1az29pq7"})("padding:",(0,v.Z)(2)," ",(0,v.Z)(2)," 0 ",(0,v.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),qe=(0,n.Z)(G.Z,{target:"e1az29pq6"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;&>div{padding:",(0,v.Z)(1)," ",(0,v.Z)(2),";}"),Re=(0,n.Z)("span",{target:"e1az29pq5"})({name:"2qga7i",styles:"text-align:right"}),Le=(0,n.Z)("div",{target:"e1az29pq4"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),Ne=(0,n.Z)(ae.CC,{target:"e1az29pq3"})("margin:0 ",(0,v.Z)(.5),";"),Ce=(0,n.Z)("div",{target:"e1az29pq2"})("color:",(e=>e.theme[e.color]),";"),Ae=(0,n.Z)("div",{target:"e1az29pq1"})({name:"zjik7",styles:"display:flex"}),Pe=(0,n.Z)(V.Z,{target:"e1az29pq0"})({name:"ozd7xs",styles:"flex-shrink:0"});class Xe extends R.Z{constructor(...e){super(...e),(0,q.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),resolutionTime:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:i,teamSlug:o}=this.props,s={start:t,end:r,period:n,utc:i};return[["resolutionTime","/teams/".concat(e.slug,"/").concat(o,"/time-to-resolution/"),{query:{...(0,g.Q)(s)}}]]}renderLoading(){return(0,S.tZ)(Ie,{children:(0,S.tZ)(p.Z,{})})}renderBody(){const{resolutionTime:e}=this.state,t=A(Object.entries(null!=e?e:{}).map((([e,{avg:t}])=>({value:t,name:new Date(e).getTime()}))));return(0,S.tZ)(Ie,{children:(0,S.tZ)(L.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",tooltip:{valueFormatter:e=>(0,W.g9)(e,1)},yAxis:{minInterval:86400,axisLabel:{formatter:e=>0===e?"":(0,W.g9)(e,0,!0,!0)}},legend:{right:0,top:0},xAxis:E(t.length),series:[{seriesName:(0,Z.t)("Time to Resolution"),data:t,silent:!0}]})})}}const Ee=Xe,Ie=(0,n.Z)("div",{target:"e1s8s0fe0"})("padding:",(0,v.Z)(2)," ",(0,v.Z)(2)," 0 ",(0,v.Z)(2),";");var Qe=r("./app/types/index.tsx"),Fe=r("./app/utils/sessions.tsx"),Ue=r("./app/views/releases/utils/index.tsx");class Oe extends R.Z{constructor(...e){super(...e),(0,q.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekSessions:null,periodSessions:null}}getEndpoints(){const{organization:e,start:t,end:r,period:n,utc:i,projects:o}=this.props,s=o.filter((e=>e.hasSessions));if(0===s.length)return[];const a={start:t,end:r,period:n,utc:i},d={environment:[],project:s.map((e=>e.id)),field:"sum(session)",groupBy:["session.status","project"],interval:"1d"};return[["periodSessions","/organizations/".concat(e.slug,"/sessions/"),{query:{...d,...(0,g.Q)(a)}}],["weekSessions","/organizations/".concat(e.slug,"/sessions/"),{query:{...d,statsPeriod:"7d"}}]]}componentDidUpdate(e){const{projects:t,start:r,end:n,period:i,utc:o}=this.props;e.start===r&&e.end===n&&e.period===i&&e.utc===o&&O()(e.projects,t)||this.remountComponent()}getScore(e,t){const{periodSessions:r,weekSessions:n}=this.state,i="week"===t?n:r,o=null==i?void 0:i.groups.filter((t=>t.by.project===e));return(0,Fe.Pn)(o,Qe.r2.SESSIONS)}getTrend(e){const t=this.getScore(e,"period"),r=this.getScore(e,"week");return null===t||null===r?null:r-t}renderLoading(){return this.renderBody()}renderScore(e,t){const{loading:r}=this.state;if(r)return(0,S.tZ)("div",{children:(0,S.tZ)(H.Z,{width:"80px",height:"25px"})});const n=this.getScore(Number(e),t);return null===n?"—":(0,Ue.zB)(n)}renderTrend(e){const{loading:t}=this.state;if(t)return(0,S.tZ)("div",{children:(0,S.tZ)(H.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"—":(0,S.BX)(Ke,{color:r>=0?"green300":"red300",children:["".concat(Te()(Math.abs(r),3),"%"),(0,S.tZ)(Je,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){const{projects:e,period:t}=this.props,r=X(e.map((e=>{var t;return{project:e,trend:null!==(t=this.getTrend(Number(e.id)))&&void 0!==t?t:0}})).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))));return(0,S.tZ)(Ge,{isEmpty:0===e.length,headers:[(0,Z.t)("Project"),(0,S.tZ)(He,{children:(0,Z._N)("Last [period]",{period:t})},"last"),(0,S.tZ)(He,{children:(0,Z.t)("Last 7 Days")},"curr"),(0,S.tZ)(He,{children:(0,Z.t)("Difference")},"diff")],children:r.map((({project:e})=>(0,S.BX)(i.Fragment,{children:[(0,S.tZ)(Ye,{children:(0,S.tZ)($e,{avatarSize:18,project:e})}),(0,S.tZ)(We,{children:this.renderScore(e.id,"period")}),(0,S.tZ)(We,{children:this.renderScore(e.id,"week")}),(0,S.tZ)(We,{children:this.renderTrend(e.id)})]},e.id)))})}}const Ve=Oe,Ge=(0,n.Z)(G.Z,{target:"e182a5846"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,v.Z)(1)," ",(0,v.Z)(2),";}"),He=(0,n.Z)("span",{target:"e182a5845"})({name:"2qga7i",styles:"text-align:right"}),We=(0,n.Z)("div",{target:"e182a5844"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),Je=(0,n.Z)(ae.CC,{target:"e182a5843"})("margin:0 ",(0,v.Z)(.5),";"),Ke=(0,n.Z)("div",{target:"e182a5842"})("color:",(e=>e.theme[e.color]),";"),Ye=(0,n.Z)("div",{target:"e182a5841"})({name:"zjik7",styles:"display:flex"}),$e=(0,n.Z)(V.Z,{target:"e182a5840"})({name:"ozd7xs",styles:"flex-shrink:0"}),et="8w",tt=["pageStatsPeriod","pageStart","pageEnd","pageUtc","dataCategory","transform","sort","query","cursor","team"];function rt({location:e,router:t}){var r,n,s,d,c;const h=(0,x.M)(),z=(0,b.Z)(),{teams:T,initiallyLoaded:_}=(0,w.Z)({provideUserTeams:!0}),D=(0,o.u)(),M=null!==(r=null==e?void 0:e.query)&&void 0!==r?r:{},B="teamInsightsSelectedTeamId:".concat(z.slug);let q=null!==(n=M.team)&&void 0!==n?n:y.Z.getItem(B);q&&!T.find((e=>e.id===q))&&(q=null);const R=null!==(s=q)&&void 0!==s?s:null===(d=T[0])||void 0===d?void 0:d.id,L=T.find((e=>e.id===R)),N=null!==(c=null==L?void 0:L.projects)&&void 0!==c?c:[];function C(r){const n=a()(r,tt),i={...e,query:{...M,...n}};return t.push(i),i}(0,i.useEffect)((()=>{(0,f.Z)("team_insights.viewed",{organization:z})}),[]);const{period:A,start:P,end:X,utc:E}=function(){const{start:e,end:t,statsPeriod:r,utc:n}=(0,g.Q)(M,{allowEmptyPeriod:!0,allowAbsoluteDatetime:!0,allowAbsolutePageDatetime:!0});if(!r&&!e&&!t)return{period:et};if(r)return{period:r};const i="true"===n;return e&&t?i?{start:l().utc(e).format(),end:l().utc(t).format(),utc:i}:{start:l()(e).utc().format(),end:l()(t).utc().format(),utc:i}:{period:et}}();return 0===T.length?(0,S.tZ)(m.Z,{organization:z,superuserNeedsToBeProjectMember:!0}):(0,S.BX)(i.Fragment,{children:[(0,S.tZ)(j.Z,{organization:z,activeTab:"team"}),(0,S.BX)(it,{children:[!_&&(0,S.tZ)(p.Z,{}),_&&(0,S.BX)(u.or,{fullWidth:!0,children:[(0,S.BX)(ot,{children:[(0,S.tZ)(st,{name:"select-team",inFieldLabel:(0,Z.t)("Team: "),value:null==L?void 0:L.slug,onChange:e=>{return t=e.actor.id,y.Z.setItem(B,t),void C({team:t});var t},teamFilter:h?void 0:e=>e.isMember,styles:{singleValue(e){const t={display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:D.fontSizeMedium,":before":{...e[":before"],color:D.textColor,marginRight:(0,v.Z)(1.5),marginLeft:(0,v.Z)(.5)}};return{...e,...t}},input:(e,t)=>({...e,display:"grid",gridTemplateColumns:"max-content 1fr",alignItems:"center",gridGap:(0,v.Z)(1),":before":{backgroundColor:t.theme.backgroundSecondary,height:24,width:38,borderRadius:3,content:'""',display:"block"}})}}),(0,S.tZ)(at,{organization:z,relative:null!=A?A:"",start:null!=P?P:null,end:null!=X?X:null,utc:null!=E?E:null,onUpdate:function(e){const{start:t,end:r,relative:n,utc:i}=e;if(t&&r){const e=i?l().utc:l();return C({pageStatsPeriod:void 0,pageStart:e(t).format(),pageEnd:e(r).format(),pageUtc:null!=i?i:void 0})}return C({pageStatsPeriod:n||void 0,pageStart:void 0,pageEnd:void 0,pageUtc:void 0})},showAbsolute:!1,relativeOptions:{"14d":(0,Z.t)("Last 2 weeks"),"4w":(0,Z.t)("Last 4 weeks"),[et]:(0,Z.t)("Last 8 weeks"),"12w":(0,Z.t)("Last 12 weeks")}})]}),(0,S.tZ)(dt,{children:(0,Z.t)("Project Health")}),(0,S.tZ)(k,{title:(0,Z.t)("Crash Free Sessions"),description:(0,Z.t)("The percentage of healthy, errored, and abnormal sessions that didn’t cause a crash."),children:(0,S.tZ)(Ve,{projects:N,organization:z,period:A,start:P,end:X,utc:E})}),(0,S.tZ)(k,{title:(0,Z.t)("User Misery"),description:(0,Z.t)("The number of unique users that experienced load times 4x the project’s configured threshold."),children:(0,S.tZ)(ge,{organization:z,projects:N,teamId:L.id,period:A,start:null==P?void 0:P.toString(),end:null==X?void 0:X.toString(),location:e})}),(0,S.tZ)(k,{title:(0,Z.t)("Metric Alerts Triggered"),description:(0,Z.t)("Alerts triggered from the Alert Rules your team created."),children:(0,S.tZ)(Q,{organization:z,teamSlug:L.slug,period:A,start:null==P?void 0:P.toString(),end:null==X?void 0:X.toString(),location:e})}),(0,S.tZ)(dt,{children:(0,Z.t)("Team Activity")}),(0,S.tZ)(k,{title:(0,Z.t)("Issues Reviewed"),description:(0,Z.t)("Issues triaged by your team taking an action on them such as resolving, ignoring, marking as reviewed, or deleting."),children:(0,S.tZ)(K,{organization:z,projects:N,teamSlug:L.slug,period:A,start:null==P?void 0:P.toString(),end:null==X?void 0:X.toString(),location:e})}),(0,S.tZ)(k,{title:(0,Z.t)("Time to Resolution"),description:(0,Z.t)("The mean time it took for issues to be resolved by your team."),children:(0,S.tZ)(Ee,{organization:z,teamSlug:L.slug,period:A,start:null==P?void 0:P.toString(),end:null==X?void 0:X.toString(),location:e})}),(0,S.tZ)(k,{title:(0,Z.t)("Number of Releases"),description:(0,Z.t)("A breakdown showing how your team shipped releases over time."),children:(0,S.tZ)(Me,{projects:N,organization:z,teamSlug:L.slug,period:A,start:P,end:X,utc:E})})]})]})]})}rt.displayName="TeamInsightsOverview";const nt=rt,it=(0,n.Z)(u.uT,{target:"ese1g3n4"})("margin-bottom:-20px;@media (min-width: ",(e=>e.theme.breakpoints[1]),"){display:block;}"),ot=(0,n.Z)("div",{target:"ese1g3n3"})("display:grid;align-items:center;gap:",(0,v.Z)(1),";margin-bottom:",(0,v.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:246px 1fr;}"),st=(0,n.Z)(c.Z,{target:"ese1g3n2"})("&>div{box-shadow:",(e=>e.theme.dropShadowLight),";}"),at=(0,n.Z)(h.Z,{target:"ese1g3n1"})({name:"j6w5js",styles:"height:40px;div{min-height:unset;}"}),dt=(0,n.Z)(u.Dx,{target:"ese1g3n0"})("margin-bottom:",(0,v.Z)(1),"!important;")},"../node_modules/lodash/_baseMean.js":(e,t,r)=>{var n=r("../node_modules/lodash/_baseSum.js");e.exports=function(e,t){var r=null==e?0:e.length;return r?n(e,t)/r:NaN}},"../node_modules/lodash/_baseSum.js":e=>{e.exports=function(e,t){for(var r,n=-1,i=e.length;++n<i;){var o=t(e[n]);void 0!==o&&(r=void 0===r?o:r+o)}return r}},"../node_modules/lodash/mean.js":(e,t,r)=>{var n=r("../node_modules/lodash/_baseMean.js"),i=r("../node_modules/lodash/identity.js");e.exports=function(e){return n(e,i)}}}]);
//# sourceMappingURL=../sourcemaps/app_views_organizationStats_teamInsights_overview_tsx-node_modules_lodash_mean_js.49eb675d0f01040ffec06fec7044ddf5.js.map