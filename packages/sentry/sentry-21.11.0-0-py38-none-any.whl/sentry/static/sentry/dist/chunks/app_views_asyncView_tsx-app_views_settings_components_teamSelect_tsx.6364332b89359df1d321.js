"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_asyncView_tsx-app_views_settings_components_teamSelect_tsx"],{"./app/actionCreators/teams.tsx":(e,t,s)=>{s.d(t,{PX:()=>l,eM:()=>d,z_:()=>m,fs:()=>u,um:()=>p,s:()=>g,Cm:()=>h,tT:()=>f}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=s("./app/actionCreators/indicator.tsx"),o=s("./app/actions/teamActions.tsx"),n=s("./app/locale.tsx"),r=s("./app/utils/callIfFunction.tsx"),i=s("./app/utils/guid.tsx");const c=(e={},t,...s)=>{(0,r.g)(e[t],...s)};async function l(e,t){const s=await e.requestPromise("/organizations/".concat(t.orgId,"/user-teams/"));o.Z.loadUserTeams(s)}function d(e,t,s){return o.Z.fetchDetails(t.teamId),e.request("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{success:e=>{o.Z.fetchDetailsSuccess(t.teamId,e),c(s,"success",e)},error:e=>{o.Z.fetchDetailsError(t.teamId,e),c(s,"error",e)}})}function m(e,t){o.Z.updateSuccess(e,t)}function u(e,t,s){const a="/teams/".concat(t.orgId,"/").concat(t.teamId,"/");return o.Z.update(t.teamId,t.data),e.request(a,{method:"PUT",data:t.data,success:e=>{m(t.teamId,e),c(s,"success",e)},error:e=>{o.Z.updateError(t.teamId,e),c(s,"error",e)}})}function p(e,t,s){var a;const n="/organizations/".concat(t.orgId,"/members/").concat(null!==(a=t.memberId)&&void 0!==a?a:"me","/teams/").concat(t.teamId,"/"),r=(0,i.E)();return o.Z.update(r,t.teamId),e.request(n,{method:"POST",success:e=>{o.Z.updateSuccess(t.teamId,e),c(s,"success",e)},error:e=>{o.Z.updateError(r,t.teamId,e),c(s,"error",e)}})}function g(e,t,s){const a="/organizations/".concat(t.orgId,"/members/").concat(t.memberId||"me","/teams/").concat(t.teamId,"/"),n=(0,i.E)();return o.Z.update(n,t.teamId),e.request(a,{method:"DELETE",success:e=>{o.Z.updateSuccess(t.teamId,e),c(s,"success",e)},error:e=>{o.Z.updateError(n,t.teamId,e),c(s,"error",e)}})}function h(e,t,s){return o.Z.createTeam(t),e.requestPromise("/organizations/".concat(s.orgId,"/teams/"),{method:"POST",data:t}).then((e=>(o.Z.createTeamSuccess(e),(0,a.S9)((0,n._N)("[team] has been added to the [organization] organization",{team:"#".concat(e.slug),organization:s.orgId})),e)),(e=>{throw o.Z.createTeamError(t.slug,e),(0,a.Iw)((0,n._N)("Unable to create [team] in the [organization] organization",{team:"#".concat(t.slug),organization:s.orgId})),e}))}function f(e,t){return o.Z.removeTeam(t.teamId),e.requestPromise("/teams/".concat(t.orgId,"/").concat(t.teamId,"/"),{method:"DELETE"}).then((e=>(o.Z.removeTeamSuccess(t.teamId,e),(0,a.S9)((0,n._N)("[team] has been removed from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e)),(e=>{throw o.Z.removeTeamError(t.teamId,e),(0,a.Iw)((0,n._N)("Unable to remove [team] from the [organization] organization",{team:"#".concat(t.teamId),organization:t.orgId})),e}))}},"./app/utils/isActiveSuperuser.tsx":(e,t,s)=>{s.d(t,{M:()=>r});var a=s("../node_modules/js-cookie/src/js.cookie.js"),o=s.n(a),n=s("./app/stores/configStore.tsx");function r(){const{isSuperuser:e}=n.Z.get("user")||{};return!(!e||(o().set("su","test"),void 0!==o().get("su")))}},"./app/utils/useTeams.tsx":(e,t,s)=>{s.d(t,{Z:()=>h}),s("../node_modules/core-js/modules/es.string.trim.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=s("../node_modules/react/index.js"),o=s("../node_modules/lodash/uniqBy.js"),n=s.n(o),r=s("./app/actionCreators/teams.tsx"),i=s("./app/actions/teamActions.tsx"),c=s("./app/stores/organizationStore.tsx"),l=s("./app/stores/teamStore.tsx"),d=s("./app/stores/useLegacyStore.tsx"),m=s("./app/utils/isActiveSuperuser.tsx"),u=s("./app/utils/parseLinkHeader.tsx"),p=s("./app/utils/useApi.tsx");async function g(e,t,{slugs:s,search:a,limit:o,lastSearch:n,cursor:r}={}){const i={};var c;void 0!==s&&s.length>0&&(i.query=s.map((e=>"slug:".concat(e))).join(" ")),a&&(i.query="".concat(null!==(c=i.query)&&void 0!==c?c:""," ").concat(a).trim()),(n===a||!n&&!a)&&r&&(i.cursor=r),void 0!==o&&(i.per_page=o);let l=!1,d=null;const[m,,p]=await e.requestPromise("/organizations/".concat(t,"/teams/"),{includeAllArgs:!0,query:i}),g=null==p?void 0:p.getResponseHeader("Link");if(g){var h,f,x;const e=(0,u.Z)(g);l=(null==e||null===(h=e.next)||void 0===h?void 0:h.results)||(null==e||null===(f=e.previous)||void 0===f?void 0:f.results),d=null==e||null===(x=e.next)||void 0===x?void 0:x.cursor}return{results:m,hasMore:l,nextCursor:d}}const h=function({limit:e,slugs:t,provideUserTeams:s}={}){var o;const u=(0,p.Z)(),{organization:h}=(0,d.X)(c.Z),f=(0,d.X)(l.Z),x=null==h?void 0:h.slug,Z=new Set(f.teams.map((e=>e.slug))),v=null!==(o=null==t?void 0:t.filter((e=>!Z.has(e))))&&void 0!==o?o:[],I=v.length>0,S=s&&!f.loadedUserTeams,y=!I&&!S,[b,T]=(0,a.useState)({initiallyLoaded:y,fetching:!1,hasMore:null,lastSearch:null,nextCursor:null,fetchError:null}),w=(0,a.useRef)(null);void 0!==t&&(null===w.current&&(w.current=new Set(t)),(t.length!==w.current.size||t.some((e=>{var t;return!(null!==(t=w.current)&&void 0!==t&&t.has(e))})))&&(w.current=new Set(t))),(0,a.useEffect)((()=>{I?async function(){if(void 0!==x){T({...b,fetching:!0});try{const{results:t,hasMore:s,nextCursor:a}=await g(u,x,{slugs:v,limit:e}),o=n()([...f.teams,...t],(({slug:e})=>e));i.Z.loadTeams(o),T({...b,hasMore:s,fetching:!1,initiallyLoaded:!0,nextCursor:a})}catch(e){console.error(e),T({...b,fetching:!1,initiallyLoaded:!0,fetchError:e})}}}():S&&async function(){if(void 0!==x){T({...b,fetching:!0});try{await(0,r.PX)(u,{orgId:x}),T({...b,fetching:!1,initiallyLoaded:!0})}catch(e){console.error(e),T({...b,fetching:!1,initiallyLoaded:!0,fetchError:e})}}}()}),[w.current,s]);const _=(0,m.M)();return{teams:t?f.teams.filter((e=>t.includes(e.slug))):s&&!_?f.teams.filter((e=>e.isMember)):f.teams,fetching:b.fetching||f.loading,initiallyLoaded:b.initiallyLoaded,fetchError:b.fetchError,hasMore:b.hasMore,onSearch:async function(t){const{lastSearch:s}=b,a=b.nextCursor;if(""!==t)if(void 0!==x){T({...b,fetching:!0});try{u.clear();const{results:o,hasMore:r,nextCursor:c}=await g(u,x,{search:t,limit:e,lastSearch:s,cursor:a}),l=n()([...f.teams,...o],(({slug:e})=>e));l.length>f.teams.length&&i.Z.loadTeams(l),T({...b,hasMore:r,fetching:!1,lastSearch:t,nextCursor:c})}catch(e){console.error(e),T({...b,fetching:!1,fetchError:e})}}else console.error("Cannot use useTeam.onSearch without an organization in context")}}}},"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>i}),s("../node_modules/react/index.js");var a=s("../node_modules/react-document-title/index.js"),o=s.n(a),n=s("./app/components/asyncComponent.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends n.Z{getTitle(){return""}render(){const e=this.getTitle();return(0,r.tZ)(o(),{title:"".concat(e?"".concat(e," - "):"","Sentry"),children:this.renderComponent()})}}i.displayName="AsyncView"},"./app/views/settings/components/teamSelect.tsx":(e,t,s)=>{s.d(t,{Z:()=>L});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("../node_modules/react/index.js"),n=s("../node_modules/lodash/debounce.js"),r=s.n(n),i=s("./app/components/button.tsx"),c=s("./app/components/confirm.tsx"),l=s("./app/components/dropdownAutoComplete/index.tsx"),d=s("./app/components/dropdownButton.tsx"),m=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),u=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/lodash/isEqual.js")),p=s.n(u),g=s("./app/stores/teamStore.tsx"),h=s("./app/components/idBadge/teamBadge/badge.tsx"),f=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class x extends o.Component{constructor(...e){super(...e),(0,m.Z)(this,"state",{team:this.props.team}),(0,m.Z)(this,"unlistener",g.Z.listen((e=>this.onTeamStoreUpdate(e)),void 0))}UNSAFE_componentWillReceiveProps(e){this.state.team!==e.team&&(p()(this.state.team,e.team)||this.setState({team:e.team}))}componentWillUnmount(){var e;null===(e=this.unlistener)||void 0===e||e.call(this)}onTeamStoreUpdate(e){if(!e.has(this.state.team.id))return;const t=g.Z.getById(this.state.team.id);t&&!p()(t.avatar,this.state.team.avatar)&&this.setState({team:t})}render(){return(0,f.tZ)(h.Z,{...this.props,team:this.state.team})}}x.displayName="TeamBadgeContainer";const Z=x;var v=s("./app/components/links/link.tsx"),I=s("./app/components/loadingIndicator.tsx"),S=s("./app/components/panels/index.tsx"),y=s("./app/constants/index.tsx"),b=s("./app/icons/index.tsx"),T=s("./app/locale.tsx"),w=s("./app/styles/space.tsx"),_=s("./app/utils/useTeams.tsx"),z=s("./app/views/settings/components/emptyMessage.tsx");function j({disabled:e,selectedTeams:t,menuHeader:s,organization:a,onAddTeam:o,onRemoveTeam:n,confirmLastTeamRemoveMessage:i,loadingTeams:c}){const{teams:m,onSearch:u,fetching:p}=(0,_.Z)(),g=m.filter((e=>!t.some((t=>t.slug===e.slug)))).map(((e,t)=>({index:t,value:e.slug,searchKey:e.slug,label:(0,f.tZ)(C,{avatarSize:18,team:e})})));return(0,f.BX)(S.s_,{children:[(0,f.BX)(S.V9,{hasButtons:!0,children:[(0,T.t)("Team"),(0,f.tZ)(l.Z,{items:g,busyItemsStillVisible:p,onChange:r()((e=>u(e.target.value)),y.Dk),onSelect:e=>{const t=m.find((t=>t.slug===e.value));t&&o(t)},emptyMessage:(0,T.t)("No teams"),menuHeader:s,disabled:e,alignMenu:"right",children:({isOpen:t})=>(0,f.tZ)(d.Z,{"aria-label":(0,T.t)("Add Team"),isOpen:t,size:"xsmall",disabled:e,children:(0,T.t)("Add Team")})})]}),(0,f.tZ)(S.N,{children:c?(0,f.tZ)(I.Z,{}):(()=>{if(0===t.length)return(0,f.tZ)(z.Z,{children:(0,T.t)("No Teams assigned")});const s=1===t.length&&i?i:null;return t.map((t=>(0,f.tZ)(E,{orgId:a.slug,team:t,onRemove:e=>n(e),disabled:e,confirmMessage:s},t.slug)))})()})]})}j.displayName="TeamSelect";const E=({orgId:e,team:t,onRemove:s,disabled:a,confirmMessage:o})=>(0,f.BX)(M,{children:[(0,f.tZ)(q,{to:"/settings/".concat(e,"/teams/").concat(t.slug,"/"),children:(0,f.tZ)(Z,{team:t})}),(0,f.tZ)(c.Z,{message:o,bypass:!o,onConfirm:()=>s(t.slug),disabled:a,children:(0,f.tZ)(i.ZP,{size:"xsmall",icon:(0,f.tZ)(b.JZ,{isCircled:!0,size:"xs"}),disabled:a,children:(0,T.t)("Remove")})})]});E.displayName="TeamRow";const C=(0,a.Z)(Z,{target:"e1u21fi92"})("font-weight:normal;font-size:",(e=>e.theme.fontSizeMedium),";text-transform:none;"),M=(0,a.Z)(S.Lv,{target:"e1u21fi91"})("padding:",(0,w.Z)(2),";align-items:center;"),q=(0,a.Z)(v.Z,{target:"e1u21fi90"})("flex:1;margin-right:",(0,w.Z)(1),";"),L=j}}]);
//# sourceMappingURL=../sourcemaps/app_views_asyncView_tsx-app_views_settings_components_teamSelect_tsx.c4ca6f1752630262011f36c84bbd72c8.js.map