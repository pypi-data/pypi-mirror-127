"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_components_events_searchBar_tsx-app_components_sentryDocumentTitle_tsx-app_utils_useTeams-df7ebe","app_components_sentryDocumentTitle_tsx"],{"./app/components/events/searchBar.tsx":(e,t,s)=>{s.d(t,{Z:()=>k});var o,n=s("../node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.string.replace.js"),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/react/index.js")),i=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),l=s("../node_modules/lodash/assign.js"),c=s.n(l),d=s("../node_modules/lodash/flatten.js"),u=s.n(d),p=s("../node_modules/lodash/isEqual.js"),m=s.n(p),h=s("../node_modules/lodash/memoize.js"),g=s.n(h),f=s("../node_modules/lodash/omit.js"),v=s.n(f),x=s("./app/actionCreators/tags.tsx"),j=s("./app/components/smartSearchBar/index.tsx"),y=s("./app/constants/index.tsx"),b=s("./app/types/index.tsx"),Z=s("./app/utils.tsx"),T=s("./app/utils/discover/fields.tsx"),w=s("./app/utils/measurements/measurements.tsx"),S=s("./app/utils/withApi.tsx"),_=s("./app/utils/withTags.tsx"),q=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const C=new RegExp("^".concat(y.c$,"|\\").concat(y.ir),"g");class A extends a.PureComponent{constructor(...e){super(...e),(0,r.Z)(this,"getEventFieldValues",g()(((e,t,s)=>{const{api:o,organization:n,projectIds:r}=this.props,a=null==r?void 0:r.map(String);return(0,T.h1)(e.key)||(0,T.Xr)(e.key)?Promise.resolve([]):(0,x.Fo)(o,n.slug,e.key,t,a,s,!0).then((e=>u()(e.filter((({name:e})=>(0,Z.ri)(e))).map((({name:e})=>e)))),(()=>{throw new Error("Unable to fetch event field values")}))}),(({key:e},t)=>"".concat(e,"-").concat(t)))),(0,r.Z)(this,"prepareQuery",(e=>e.replace(C,"")))}componentDidMount(){var e,t;null===(e=(t=this.getEventFieldValues.cache).clear)||void 0===e||e.call(t)}componentDidUpdate(e){var t,s;m()(this.props.projectIds,e.projectIds)||null===(t=(s=this.getEventFieldValues.cache).clear)||void 0===t||t.call(s)}getTagList(e){const{fields:t,organization:s,tags:o,omitTags:n}=this.props,r=t?Object.fromEntries(t.filter((e=>!Object.keys(T.wZ).includes(e.field)&&!(0,T.GO)(e.field))).map((e=>[e.field,{key:e.field,name:e.field}]))):{},a=s.features.includes("performance-view")?Object.assign({},e,T.wZ,r):v()(T.wZ,T.J8),i=s.features.includes("semver")?Object.assign({},T.jg,a):a,l=c()({},o,i);return l.has={key:"has",name:"Has property",values:Object.keys(l),predefined:!0},v()(l,null!=n?n:[])}render(){const{organization:e}=this.props;return(0,q.tZ)(w.Z,{organization:e,children:({measurements:e})=>{const t=this.getTagList(e);return(0,q.tZ)(i.ms,{children:({css:e})=>(0,q.tZ)(j.Z,{hasRecentSearches:!0,savedSearchType:b.L4.EVENT,onGetTagValues:this.getEventFieldValues,supportedTags:t,prepareQuery:this.prepareQuery,excludeEnvironment:!0,dropdownClassName:e(o||(o=(0,n.Z)(["\n                    max-height: 300px;\n                    overflow-y: auto;\n                  "]))),...this.props})})}})}}A.displayName="SearchBar";const k=(0,S.Z)((0,_.Z)(A))},"./app/components/sentryDocumentTitle.tsx":(e,t,s)=>{s.d(t,{Z:()=>i}),s("../node_modules/react/index.js");var o=s("../node_modules/react-document-title/index.js"),n=s.n(o),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a({title:e,orgSlug:t,projectSlug:s,children:o}){const a=t||s?t&&s?"".concat(e," - ").concat(t," - ").concat(s):t?"".concat(e," - ").concat(t):"".concat(e," - ").concat(s):e;return(0,r.tZ)(n(),{title:"".concat(a," - Sentry"),children:o})}a.displayName="SentryDocumentTitle";const i=a},"./app/utils/isActiveSuperuser.tsx":(e,t,s)=>{s.d(t,{M:()=>a});var o=s("../node_modules/js-cookie/src/js.cookie.js"),n=s.n(o),r=s("./app/stores/configStore.tsx");function a(){const{isSuperuser:e}=r.Z.get("user")||{};return!(!e||(n().set("su","test"),void 0!==n().get("su")))}},"./app/utils/measurements/measurements.tsx":(e,t,s)=>{s.d(t,{Z:()=>d}),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=s("../node_modules/react/index.js"),n=s("./app/utils/performance/vitals/constants.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){return Object.fromEntries(Object.entries(e).map((([e,t])=>[e,{name:t.name,key:e}])))}const i=a(n.T),l=a(n.r);function c({organization:e,children:t}){const s=e.features.includes("performance-mobile-vitals")?{...l,...i}:l;return(0,r.tZ)(o.Fragment,{children:t({measurements:s})})}c.displayName="Measurements";const d=c},"./app/utils/useTeams.tsx":(e,t,s)=>{s.d(t,{Z:()=>g}),s("../node_modules/core-js/modules/es.string.trim.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var o=s("../node_modules/react/index.js"),n=s("../node_modules/lodash/uniqBy.js"),r=s.n(n),a=s("./app/actionCreators/teams.tsx"),i=s("./app/actions/teamActions.tsx"),l=s("./app/stores/organizationStore.tsx"),c=s("./app/stores/teamStore.tsx"),d=s("./app/stores/useLegacyStore.tsx"),u=s("./app/utils/isActiveSuperuser.tsx"),p=s("./app/utils/parseLinkHeader.tsx"),m=s("./app/utils/useApi.tsx");async function h(e,t,{slugs:s,search:o,limit:n,lastSearch:r,cursor:a}={}){const i={};var l;void 0!==s&&s.length>0&&(i.query=s.map((e=>"slug:".concat(e))).join(" ")),o&&(i.query="".concat(null!==(l=i.query)&&void 0!==l?l:""," ").concat(o).trim()),(r===o||!r&&!o)&&a&&(i.cursor=a),void 0!==n&&(i.per_page=n);let c=!1,d=null;const[u,,m]=await e.requestPromise("/organizations/".concat(t,"/teams/"),{includeAllArgs:!0,query:i}),h=null==m?void 0:m.getResponseHeader("Link");if(h){var g,f,v;const e=(0,p.Z)(h);c=(null==e||null===(g=e.next)||void 0===g?void 0:g.results)||(null==e||null===(f=e.previous)||void 0===f?void 0:f.results),d=null==e||null===(v=e.next)||void 0===v?void 0:v.cursor}return{results:u,hasMore:c,nextCursor:d}}const g=function({limit:e,slugs:t,provideUserTeams:s}={}){var n;const p=(0,m.Z)(),{organization:g}=(0,d.X)(l.Z),f=(0,d.X)(c.Z),v=null==g?void 0:g.slug,x=new Set(f.teams.map((e=>e.slug))),j=null!==(n=null==t?void 0:t.filter((e=>!x.has(e))))&&void 0!==n?n:[],y=j.length>0,b=s&&!f.loadedUserTeams,Z=!y&&!b,[T,w]=(0,o.useState)({initiallyLoaded:Z,fetching:!1,hasMore:null,lastSearch:null,nextCursor:null,fetchError:null}),S=(0,o.useRef)(null);void 0!==t&&(null===S.current&&(S.current=new Set(t)),(t.length!==S.current.size||t.some((e=>{var t;return!(null!==(t=S.current)&&void 0!==t&&t.has(e))})))&&(S.current=new Set(t))),(0,o.useEffect)((()=>{y?async function(){if(void 0!==v){w({...T,fetching:!0});try{const{results:t,hasMore:s,nextCursor:o}=await h(p,v,{slugs:j,limit:e}),n=r()([...f.teams,...t],(({slug:e})=>e));i.Z.loadTeams(n),w({...T,hasMore:s,fetching:!1,initiallyLoaded:!0,nextCursor:o})}catch(e){console.error(e),w({...T,fetching:!1,initiallyLoaded:!0,fetchError:e})}}}():b&&async function(){if(void 0!==v){w({...T,fetching:!0});try{await(0,a.PX)(p,{orgId:v}),w({...T,fetching:!1,initiallyLoaded:!0})}catch(e){console.error(e),w({...T,fetching:!1,initiallyLoaded:!0,fetchError:e})}}}()}),[S.current,s]);const _=(0,u.M)();return{teams:t?f.teams.filter((e=>t.includes(e.slug))):s&&!_?f.teams.filter((e=>e.isMember)):f.teams,fetching:T.fetching||f.loading,initiallyLoaded:T.initiallyLoaded,fetchError:T.fetchError,hasMore:T.hasMore,onSearch:async function(t){const{lastSearch:s}=T,o=T.nextCursor;if(""!==t)if(void 0!==v){w({...T,fetching:!0});try{p.clear();const{results:n,hasMore:a,nextCursor:l}=await h(p,v,{search:t,limit:e,lastSearch:s,cursor:o}),c=r()([...f.teams,...n],(({slug:e})=>e));c.length>f.teams.length&&i.Z.loadTeams(c),w({...T,hasMore:a,fetching:!1,lastSearch:t,nextCursor:l})}catch(e){console.error(e),w({...T,fetching:!1,fetchError:e})}}else console.error("Cannot use useTeam.onSearch without an organization in context")}}}},"./app/utils/withTags.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("./app/stores/tagStore.tsx"),a=s("./app/utils/getDisplayName.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends n.Component{constructor(...e){super(...e),(0,o.Z)(this,"state",{tags:r.Z.getAllTags()}),(0,o.Z)(this,"unsubscribe",r.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...s}=this.props;return(0,i.tZ)(e,{tags:null!=t?t:this.state.tags,...s})}}return t.displayName="WithTags",(0,o.Z)(t,"displayName","withTags(".concat((0,a.Z)(e),")")),t}},"./app/views/performance/transactionSummary/transactionEvents/utils.tsx":(e,t,s)=>{s.d(t,{q3:()=>i,_S:()=>l,xr:()=>c,tb:()=>d,qg:()=>u,Zq:()=>p});var o=s("./app/locale.tsx"),n=s("./app/utils/queryString.tsx"),r=s("./app/views/performance/transactionSummary/filter.tsx"),a=s("./app/views/performance/transactionSummary/utils.tsx");let i;function l(e,t){const{p99:s,p95:n,p75:a,p50:l}=t||{p99:0,p95:0,p75:0,p50:0};return{[i.p50]:{name:i.p50,query:l?[["transaction.duration","<=".concat(l.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,r.T$)(e)||"transaction.duration"},label:(0,o.t)("p50")},[i.p75]:{name:i.p75,query:a?[["transaction.duration","<=".concat(a.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,r.T$)(e)||"transaction.duration"},label:(0,o.t)("p75")},[i.p95]:{name:i.p95,query:n?[["transaction.duration","<=".concat(n.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,r.T$)(e)||"transaction.duration"},label:(0,o.t)("p95")},[i.p99]:{name:i.p99,query:s?[["transaction.duration","<=".concat(s.toFixed(0))]]:void 0,sort:{kind:"desc",field:(0,r.T$)(e)||"transaction.duration"},label:(0,o.t)("p99")},[i.p100]:{name:i.p100,label:(0,o.t)("p100")}}}function c({orgSlug:e,transaction:t,projectID:s,query:o}){return{pathname:"/organizations/".concat(e,"/performance/summary/events/"),query:{transaction:t,project:s,environment:o.environment,statsPeriod:o.statsPeriod,start:o.start,end:o.end,query:o.query}}}function d(e){return t=(0,n.ro)(e.query.showTransactions,i.p100),Object.values(i).includes(t)?t:i.p100;var t}function u(e,t){var s,o;const n=l(t),r=null===(s=n[e].sort)||void 0===s?void 0:s.kind,a=null===(o=n[e].sort)||void 0===o?void 0:o.field,i={showTransactions:e};return r&&a&&(i.sort="".concat("desc"===r?"-":"").concat(a)),i}function p(e){switch(e){case a.K0.OUTLIER:return i.p100;case a.K0.SLOW:return i.p95;default:return}}!function(e){e.p50="p50",e.p75="p75",e.p95="p95",e.p99="p99",e.p100="p100"}(i||(i={}))},"./app/views/performance/transactionSummary/transactionThresholdModal.tsx":(e,t,s)=>{s.d(t,{fY:()=>C,ZP:()=>A});var o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("../node_modules/lodash/cloneDeep.js"),i=s.n(a),l=s("../node_modules/lodash/set.js"),c=s.n(l),d=s("./app/actionCreators/indicator.tsx"),u=s("./app/components/button.tsx"),p=s("./app/components/buttonBar.tsx"),m=s("./app/components/forms/selectControl.tsx"),h=s("./app/components/links/link.tsx"),g=s("./app/locale.tsx"),f=s("./app/styles/space.tsx"),v=s("./app/utils.tsx"),x=s("./app/utils/withApi.tsx"),j=s("./app/utils/withProjects.tsx"),y=s("./app/views/settings/components/forms/controls/input.tsx"),b=s("./app/views/settings/components/forms/field/index.tsx"),Z=s("./app/views/performance/transactionSummary/utils.tsx"),T=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");let w;!function(e){e.TRANSACTION_DURATION="duration",e.LARGEST_CONTENTFUL_PAINT="lcp"}(w||(w={}));const S=[{label:(0,g.t)("Transaction Duration"),value:"duration"},{label:(0,g.t)("Largest Contentful Paint"),value:"lcp"}];class _ extends r.Component{constructor(...e){super(...e),(0,o.Z)(this,"state",{threshold:this.props.transactionThreshold,metric:this.props.transactionThresholdMetric,error:null}),(0,o.Z)(this,"handleApply",(async e=>{e.preventDefault();const{api:t,closeModal:s,organization:o,transactionName:n,onApply:r}=this.props,a=this.getProject();if(!(0,v.ri)(a))return;const i="/organizations/".concat(o.slug,"/project-transaction-threshold-override/");t.requestPromise(i,{method:"POST",includeAllArgs:!0,query:{project:a.id},data:{transaction:n,threshold:this.state.threshold,metric:this.state.metric}}).then((()=>{s(),r&&r(this.state.threshold,this.state.metric)})).catch((e=>{var t,s,o,n;this.setState({error:e});const r=null!==(t=null!==(s=null===(o=e.responseJSON)||void 0===o?void 0:o.threshold)&&void 0!==s?s:null===(n=e.responseJSON)||void 0===n?void 0:n.non_field_errors)&&void 0!==t?t:null;(0,d.Iw)(r)}))})),(0,o.Z)(this,"handleFieldChange",(e=>t=>{this.setState((s=>{const o=i()(s);return c()(o,e,t),{...o,errors:void 0}}))})),(0,o.Z)(this,"handleReset",(async e=>{e.preventDefault();const{api:t,closeModal:s,organization:o,transactionName:n,onApply:r}=this.props,a=this.getProject();if(!(0,v.ri)(a))return;const i="/organizations/".concat(o.slug,"/project-transaction-threshold-override/");t.requestPromise(i,{method:"DELETE",includeAllArgs:!0,query:{project:a.id},data:{transaction:n}}).then((()=>{const e="/projects/".concat(o.slug,"/").concat(a.slug,"/transaction-threshold/configure/");this.props.api.requestPromise(e,{method:"GET",includeAllArgs:!0,query:{project:a.id}}).then((([e])=>{this.setState({threshold:e.threshold,metric:e.metric}),s(),r&&r(this.state.threshold,this.state.metric)})).catch((e=>{var t,s;const o=null!==(t=null===(s=e.responseJSON)||void 0===s?void 0:s.threshold)&&void 0!==t?t:null;(0,d.Iw)(o)}))})).catch((e=>{this.setState({error:e})}))}))}getProject(){const{projects:e,eventView:t,project:s}=this.props;if((0,v.ri)(s))return e.find((e=>e.id===s));const o=String(t.project[0]);return e.find((e=>e.id===o))}renderModalFields(){return(0,T.BX)(r.Fragment,{children:[(0,T.tZ)(b.Z,{"data-test-id":"response-metric",label:(0,g.t)("Calculation Method"),inline:!1,help:(0,g.t)("This determines which duration metric is used for the Response Time Threshold."),showHelpInTooltip:!0,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,T.tZ)(m.Z,{required:!0,options:S.slice(),name:"responseMetric",label:(0,g.t)("Calculation Method"),value:this.state.metric,onChange:e=>{this.handleFieldChange("metric")(e.value)}})}),(0,T.tZ)(b.Z,{"data-test-id":"response-time-threshold",label:(0,g.t)("Response Time Threshold (ms)"),inline:!1,help:(0,g.t)("The satisfactory response time for the calculation method defined above. This is used to calculate Apdex and User Misery scores."),showHelpInTooltip:!0,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,T.tZ)(y.Z,{type:"number",name:"threshold",required:!0,pattern:"[0-9]*(\\.[0-9]*)?",onChange:e=>{this.handleFieldChange("threshold")(e.target.value)},value:this.state.threshold,step:100,min:100})})]})}render(){const{Header:e,Body:t,Footer:s,organization:o,transactionName:n,eventView:a}=this.props,i=this.getProject(),l=a.clone();l.query=l.getQueryWithAdditionalConditions();const c=(0,Z.e1)({orgSlug:o.slug,transaction:n,query:l.generateQueryStringObject(),projectID:null==i?void 0:i.id});return(0,T.BX)(r.Fragment,{children:[(0,T.tZ)(e,{closeButton:!0,children:(0,T.tZ)("h4",{children:(0,g.t)("Transaction Settings")})}),(0,T.BX)(t,{children:[(0,T.tZ)(q,{children:(0,g._N)("The changes below will only be applied to [transaction]. To set it at a more global level, go to [projectSettings: Project Settings].",{transaction:(0,T.tZ)(h.Z,{to:c,children:n}),projectSettings:(0,T.tZ)(h.Z,{to:"/settings/".concat(o.slug,"/projects/").concat(null==i?void 0:i.slug,"/performance/")})})}),this.renderModalFields()]}),(0,T.tZ)(s,{children:(0,T.BX)(p.ZP,{gap:1,children:[(0,T.tZ)(u.ZP,{priority:"default",onClick:this.handleReset,"data-test-id":"reset-all",children:(0,g.t)("Reset All")}),(0,T.tZ)(u.ZP,{label:(0,g.t)("Apply"),priority:"primary",onClick:this.handleApply,"data-test-id":"apply-threshold",children:(0,g.t)("Apply")})]})})]})}}_.displayName="TransactionThresholdModal";const q=(0,n.Z)("div",{target:"ezg6l150"})("margin-bottom:",(0,f.Z)(4),";"),C={name:"9w3zq5",styles:"width:100%;max-width:650px;margin:70px auto"},A=(0,x.Z)((0,j.Z)(_))}}]);
//# sourceMappingURL=../sourcemaps/app_components_events_searchBar_tsx-app_components_sentryDocumentTitle_tsx-app_utils_useTeams-df7ebe.707126056c3525818e703adb74604f21.js.map