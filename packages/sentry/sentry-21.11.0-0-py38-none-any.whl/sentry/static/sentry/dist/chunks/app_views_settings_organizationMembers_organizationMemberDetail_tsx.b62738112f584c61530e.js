"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_organizationMembers_organizationMemberDetail_tsx"],{"./app/utils/isMemberDisabledFromLimit.tsx":(e,t,s)=>{function i(e){var t;return null!==(t=null==e?void 0:e.flags["member-limit:restricted"])&&void 0!==t&&t}s.d(t,{Z:()=>i})},"./app/utils/recreateRoute.tsx":(e,t,s)=>{s.d(t,{Z:()=>r});var i=s("../node_modules/lodash/findLastIndex.js"),n=s.n(i),a=s("./app/utils/replaceRouterParams.tsx");function r(e,t){var s,i;const{routes:r,params:o,location:d,stepBack:l}=t,c=r.map((({path:e})=>e||""));let m,h;"string"!=typeof e?(h=r.indexOf(e)+1,m=n()(c.slice(0,h),(e=>"/"===e[0]))):m=n()(c,(e=>"/"===e[0]));let p=c.slice(m,h);void 0!==l&&(p=p.slice(0,l));const u=null!==(s=null==d?void 0:d.search)&&void 0!==s?s:"",g=null!==(i=null==d?void 0:d.hash)&&void 0!==i?i:"",b="".concat(p.join("")).concat("string"!=typeof e?"":e).concat(u).concat(g);return(0,a.Z)(b,o)}},"./app/utils/teams.tsx":(e,t,s)=>{s.d(t,{Z:()=>o});var i=s("../node_modules/react/index.js"),n=s("./app/utils/useTeams.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r({children:e,...t}){const s=(0,n.Z)(t);return(0,a.tZ)(i.Fragment,{children:e(s)})}r.displayName="Teams";const o=r},"./app/views/settings/organizationMembers/organizationMemberDetail.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>q});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("../node_modules/react-router/es/index.js"),o=s("../node_modules/@sentry/minimal/esm/index.js"),d=s("./app/actionCreators/account.tsx"),l=s("./app/actionCreators/indicator.tsx"),c=s("./app/actionCreators/members.tsx"),m=s("./app/components/autoSelectText.tsx"),h=s("./app/components/button.tsx"),p=s("./app/components/confirm.tsx"),u=s("./app/components/dateTime.tsx"),g=s("./app/components/errors/notFound.tsx"),b=s("./app/components/hookOrDefault.tsx"),Z=s("./app/components/links/externalLink.tsx"),v=s("./app/components/panels/index.tsx"),x=s("./app/components/tooltip.tsx"),f=s("./app/locale.tsx"),w=s("./app/styles/input.tsx"),y=s("./app/styles/space.tsx"),S=s("./app/utils/isMemberDisabledFromLimit.tsx"),R=s("./app/utils/recreateRoute.tsx"),k=s("./app/utils/teams.tsx"),B=s("./app/utils/withOrganization.tsx"),_=s("./app/views/asyncView.tsx"),z=s("./app/views/settings/components/forms/field/index.tsx"),C=s("./app/views/settings/components/settingsPageHeader.tsx"),I=s("./app/views/settings/components/teamSelect.tsx"),T=s("./app/components/radio.tsx"),j=s("./app/views/settings/components/text/textBlock.tsx"),X=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const M=(0,n.Z)("label",{target:"eh6xwcb0"})({name:"ddvan8",styles:"display:flex;flex:1;align-items:center;margin-bottom:0"});class N extends a.Component{render(){const{disabled:e,enforceAllowed:t,roleList:s,selectedRole:i}=this.props;return(0,X.BX)(v.s_,{children:[(0,X.tZ)(v.V9,{children:(0,f.t)("Role")}),(0,X.tZ)(v.N,{children:s.map((s=>{const{desc:n,name:a,id:r,allowed:o}=s,d=e||t&&!o;return(0,X.tZ)(v.Lv,{onClick:()=>!d&&this.props.setRole(r),css:d?{color:"grey",cursor:"default"}:{},children:(0,X.BX)(M,{children:[(0,X.tZ)(T.Z,{id:r,value:a,checked:r===i,readOnly:!0}),(0,X.BX)("div",{style:{flex:1,padding:"0 16px"},children:[a,(0,X.tZ)(j.Z,{noMargin:!0,children:(0,X.tZ)("div",{className:"help-block",children:n})})]})]})},r)}))})]})}}N.displayName="RoleSelect";const A=N,L=(0,f.t)("Cannot be reset since user is in more than one organization"),D=(0,f.t)("Not enrolled in two-factor authentication"),P=(0,f.t)("You do not have permission to perform this action"),F=(0,f.t)("Cannot be reset since two-factor is required for this organization"),O=(0,b.Z)({hookName:"component:disabled-member-tooltip",defaultComponent:({children:e})=>(0,X.tZ)(a.Fragment,{children:e})});class E extends _.Z{constructor(...e){super(...e),(0,i.Z)(this,"handleSave",(async()=>{const{organization:e,params:t}=this.props;(0,l.E3)((0,f.t)("Saving...")),this.setState({busy:!0});try{await(0,c.hS)(this.api,{orgId:e.slug,memberId:t.memberId,data:this.state.member}),(0,l.S9)((0,f.t)("Saved")),this.redirectToMemberPage()}catch(e){const t=e&&e.responseJSON&&e.responseJSON.detail||(0,f.t)("Could not save...");(0,l.Iw)(t)}this.setState({busy:!1})})),(0,i.Z)(this,"handleInvite",(async e=>{const{organization:t,params:s}=this.props;(0,l.E3)((0,f.t)("Sending invite...")),this.setState({busy:!0});try{const i=await(0,c.R_)(this.api,{orgId:t.slug,memberId:s.memberId,regenerate:e});(0,l.S9)((0,f.t)("Sent invite!")),e&&this.setState((e=>({member:{...e.member,...i}})))}catch(e){(0,l.Iw)((0,f.t)("Could not send invite"))}this.setState({busy:!1})})),(0,i.Z)(this,"handleAddTeam",(e=>{const{member:t}=this.state;t.teams.includes(e.slug)||t.teams.push(e.slug),this.setState({member:t})})),(0,i.Z)(this,"handleRemoveTeam",(e=>{const{member:t}=this.state;this.setState({member:{...t,teams:t.teams.filter((t=>t!==e))}})})),(0,i.Z)(this,"handle2faReset",(async()=>{const{organization:e,router:t}=this.props,{user:s}=this.state.member,i=s.authenticators.map((e=>(0,d.Hb)(this.api,s.id,e.id)));try{await Promise.all(i),t.push("/settings/".concat(e.slug,"/members/")),(0,l.S9)((0,f.t)("All authenticators have been removed"))}catch(e){(0,l.Iw)((0,f.t)("Error removing authenticators")),o.Tb(e)}})),(0,i.Z)(this,"showResetButton",(()=>{const{organization:e}=this.props,{member:t}=this.state,{user:s}=t;return!(!s||!s.authenticators||e.require2FA)&&(s.authenticators.length>=1&&s.canReset2fa)})),(0,i.Z)(this,"getTooltip",(()=>{const{organization:e}=this.props,{member:t}=this.state,{user:s}=t;return s?s.authenticators?s.authenticators.length?s.canReset2fa?e.require2FA?F:"":L:D:P:""}))}getDefaultState(){return{...super.getDefaultState(),roleList:[],selectedRole:"",member:null}}getEndpoints(){const{organization:e,params:t}=this.props;return[["member","/organizations/".concat(e.slug,"/members/").concat(t.memberId,"/")]]}redirectToMemberPage(){const{location:e,params:t,routes:s}=this.props,i=(0,R.Z)("members/",{location:e,routes:s,params:t,stepBack:-2});r.browserHistory.push(i)}get memberDeactivated(){return(0,S.Z)(this.state.member)}renderMemberStatus(e){return this.memberDeactivated?(0,X.tZ)("em",{children:(0,X.tZ)(O,{children:(0,f.t)("Deactivated")})}):e.expired?(0,X.tZ)("em",{children:(0,f.t)("Invitation Expired")}):e.pending?(0,X.tZ)("em",{children:(0,f.t)("Invitation Pending")}):(0,f.t)("Active")}renderBody(){const{organization:e}=this.props,{member:t}=this.state;if(!t)return(0,X.tZ)(g.Z,{});const{access:s}=e,i=t.invite_link,n=s.includes("org:write")&&!this.memberDeactivated,{email:r,expired:o,pending:d}=t,l=!o,c=!d;return(0,X.BX)(a.Fragment,{children:[(0,X.tZ)(C.Z,{title:(0,X.BX)(a.Fragment,{children:[(0,X.tZ)("div",{children:t.name}),(0,X.tZ)(V,{children:(0,f.t)("Member Settings")})]})}),(0,X.BX)(v.s_,{children:[(0,X.tZ)(v.V9,{children:(0,f.t)("Basics")}),(0,X.tZ)(v.N,{children:(0,X.tZ)(v.Lv,{children:(0,X.BX)(G,{children:[(0,X.BX)(H,{children:[(0,X.BX)("div",{children:[(0,X.tZ)(J,{children:(0,f.t)("Email")}),(0,X.tZ)("div",{children:(0,X.tZ)(Z.Z,{href:"mailto:".concat(r),children:r})})]}),(0,X.BX)("div",{children:[(0,X.tZ)(J,{children:(0,f.t)("Status")}),(0,X.tZ)("div",{"data-test-id":"member-status",children:this.renderMemberStatus(t)})]}),(0,X.BX)("div",{children:[(0,X.tZ)(J,{children:(0,f.t)("Added")}),(0,X.tZ)("div",{children:(0,X.tZ)(u.Z,{dateOnly:!0,date:t.dateCreated})})]})]}),i&&(0,X.BX)(Y,{children:[(0,X.BX)("div",{children:[(0,X.tZ)(J,{children:(0,f.t)("Invite Link")}),(0,X.tZ)(m.Z,{children:(0,X.tZ)(K,{children:i})}),(0,X.tZ)("p",{className:"help-block",children:(0,f.t)("This unique invite link may only be used by this member.")})]}),(0,X.BX)(Q,{children:[(0,X.tZ)(h.ZP,{onClick:()=>this.handleInvite(!0),children:(0,f.t)("Generate New Invite")}),l&&(0,X.tZ)(h.ZP,{"data-test-id":"resend-invite",onClick:()=>this.handleInvite(!1),children:(0,f.t)("Resend Invite")})]})]})]})})})]}),c&&(0,X.BX)(v.s_,{children:[(0,X.tZ)(v.V9,{children:(0,f.t)("Authentication")}),(0,X.tZ)(v.N,{children:(0,X.tZ)(z.Z,{alignRight:!0,flexibleControlStateSize:!0,label:(0,f.t)("Reset two-factor authentication"),help:(0,f.t)("Resetting two-factor authentication will remove all two-factor authentication methods for this member."),children:(0,X.tZ)(x.Z,{"data-test-id":"reset-2fa-tooltip",disabled:this.showResetButton(),title:this.getTooltip(),children:(0,X.tZ)(p.Z,{disabled:!this.showResetButton(),message:(0,f._N)("Are you sure you want to disable all two-factor authentication methods for [name]?",{name:t.name?t.name:"this member"}),onConfirm:this.handle2faReset,"data-test-id":"reset-2fa-confirm",children:(0,X.tZ)(h.ZP,{"data-test-id":"reset-2fa",priority:"danger",children:(0,f.t)("Reset two-factor authentication")})})})})})]}),(0,X.tZ)(A,{enforceAllowed:!1,disabled:!n,roleList:t.roles,selectedRole:t.role,setRole:e=>this.setState({member:{...t,role:e}})}),(0,X.tZ)(k.Z,{slugs:t.teams,children:({teams:t,initiallyLoaded:s})=>(0,X.tZ)(I.Z,{organization:e,selectedTeams:t,disabled:!n,onAddTeam:this.handleAddTeam,onRemoveTeam:this.handleRemoveTeam,loadingTeams:!s})}),(0,X.tZ)(U,{children:(0,X.tZ)(h.ZP,{priority:"primary",busy:this.state.busy,onClick:this.handleSave,disabled:!n,children:(0,f.t)("Save Member")})})]})}}const q=(0,B.Z)(E),V=(0,n.Z)("div",{target:"euxp5937"})("color:",(e=>e.theme.gray300),";font-weight:normal;font-size:",(e=>e.theme.fontSizeLarge),";"),H=(0,n.Z)("div",{target:"euxp5936"})("display:grid;grid-auto-flow:column;grid-template-columns:2fr 1fr 1fr;grid-gap:",(0,y.Z)(2),";width:100%;@media (max-width: ",(e=>e.theme.breakpoints[0]),"){grid-auto-flow:row;grid-template-columns:auto;}"),J=(0,n.Z)("div",{target:"euxp5935"})("font-weight:bold;margin-bottom:",(0,y.Z)(.5),";color:",(e=>e.theme.textColor),";"),G=(0,n.Z)("div",{target:"euxp5934"})({name:"8za49e",styles:"overflow:hidden;flex:1"}),Y=(0,n.Z)("div",{target:"euxp5933"})("border-top:1px solid ",(e=>e.theme.border),";margin-top:",(0,y.Z)(2),";padding-top:",(0,y.Z)(2),";"),K=(0,n.Z)("code",{target:"euxp5932"})((e=>(0,w.T)(e)),";"),Q=(0,n.Z)("div",{target:"euxp5931"})("display:grid;grid-gap:",(0,y.Z)(1),";grid-auto-flow:column;justify-content:flex-end;margin-top:",(0,y.Z)(2),";"),U=(0,n.Z)("div",{target:"euxp5930"})({name:"skgbeu",styles:"display:flex;justify-content:flex-end"})}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationMembers_organizationMemberDetail_tsx.f3db0a7bb2af2a0c5ceef2b567294b03.js.map