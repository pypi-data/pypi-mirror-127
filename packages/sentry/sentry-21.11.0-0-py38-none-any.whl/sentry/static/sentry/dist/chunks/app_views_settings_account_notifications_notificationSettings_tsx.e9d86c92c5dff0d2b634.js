"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_account_notifications_notificationSettings_tsx"],{"./app/components/alertLink.tsx":(t,e,n)=>{n.d(e,{Z:()=>d});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(n("../node_modules/react/index.js"),n("../node_modules/lodash/omit.js")),o=n.n(i),a=n("./app/components/links/externalLink.tsx"),r=n("./app/components/links/link.tsx"),l=n("./app/icons/index.tsx"),c=n("./app/styles/space.tsx"),p=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u({size:t="normal",priority:e="warning",icon:n,children:s,onClick:i,withoutMarginBottom:o=!1,openInNewTab:a=!1,to:r,href:c,"data-test-id":u}){return(0,p.BX)(m,{"data-test-id":u,to:r,href:c,onClick:i,size:t,priority:e,withoutMarginBottom:o,openInNewTab:a,children:[n&&(0,p.tZ)(f,{children:n}),(0,p.tZ)(h,{children:s}),(0,p.tZ)(g,{children:(0,p.tZ)(l.g6,{direction:"right"})})]})}u.displayName="AlertLink";const d=u,m=(0,s.Z)((({openInNewTab:t,to:e,href:n,...s})=>{const i=o()(s,["withoutMarginBottom","priority","size"]);return n?(0,p.tZ)(a.Z,{...i,href:n,openInNewTab:t}):(0,p.tZ)(r.Z,{...i,to:e||""})}),{target:"ear9tuy3"})("display:flex;background-color:",(t=>t.theme.alert[t.priority].backgroundLight),";color:",(t=>t.theme.textColor),";border:1px dashed ",(t=>t.theme.alert[t.priority].border),";padding:",(t=>"small"===t.size?"".concat((0,c.Z)(1)," ").concat((0,c.Z)(1.5)):(0,c.Z)(2)),";margin-bottom:",(t=>t.withoutMarginBottom?0:(0,c.Z)(3)),";border-radius:0.25em;transition:0.2s border-color;&.focus-visible{outline:none;box-shadow:",(t=>t.theme.alert[t.priority].border),"7f 0 0 0 2px;}"),f=(0,s.Z)("span",{target:"ear9tuy2"})("display:flex;margin:",(0,c.Z)(.5)," ",(0,c.Z)(1.5)," ",(0,c.Z)(.5)," 0;"),g=(0,s.Z)(f,{target:"ear9tuy1"})("margin:",(0,c.Z)(.5)," 0;"),h=(0,s.Z)("div",{target:"ear9tuy0"})({name:"19lh9qo",styles:"line-height:1.5;flex-grow:1"})},"./app/views/settings/account/notifications/constants.tsx":(t,e,n)=>{n.d(e,{Ox:()=>o,Al:()=>a,A4:()=>r,Zb:()=>l,sg:()=>c,cH:()=>p,uJ:()=>u,Y5:()=>d});var s=n("./app/locale.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o={email:"default",slack:"never"},a={default:0,never:10,always:20,subscribe_only:30,committed_only:40},r=3,l=3,c=100,p=["alerts","workflow","deploy","approval","reports","email"],u=["personalActivityNotifications","selfAssignOnResolve"],d=(0,i.BX)("div",{children:[(0,i.tZ)("p",{style:{marginBottom:"20px"},children:(0,i.tZ)("strong",{children:"Are you sure you want to disable these notifications?"})}),(0,i.tZ)("p",{children:(0,s.t)('Turning this off will irreversibly overwrite all of your fine-tuning settings to "off".')})]})},"./app/views/settings/account/notifications/fields2.tsx":(t,e,n)=>{n.d(e,{u:()=>i});var s=n("./app/locale.tsx");const i={alerts:{name:"alerts",type:"select",label:(0,s.t)("Issue Alerts"),choices:[["always",(0,s.t)("On")],["never",(0,s.t)("Off")]],help:(0,s.t)("Notifications sent from Alert rules that your team has set up.")},workflow:{name:"workflow",type:"select",label:(0,s.t)("Issue Workflow"),choices:[["always",(0,s.t)("On")],["subscribe_only",(0,s.t)("Only Subscribed Issues")],["never",(0,s.t)("Off")]],help:(0,s.t)("Changes in issue assignment, resolution status, and comments.")},deploy:{name:"deploy",type:"select",label:(0,s.t)("Deploys"),choices:[["always",(0,s.t)("On")],["committed_only",(0,s.t)("Only Committed Issues")],["never",(0,s.t)("Off")]],help:(0,s.t)("Release, environment, and commit overviews.")},provider:{name:"provider",type:"select",label:(0,s.t)("Delivery Method"),choices:[["email",(0,s.t)("Send to Email")],["slack",(0,s.t)("Send to Slack")],["email+slack",(0,s.t)("Send to Email and Slack")]]},approval:{name:"approval",type:"select",label:(0,s.t)("Approvals"),choices:[["always",(0,s.t)("On")],["never",(0,s.t)("Off")]],help:(0,s.t)("Notifications from teammates that require review or approval.")},reports:{name:"weekly reports",type:"blank",label:(0,s.t)("Weekly Reports"),help:(0,s.t)("A summary of the past week for an organization.")},email:{name:"email routing",type:"blank",label:(0,s.t)("Email Routing"),help:(0,s.t)("Change the email address that receives notifications.")},personalActivityNotifications:{name:"personalActivityNotifications",type:"boolean",label:(0,s.t)("My Own Activity"),help:(0,s.t)("Notifications about your own actions on Sentry.")},selfAssignOnResolve:{name:"selfAssignOnResolve",type:"boolean",label:(0,s.t)("Claim Unassigned Issues I’ve Resolved"),help:(0,s.t)("You’ll receive notifications about any changes that happen afterwards.")}}},"./app/views/settings/account/notifications/notificationSettings.tsx":(t,e,n)=>{n.r(e),n.d(e,{default:()=>w});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.object.from-entries.js"),n("../node_modules/react/index.js")),o=n("./app/components/alertLink.tsx"),a=n("./app/components/asyncComponent.tsx"),r=n("./app/components/links/link.tsx"),l=n("./app/icons/index.tsx"),c=n("./app/locale.tsx"),p=n("./app/utils/withOrganizations.tsx"),u=n("./app/views/settings/account/notifications/constants.tsx"),d=n("./app/views/settings/account/notifications/feedbackAlert.tsx"),m=n("./app/views/settings/account/notifications/fields2.tsx"),f=n("./app/views/settings/account/notifications/utils.tsx"),g=n("./app/views/settings/components/forms/form.tsx"),h=n("./app/views/settings/components/forms/jsonForm.tsx"),v=n("./app/views/settings/components/settingsPageHeader.tsx"),b=n("./app/views/settings/components/text/textBlock.tsx"),y=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class j extends a.Z{constructor(...t){super(...t),(0,s.Z)(this,"getStateToPutForDefault",((t,e)=>{const{notificationSettings:n}=this.state,s=(0,f.zD)(e,n,t,(0,f.Vy)(e,n));return this.setState({notificationSettings:(0,f.r_)(n,s)}),s}))}getDefaultState(){return{...super.getDefaultState(),notificationSettings:{},legacyData:{}}}getEndpoints(){return[["notificationSettings","/users/me/notification-settings/"],["legacyData","/users/me/notifications/"]]}get notificationSettingsType(){const t=this.props.organizations.filter((t=>{var e;return null===(e=t.features)||void 0===e?void 0:e.includes("slack-requests")})).length>0;return u.cH.filter((e=>"approval"!==e||t))}getInitialData(){const{notificationSettings:t}=this.state;return Object.fromEntries(this.notificationSettingsType.map((e=>[e,(0,f._M)(e,t)])))}getFields(){const{notificationSettings:t}=this.state,e=[];for(const n of this.notificationSettingsType){const s=Object.assign({},m.u[n],{getData:t=>this.getStateToPutForDefault(t,n),help:(0,y.tZ)(i.Fragment,{children:(0,y.BX)("p",{children:[m.u[n].help," ",(0,y.tZ)(r.Z,{"data-test-id":"fine-tuning",to:"/settings/account/notifications/".concat(n),children:"Fine tune"})]})})});(0,f.Vi)(n,t)&&"function"!=typeof s&&(s.confirm={never:u.Y5}),e.push(s)}return e}renderBody(){const{legacyData:t}=this.state;return(0,y.BX)(i.Fragment,{children:[(0,y.tZ)(v.Z,{title:"Notifications"}),(0,y.tZ)(b.Z,{children:"Personal notifications sent via email or an integration."}),(0,y.tZ)(d.Z,{}),(0,y.tZ)(g.Z,{saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notification-settings/",initialData:this.getInitialData(),children:(0,y.tZ)(h.Z,{title:(0,c.t)("Notifications"),fields:this.getFields()})}),(0,y.tZ)(g.Z,{initialData:t,saveOnBlur:!0,apiMethod:"PUT",apiEndpoint:"/users/me/notifications/",children:(0,y.tZ)(h.Z,{title:(0,c.t)("My Activity"),fields:u.uJ.map((t=>m.u[t]))})}),(0,y.tZ)(o.Z,{to:"/settings/account/emails",icon:(0,y.tZ)(l.h,{}),children:(0,c.t)("Looking to add or remove an email address? Use the emails panel.")})]})}}const w=(0,p.Z)(j)},"./app/views/settings/account/notifications/utils.tsx":(t,e,n)=>{n.d(e,{_M:()=>A,hx:()=>S,xy:()=>_,tl:()=>N,gw:()=>C,Vy:()=>D,pV:()=>h,zD:()=>I,O0:()=>M,E2:()=>z,uI:()=>v,iy:()=>E,yB:()=>g,Vi:()=>T,r_:()=>Z,Oi:()=>y}),n("../node_modules/core-js/modules/es.object.from-entries.js"),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.array.unscopables.flat-map.js");var s=n("../node_modules/lodash/set.js"),i=n.n(s),o=n("./app/locale.tsx"),a=n("./app/views/settings/account/notifications/constants.tsx"),r=n("./app/views/settings/account/notifications/fields2.tsx"),l=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),c=n("./app/components/avatar/index.tsx"),p=n("./app/styles/space.tsx"),u=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const d=({notificationType:t,parent:e})=>(0,u.BX)(m,{children:[(0,u.tZ)(c.Z,{[h(t)]:e}),(0,u.tZ)("span",{children:e.slug})]});d.displayName="ParentLabel";const m=(0,l.Z)("div",{target:"e1lcoc5u0"})("display:flex;gap:",(0,p.Z)(.5),";line-height:16px;"),f=d,g=t=>["alerts","email","workflow"].includes(t),h=t=>g(t)?"project":"organization",v=t=>t.reduce(((t,e)=>{const n=e.organization.slug;return t.hasOwnProperty(n)?t[n].projects.push(e):t[n]={organization:e.organization,projects:[e]},t}),{}),b=t=>{switch(t){case"alerts":return"always";case"deploy":return"committed_only";case"workflow":return"subscribe_only";default:return""}},y=t=>t.sort().join("+"),j=(t,e)=>{if(!t)return"default";const n=t.find((t=>t[0]===e));if(!n)throw new Error("Could not find ".concat(e));return n[1]},w=t=>!!Object.keys(t).length&&Object.values(t).every((t=>"never"===t)),x=t=>Object.values(t).reduce(((t,e)=>"never"===e?t:e),null),O=(t,e,n,s)=>{let i;return i="user"===s?w(t)?n:x(t)||n:w(t)?"never":x(t)||"default",Object.fromEntries(Object.keys(a.Ox).map((t=>[t,e.includes(t)?i:"never"])))},Z=(...t)=>{const e={};return t.map((t=>Object.entries(t).map((([t,n])=>Object.entries(n).map((([n,s])=>Object.entries(s).map((([s,o])=>{i()(e,[t,n,s].join("."),o)})))))))),e},k=(t,e)=>{var n;return Object.values((null===(n=e[t])||void 0===n?void 0:n.user)||{}).pop()||Object.fromEntries(Object.entries(a.Ox).map((([e,n])=>[e,"default"===n?b(t):n])))},_=(t,e)=>{const n=k(t,e);return Object.entries(n).filter((([t,e])=>!["never"].includes(e))).map((([t,e])=>t))},S=(t,e)=>{const n=_(t,e);return n.length?k(t,e)[n[0]]:"never"},A=(t,e)=>{var n;const s=(t,e)=>a.Al[t]-a.Al[e],i=Object.values(k(t,e)).sort(s).pop()||"never";if("never"!==i)return i;const o=Object.values((null===(n=e[t])||void 0===n?void 0:n[h(t)])||{}).flatMap((t=>Object.values(t))).sort(s).pop()||"default";return"default"===o?"never":o},E=(t,e)=>["never","default"].includes(A(t,e)),D=(t,e)=>{var n;return Object.keys((null===(n=e[t])||void 0===n?void 0:n[h(t)])||{})},B=(t,e,n)=>{var s,i;return(null===(s=e[t])||void 0===s||null===(i=s[h(t)])||void 0===i?void 0:i[n])||{email:"default"}},N=(t,e,n)=>{const s=_(t,e)[0];return Object.fromEntries(n.map((n=>[n.id,B(t,e,n.id)[s]])))},T=(t,e)=>D(t,e).length>a.A4,z=(t,e,n)=>{const s=n.provider.split("+"),i=b(t);return Object.keys(e).length?{[t]:Object.fromEntries(Object.entries(e[t]).map((([t,e])=>[t,Object.fromEntries(Object.entries(e).map((([e,n])=>[e,O(n,s,i,t)])))])))}:{[t]:{user:{me:Object.fromEntries(s.map((t=>[t,i])))}}}},I=(t,e,n,s)=>{const i=Object.values(n)[0];let o=_(t,e);o.length||(o=["email"]);const a={[t]:{user:{me:Object.fromEntries(o.map((t=>[t,i])))}}};return"never"===i&&(a[t][h(t)]=Object.fromEntries(s.map((t=>[t,Object.fromEntries(o.map((t=>[t,"default"])))])))),a},M=(t,e,n,s)=>{const i=_(t,e),o=Object.values(n)[0];return{[t]:{[h(t)]:{[s]:Object.fromEntries(i.map((t=>[t,o])))}}}},C=(t,e,n,s)=>{var i;const a=r.u[t];return Object.assign({},a,{label:(0,u.tZ)(f,{parent:n,notificationType:t}),getData:t=>s(t,n.id),name:n.id,choices:null===(i=a.choices)||void 0===i?void 0:i.concat([["default","".concat((0,o.t)("Default")," (").concat(j(a.choices,S(t,e)),")")]]),defaultValue:"default",help:void 0})}}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_account_notifications_notificationSettings_tsx.f41c14c18bdbc9a149eac7c12a438164.js.map