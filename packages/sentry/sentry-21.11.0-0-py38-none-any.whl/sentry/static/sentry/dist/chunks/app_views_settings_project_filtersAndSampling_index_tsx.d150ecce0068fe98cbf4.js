(self.webpackChunk=self.webpackChunk||[]).push([["app_views_settings_project_filtersAndSampling_index_tsx"],{"./app/views/asyncView.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>a}),n("../node_modules/react/index.js");var s=n("../node_modules/react-document-title/index.js"),r=n.n(s),i=n("./app/components/asyncComponent.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class a extends i.Z{getTitle(){return""}render(){const e=this.getTitle();return(0,o.tZ)(r(),{title:"".concat(e?"".concat(e," - "):"","Sentry"),children:this.renderComponent()})}}a.displayName="AsyncView"},"./app/views/settings/organization/permissionAlert.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>d}),n("../node_modules/react/index.js");var s=n("./app/components/acl/access.tsx"),r=n("./app/components/alert.tsx"),i=n("./app/icons/index.tsx"),o=n("./app/locale.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=({access:e=["org:write"],...t})=>(0,a.tZ)(s.Z,{access:e,children:({hasAccess:e})=>!e&&(0,a.tZ)(r.Z,{type:"warning",icon:(0,a.tZ)(i.FC,{size:"sm"}),...t,children:(0,o.t)("These settings can only be edited by users with the organization owner or manager role.")})});l.displayName="PermissionAlert";const d=l},"./app/views/settings/project/filtersAndSampling/index.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>en});var s=n("./app/components/acl/access.tsx"),r=n("./app/components/acl/feature.tsx"),i=n("./app/components/acl/featureDisabled.tsx"),o=n("./app/components/panels/index.tsx"),a=n("./app/locale.tsx"),l=n("./app/utils/withOrganization.tsx"),d=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),u=n("../node_modules/lodash/partition.js"),p=n.n(u),m=n("./app/actionCreators/indicator.tsx"),h=n("./app/actionCreators/modal.tsx"),E=n("./app/components/alert.tsx"),g=n("./app/components/links/externalLink.tsx");let R,_,S,y,T;!function(e){e.TRACE="trace",e.TRANSACTION="transaction",e.ERROR="error"}(R||(R={})),function(e){e.NOT="not",e.OR="or",e.AND="and"}(_||(_={})),function(e){e.GLOB_MATCH="glob",e.EQUAL="eq",e.CUSTOM="custom"}(S||(S={})),function(e){e.TRACE_RELEASE="trace.release",e.TRACE_ENVIRONMENT="trace.environment",e.TRACE_USER_ID="trace.user.id",e.TRACE_USER_SEGMENT="trace.user.segment",e.TRACE_TRANSACTION="trace.transaction",e.EVENT_RELEASE="event.release",e.EVENT_ENVIRONMENT="event.environment",e.EVENT_USER_ID="event.user.id",e.EVENT_USER_SEGMENT="event.user.segment",e.EVENT_LOCALHOST="event.is_local_ip",e.EVENT_WEB_CRAWLERS="event.web_crawlers",e.EVENT_BROWSER_EXTENSIONS="event.has_bad_browser_extensions",e.EVENT_TRANSACTION="event.transaction",e.EVENT_IP_ADDRESSES="event.client_ip",e.EVENT_LEGACY_BROWSER="event.legacy_browser",e.EVENT_ERROR_MESSAGES="event.error_messages",e.EVENT_CSP="event.csp"}(y||(y={})),function(e){e.IE_PRE_9="ie_pre_9",e.IE9="ie9",e.IE10="ie10",e.IE11="ie11",e.SAFARI_PRE_6="safari_pre_6",e.OPERA_PRE_15="opera_pre_15",e.OPERA_MINI_PRE_8="opera_mini_pre_8",e.ANDROID_PRE_4="android_pre_4"}(T||(T={}));var A=n("./app/utils/withProject.tsx"),N=n("./app/views/asyncView.tsx"),f=n("./app/views/settings/components/settingsPageHeader.tsx"),Z=n("./app/views/settings/components/text/textBlock.tsx"),b=n("./app/views/settings/organization/permissionAlert.tsx"),x=(n("../node_modules/core-js/modules/es.string.trim.js"),n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js")),v=n("../node_modules/@sentry/minimal/esm/index.js"),w=n("./app/utils/theme.tsx");const C="https://docs.sentry.io/product/data-management-settings/filtering/",I={[T.IE_PRE_9]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 8 and lower")},[T.IE9]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 9")},[T.IE10]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 10")},[T.IE11]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 11")},[T.SAFARI_PRE_6]:{icon:"safari",title:(0,a.t)("Safari version 5 and lower")},[T.OPERA_PRE_15]:{icon:"opera",title:(0,a.t)("Opera version 14 and lower")},[T.OPERA_MINI_PRE_8]:{icon:"opera",title:(0,a.t)("Opera Mini version 8 and lower")},[T.ANDROID_PRE_4]:{icon:"android",title:(0,a.t)("Android version 3 and lower")}};function O(e){switch(e){case y.TRACE_ENVIRONMENT:case y.EVENT_ENVIRONMENT:return(0,a.t)("Environment");case y.TRACE_RELEASE:case y.EVENT_RELEASE:return(0,a.t)("Release");case y.EVENT_USER_ID:case y.TRACE_USER_ID:return(0,a.t)("User Id");case y.EVENT_USER_SEGMENT:case y.TRACE_USER_SEGMENT:return(0,a.t)("User Segment");case y.EVENT_BROWSER_EXTENSIONS:return(0,a.t)("Browser Extensions");case y.EVENT_LOCALHOST:return(0,a.t)("Localhost");case y.EVENT_WEB_CRAWLERS:return(0,a.t)("Web Crawlers");case y.EVENT_LEGACY_BROWSER:return(0,a.t)("Legacy Browser");case y.EVENT_TRANSACTION:case y.TRACE_TRANSACTION:return(0,a.t)("Transaction");case y.EVENT_ERROR_MESSAGES:return(0,a.t)("Error Message");case y.EVENT_CSP:return(0,a.t)("Content Security Policy");case y.EVENT_IP_ADDRESSES:return(0,a.t)("IP Address");default:return v.Tb(new Error("Unknown dynamic sampling condition inner name")),null}}const V=(0,x.iv)("[role='document']{overflow:initial;}@media (min-width: ",w.ZP.breakpoints[0],"){width:100%;max-width:700px;}","");let j;function k(e){switch(e){case y.EVENT_LEGACY_BROWSER:return(0,a.t)("Match all selected legacy browsers below");case y.EVENT_BROWSER_EXTENSIONS:return(0,a.t)("Match all browser extensions");case y.EVENT_LOCALHOST:return(0,a.t)("Match all localhosts");case y.EVENT_WEB_CRAWLERS:return(0,a.t)("Match all web crawlers");case y.EVENT_USER_ID:case y.TRACE_USER_ID:return(0,a.t)("ex. 4711 (Multiline)");case y.EVENT_USER_SEGMENT:case y.TRACE_USER_SEGMENT:return(0,a.t)("ex. paid, common (Multiline)");case y.TRACE_ENVIRONMENT:case y.EVENT_ENVIRONMENT:return(0,a.t)("ex. prod, dev");case y.TRACE_RELEASE:case y.EVENT_RELEASE:return(0,a.t)("ex. 1*, [I3].[0-9].*");case y.EVENT_IP_ADDRESSES:return(0,a.t)("ex. 127.0.0.1 or 10.0.0.0/8 (Multiline)");case y.EVENT_CSP:return(0,a.t)("ex. file://*, example.com (Multiline)");case y.EVENT_ERROR_MESSAGES:return(0,a.t)("ex. TypeError* (Multiline)");case y.TRACE_TRANSACTION:case y.EVENT_TRANSACTION:return(0,a.t)('ex. "page-load"');default:return v.Tb(new Error("Unknown dynamic sampling condition inner name")),""}}function M(e){var t,n;if(e.category===y.EVENT_BROWSER_EXTENSIONS||e.category===y.EVENT_WEB_CRAWLERS||e.category===y.EVENT_LOCALHOST)return{op:S.EQUAL,name:e.category,value:!0};if(e.category===y.EVENT_LEGACY_BROWSER)return{op:S.CUSTOM,name:e.category,value:null!==(n=e.legacyBrowsers)&&void 0!==n?n:[]};const s=(null!==(t=e.match)&&void 0!==t?t:"").split("\n").filter((e=>!!e.trim())).map((e=>e.trim()));return e.category===y.EVENT_IP_ADDRESSES||e.category===y.EVENT_ERROR_MESSAGES||e.category===y.EVENT_CSP?{op:S.CUSTOM,name:e.category,value:s}:e.category===y.EVENT_RELEASE||e.category===y.TRACE_RELEASE||e.category===y.EVENT_TRANSACTION||e.category===y.TRACE_TRANSACTION?{op:S.GLOB_MATCH,name:e.category,value:s}:e.category===y.TRACE_USER_ID||e.category===y.EVENT_USER_ID?{op:S.EQUAL,name:e.category,value:s,options:{ignoreCase:!1}}:{op:S.EQUAL,name:e.category,value:s,options:{ignoreCase:!0}}}!function(e){e.ALL="all",e.MATCH_CONDITIONS="match-conditions"}(j||(j={}));var D=n("../node_modules/lodash/isEqual.js"),L=n.n(D),B=n("./app/utils.tsx"),P=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),U=n("./app/components/button.tsx"),z=n("./app/components/buttonBar.tsx"),W=n("./app/components/dropdownAutoComplete/index.tsx"),X=n("./app/components/dropdownButton.tsx"),F=n("./app/components/menuItem.tsx"),G=n("./app/components/tooltip.tsx"),q=n("./app/icons/iconCheckmark.tsx"),H=n("./app/styles/space.tsx"),Y=n("./app/views/settings/components/emptyMessage.tsx"),Q=n("./app/views/settings/components/forms/numberField.tsx"),K=n("./app/icons/iconDelete.tsx"),J=n("./app/views/settings/components/forms/field/fieldRequiredBadge.tsx"),$=n("./app/views/settings/components/forms/textareaField.tsx"),ee=n("../node_modules/react-select/dist/chunk-80640036.browser.esm.js"),te=n("./app/actionCreators/tags.tsx"),ne=n("./app/utils/useApi.tsx"),se=n("./app/views/settings/components/forms/selectField.tsx"),re=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function ie({orgSlug:e,projectId:t,category:n,onChange:s,value:r}){const i=(0,ne.Z)(),[o,l]=(0,c.useState)([]);(0,c.useEffect)((()=>{!async function(){if(d)try{const n=await(0,te.Fo)(i,e,d,null,[t]);l(n)}catch{}}()}),[]);const d=function(){switch(n){case y.TRACE_RELEASE:case y.EVENT_RELEASE:return"release";case y.TRACE_ENVIRONMENT:case y.EVENT_ENVIRONMENT:return"environment";case y.TRACE_TRANSACTION:case y.EVENT_TRANSACTION:return"transaction";default:return v.Tb(new Error("Unknown dynamic sampling condition inner name")),""}}(),u=r?r.split(",").filter((e=>!o.some((t=>t.value===e)))).map((e=>({value:e}))):[];return(0,re.tZ)(ae,{name:"match","aria-label":function(){switch(n){case y.TRACE_RELEASE:case y.EVENT_RELEASE:return(0,a.t)("Search or add a release");case y.TRACE_ENVIRONMENT:case y.EVENT_ENVIRONMENT:return(0,a.t)("Search or add an environment");case y.TRACE_TRANSACTION:case y.EVENT_TRANSACTION:return(0,a.t)("Search or add a transaction");default:return v.Tb(new Error("Unknown dynamic sampling condition inner name")),""}}(),options:[...u,...o].map((e=>({value:e.value,label:e.value}))),value:null==r?void 0:r.split(","),onChange:e=>{s(null==e?void 0:e.join(","))},styles:{menu:e=>({...e,wordBreak:"break-all"})},components:{SelectContainer:e=>(0,re.tZ)(ee.y.SelectContainer,{...e,innerProps:{...e.innerProps,"data-test-id":"autocomplete-".concat(d)}}),MultiValue:e=>(0,re.tZ)(ee.y.MultiValue,{...e,innerProps:{...e.innerProps,"data-test-id":"multivalue"}}),Option:e=>(0,re.tZ)(ee.y.Option,{...e,innerProps:{...e.innerProps,"data-test-id":"option"}})},formatCreateLabel:e=>(0,a._N)('Add "[newLabel]"',{newLabel:e}),placeholder:k(n),inline:!1,multiple:!0,hideControlState:!0,flexibleControlStateSize:!0,required:!0,stacked:!0,creatable:!0,allowClear:!0})}ie.displayName="AutoComplete";const oe=ie,ae=(0,P.Z)(se.Z,{target:"e1it57gq0"})({name:"1d3w5wq",styles:"width:100%"});var le=n("../node_modules/lodash/intersection.js"),de=n.n(le),ce=n("../node_modules/lodash/uniq.js"),ue=n.n(ce),pe=n("../node_modules/lodash/xor.js"),me=n.n(pe);function he({selectedRowsCount:e,columnsCount:t,isPageSelected:n,isAllSelected:s,onSelectAllRows:r,onUnselectAllRows:i,bulkLimit:o,allRowsCount:l,className:d}){if(l&&l<=e||!n)return null;const{noticeText:u,actionText:p}=function(e,t){return(0,B.ri)(e)?t&&e>t?{noticeText:(0,a._N)("Selected up to the first [count] items.",{count:t}),actionText:(0,a._N)("Select the first [count] items.",{count:t})}:{noticeText:(0,a._N)("Selected all [count] items.",{count:e}),actionText:(0,a._N)("Select all [count] items.",{count:e})}:{noticeText:(0,a.t)("Selected all items across all pages."),actionText:(0,a.t)("Select all items across all pages.")}}(l,o);return(0,re.tZ)(Ee,{columnsCount:t,className:d,children:s?(0,re.BX)(c.Fragment,{children:[u," ",(0,re.tZ)(ge,{priority:"link",onClick:i,children:(0,a.t)("Cancel selection.")})]}):(0,re.BX)(c.Fragment,{children:[(0,a.tn)("%s item on this page selected.","%s items on this page selected.",e)," ",(0,re.tZ)(ge,{priority:"link",onClick:r,children:p})]})})}he.displayName="BulkNotice";const Ee=(0,P.Z)((({columnsCount:e,...t})=>(0,re.tZ)(o.aU,{...t})),{target:"e1cwk49q1"})("grid-column:span ",(e=>e.columnsCount),";text-align:center;"),ge=(0,P.Z)(U.ZP,{target:"e1cwk49q0"})("&,&:hover,&:active,&:focus{color:",(e=>e.theme.textColor),";border:none;border-radius:0;border-bottom:1px dotted ",(e=>e.theme.textColor),";padding-bottom:1px;font-size:15px;}"),Re=he;class _e extends c.Component{constructor(...e){super(...e),(0,d.Z)(this,"state",this.getInitialState()),(0,d.Z)(this,"handleRowToggle",(e=>{this.setState((t=>({selectedIds:me()(t.selectedIds,[e]),isAllSelected:!1})))})),(0,d.Z)(this,"handleAllRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState({selectedIds:e?[...t]:[],isAllSelected:e})})),(0,d.Z)(this,"handlePageRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState((n=>({selectedIds:e?ue()([...n.selectedIds,...t]):n.selectedIds.filter((e=>!t.includes(e))),isAllSelected:!1})))}))}getInitialState(){const{defaultSelectedIds:e,pageIds:t}=this.props;return{selectedIds:de()(null!=e?e:[],t),isAllSelected:!1}}static getDerivedStateFromProps(e,t){return{...t,selectedIds:de()(t.selectedIds,e.pageIds)}}componentDidUpdate(e,t){var n,s;L()(t,this.state)||null===(n=(s=this.props).onChange)||void 0===n||n.call(s,this.state)}render(){const{pageIds:e,children:t,columnsCount:n,allRowsCount:s,bulkLimit:r}=this.props,{selectedIds:i,isAllSelected:o}=this.state,a=e.length>0&&e.every((e=>i.includes(e)));return t({selectedIds:i,isAllSelected:o,isPageSelected:a,onRowToggle:this.handleRowToggle,onAllRowsToggle:this.handleAllRowsToggle,onPageRowsToggle:this.handlePageRowsToggle,renderBulkNotice:()=>(0,re.tZ)(Re,{allRowsCount:s,selectedRowsCount:i.length,onUnselectAllRows:()=>this.handleAllRowsToggle(!1),onSelectAllRows:()=>this.handleAllRowsToggle(!0),columnsCount:n,isPageSelected:a,isAllSelected:o,bulkLimit:r})})}}_e.displayName="BulkController";const Se=_e;var ye=n("./app/components/switchButton.tsx");const Te=Object.values(T);function Ae({onChange:e,selectedLegacyBrowsers:t=[]}){return(0,re.tZ)(Se,{pageIds:Te,defaultSelectedIds:t,allRowsCount:Te.length,onChange:function({selectedIds:t}){e(t)},columnsCount:0,children:({selectedIds:e,onRowToggle:t,onPageRowsToggle:n,isPageSelected:s})=>(0,re.BX)(fe,{children:[(0,a.t)("All browsers"),(0,re.tZ)(ye.Z,{size:"lg",isActive:s,toggle:()=>{n(!s)}},"switch"),Te.map((n=>{const{icon:s,title:r}=I[n];return(0,re.BX)(c.Fragment,{children:[(0,re.BX)(Ze,{children:[(0,re.tZ)(be,{className:"icon-".concat(s),"data-test-id":"icon-".concat(s)}),r]}),(0,re.tZ)(ye.Z,{size:"lg",isActive:e.includes(n),toggle:()=>t(n)})]},n)}))]})})}Ae.displayName="LegacyBrowsers";const Ne=Ae,fe=(0,P.Z)("div",{target:"evvj4pe2"})("grid-column:1/-1;display:grid;grid-template-columns:1fr max-content;grid-gap:",(0,H.Z)(2),";font-size:",(e=>e.theme.fontSizeLarge),";color:",(e=>e.theme.gray400),";padding-top:",(0,H.Z)(2),";padding-bottom:",(0,H.Z)(1),";"),Ze=(0,P.Z)("div",{target:"evvj4pe1"})("display:grid;grid-template-columns:max-content 1fr;grid-column-gap:",(0,H.Z)(1),";color:",(e=>e.theme.gray500),";"),be=(0,P.Z)("div",{target:"evvj4pe0"})({name:"1bjfr92",styles:"width:24px;height:24px;background-repeat:no-repeat;background-position:center;background-size:24px 24px;flex-shrink:0"});function xe({conditions:e,orgSlug:t,projectId:n,onDelete:s,onChange:r}){return(0,re.tZ)(c.Fragment,{children:e.map((({category:e,match:i,legacyBrowsers:o},l)=>{const d=e===y.EVENT_LEGACY_BROWSER,c=e===y.EVENT_BROWSER_EXTENSIONS||e===y.EVENT_LOCALHOST||e===y.EVENT_WEB_CRAWLERS||d,u=e===y.EVENT_ENVIRONMENT||e===y.EVENT_RELEASE||e===y.EVENT_TRANSACTION||e===y.TRACE_ENVIRONMENT||e===y.TRACE_RELEASE||e===y.TRACE_TRANSACTION;return(0,re.BX)(we,{children:[(0,re.tZ)(Ie,{children:(0,re.BX)("span",{children:[O(e),(0,re.tZ)(J.Z,{})]})}),(0,re.tZ)(Oe,{children:!c&&(u?(0,re.tZ)(oe,{category:e,orgSlug:t,projectId:n,value:i,onChange:e=>r(l,"match",e)}):(0,re.tZ)(je,{name:"match",value:i,onChange:e=>r(l,"match",e),placeholder:k(e),inline:!1,rows:1,autosize:!0,hideControlState:!0,flexibleControlStateSize:!0,required:!0,stacked:!0}))}),(0,re.tZ)(Ve,{children:(0,re.tZ)(U.ZP,{onClick:()=>s(l),icon:(0,re.tZ)(K.F,{}),label:(0,a.t)("Delete Condition")})}),d&&(0,re.tZ)(Ne,{selectedLegacyBrowsers:o,onChange:e=>{r(l,"legacyBrowsers",e)}})]},l)}))})}xe.displayName="Conditions";const ve=xe,we=(0,P.Z)("div",{target:"ep8w7uu5"})("display:grid;grid-template-columns:1fr minmax(0, 1fr);align-items:flex-start;padding:",(0,H.Z)(1)," ",(0,H.Z)(2),";:not(:last-child){border-bottom:1px solid ",(e=>e.theme.gray100),";}@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:0.6fr minmax(0, 1fr) max-content;}"),Ce=(0,P.Z)("div",{target:"ep8w7uu4"})({name:"38ghps",styles:"min-height:40px;display:inline-flex;align-items:center"}),Ie=(0,P.Z)(Ce,{target:"ep8w7uu3"})("padding-right:",(0,H.Z)(2),";line-height:16px;"),Oe=(0,P.Z)(Ce,{target:"ep8w7uu2"})("padding-top:",(0,H.Z)(1),";grid-column:1/-1;grid-row:2/2;",(e=>!e.children&&"display: none"),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-column:auto;grid-row:auto;padding-top:0;}"),Ve=(0,P.Z)(Ce,{target:"ep8w7uu1"})("justify-content:flex-end;padding-left:",(0,H.Z)(1),";"),je=(0,P.Z)($.Z,{target:"ep8w7uu0"})({name:"1fz47qv",styles:"padding-bottom:0;width:100%"});function ke({Header:e,Body:t,Footer:n,closeModal:s,title:r,emptyMessage:i,conditionCategories:l,api:d,organization:u,project:p,onSubmitSuccess:h,onSubmit:E,onChange:g,extraFields:R,rule:_}){const[S,T]=(0,c.useState)(function(){if(_){const{condition:e,sampleRate:t}=_,{inner:n}=e;return{conditions:n.map((({name:e,value:t})=>Array.isArray(t)?t.every((e=>!!I[e]))?{category:e,legacyBrowsers:t}:{category:e,match:t.join("\n")}:{category:e})),sampleRate:100*t,errors:{}}}return{conditions:[],sampleRate:null,errors:{}}}());(0,c.useEffect)((()=>{S.errors.sampleRate&&T({...S,errors:{...S.errors,sampleRate:void 0}})}),[S.sampleRate]),(0,c.useEffect)((()=>{null==g||g(S)}),[S]);const{errors:A,conditions:N,sampleRate:f}=S;async function Z(e,t){try{const t=await d.requestPromise("/projects/".concat(u.slug,"/").concat(p.slug,"/"),{method:"PUT",data:{dynamicSampling:{rules:e}}});h(t,_?(0,a.t)("Successfully edited dynamic sampling rule"):(0,a.t)("Successfully added dynamic sampling rule")),s()}catch(e){!function(e){switch(e.type){case"sampleRate":T({...S,errors:{...A,sampleRate:e.message}});break;default:(0,m.Iw)(e.message)}}(function(e,t){var n,s,r;const i=null!==(n=null===(s=e.responseJSON)||void 0===s||null===(r=s.dynamicSampling)||void 0===r?void 0:r.rules[t])&&void 0!==n?n:{},[o,l]=Object.entries(i)[0];return"sampleRate"===o&&"Ensure this value is less than or equal to 1."===(Array.isArray(l)?l[0]:l)?{type:"sampleRate",message:(0,a.t)("Ensure this value is a floating number between 0 and 100")}:{type:"unknown",message:(0,a.t)("An internal error occurred while saving dynamic sampling rule")}}(e,t))}}const b=!(0,B.ri)(f)||!(null==N||!N.find((e=>{var t;return e.category===y.EVENT_LEGACY_BROWSER?!(null!==(t=e.legacyBrowsers)&&void 0!==t?t:[]).length:e.category!==y.EVENT_LOCALHOST&&e.category!==y.EVENT_BROWSER_EXTENSIONS&&e.category!==y.EVENT_WEB_CRAWLERS&&!e.match})));return(0,re.BX)(c.Fragment,{children:[(0,re.tZ)(e,{closeButton:!0,children:(0,re.tZ)("h4",{children:r})}),(0,re.tZ)(t,{children:(0,re.BX)(De,{children:[R,(0,re.BX)(Pe,{children:[(0,re.BX)(Be,{hasButtons:!0,children:[(0,a.t)("Conditions"),(0,re.tZ)(W.Z,{onSelect:e=>{var t;t=e.value,T({...S,conditions:[...N,{category:t,match:""}]})},alignMenu:"right",items:l.map((e=>{const t=N.some((t=>t.category===e[0]));return{value:e[0],"data-test-id":"condition",disabled:t,label:(0,re.tZ)(G.Z,{title:(0,a.t)("This condition has already been added"),disabled:!t,children:(0,re.tZ)(Le,{disabled:t,children:e[1]})})}})),children:({isOpen:e})=>(0,re.tZ)(X.Z,{isOpen:e,size:"small",children:(0,a.t)("Add Condition")})})]}),(0,re.tZ)(o.N,{children:N.length?(0,re.tZ)(ve,{conditions:N,onDelete:function(e){const t=[...N];t.splice(e,1),T({...S,conditions:t})},onChange:function(e,t,n){const s=[...N];s[e][t]=n,T({...S,conditions:s})},orgSlug:u.slug,projectId:p.id}):(0,re.tZ)(Y.Z,{icon:(0,re.tZ)(q.D,{isCircled:!0,size:"xl"}),children:i})})]}),(0,re.tZ)(Q.Z,{label:"".concat((0,a.t)("Sampling Rate")," %"),name:"sampleRate",onChange:e=>{T({...S,sampleRate:e?Number(e):null})},placeholder:"%",value:f,inline:!1,hideControlState:!A.sampleRate,error:A.sampleRate,showHelpInTooltip:!0,stacked:!0,required:!0})]})}),(0,re.tZ)(n,{children:(0,re.BX)(z.ZP,{gap:1,children:[(0,re.tZ)(U.ZP,{onClick:s,children:(0,a.t)("Cancel")}),(0,re.tZ)(U.ZP,{priority:"primary",onClick:()=>E({conditions:N,sampleRate:f,submitRules:Z}),title:b?(0,a.t)("Required fields must be filled out"):void 0,disabled:b,children:(0,a.t)("Save Rule")})]})})]})}ke.displayName="RuleModal";const Me=ke,De=(0,P.Z)("div",{target:"e1mf53z03"})("display:grid;grid-gap:",(0,H.Z)(2),";"),Le=(0,P.Z)(F.Z,{target:"e1mf53z02"})("color:",(e=>e.theme.textColor),";font-size:",(e=>e.theme.fontSizeMedium),";font-weight:400;text-transform:none;span{padding:0;}"),Be=(0,P.Z)(o.V9,{target:"e1mf53z01"})("padding-right:",(0,H.Z)(2),";"),Pe=(0,P.Z)(o.s_,{target:"e1mf53z00"})({name:"1ykowef",styles:"margin-bottom:0"});function Ue({rule:e,errorRules:t,transactionRules:n,...s}){return(0,re.tZ)(Me,{...s,title:e?(0,a.t)("Edit Error Sampling Rule"):(0,a.t)("Add Error Sampling Rule"),emptyMessage:(0,a.t)("Apply sampling rate to all errors"),conditionCategories:[[y.EVENT_RELEASE,(0,a.t)("Release")],[y.EVENT_ENVIRONMENT,(0,a.t)("Environment")],[y.EVENT_USER_ID,(0,a.t)("User Id")],[y.EVENT_USER_SEGMENT,(0,a.t)("User Segment")],[y.EVENT_BROWSER_EXTENSIONS,(0,a.t)("Browser Extensions")],[y.EVENT_LOCALHOST,(0,a.t)("Localhost")],[y.EVENT_LEGACY_BROWSER,(0,a.t)("Legacy Browser")],[y.EVENT_WEB_CRAWLERS,(0,a.t)("Web Crawlers")],[y.EVENT_IP_ADDRESSES,(0,a.t)("IP Address")],[y.EVENT_CSP,(0,a.t)("Content Security Policy")],[y.EVENT_ERROR_MESSAGES,(0,a.t)("Error Message")],[y.EVENT_TRANSACTION,(0,a.t)("Transaction")]],rule:e,onSubmit:function({sampleRate:s,conditions:r,submitRules:i}){if(!(0,B.ri)(s))return;const o={id:0,type:R.ERROR,condition:{op:_.AND,inner:r.length?r.map(M):[]},sampleRate:s/100},a=e?[...t.map((t=>L()(t,e)?o:t)),...n]:[...t,o,...n],l=a.findIndex((e=>e===o));i(a,l)}})}Ue.displayName="ErrorRuleModal";const ze=Ue;var We=n("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),Xe=n("./app/components/checkboxFancy/checkboxFancy.tsx"),Fe=n("./app/views/settings/components/forms/field/index.tsx");function Ge({rule:e,errorRules:t,transactionRules:n,...s}){const r=(0,We.u)(),[i,o]=(0,c.useState)(!e||e.type===R.TRACE),[l,d]=(0,c.useState)(!(null==e||!e.condition.inner.length));return(0,re.tZ)(Me,{...s,title:e?(0,a.t)("Edit Transaction Sampling Rule"):(0,a.t)("Add Transaction Sampling Rule"),emptyMessage:(0,a.t)("Apply sampling rate to all transactions"),conditionCategories:i?[[y.TRACE_RELEASE,(0,a.t)("Release")],[y.TRACE_ENVIRONMENT,(0,a.t)("Environment")],[y.TRACE_USER_ID,(0,a.t)("User Id")],[y.TRACE_USER_SEGMENT,(0,a.t)("User Segment")],[y.TRACE_TRANSACTION,(0,a.t)("Transaction")]]:[[y.EVENT_RELEASE,(0,a.t)("Release")],[y.EVENT_ENVIRONMENT,(0,a.t)("Environment")],[y.EVENT_USER_ID,(0,a.t)("User Id")],[y.EVENT_USER_SEGMENT,(0,a.t)("User Segment")],[y.EVENT_BROWSER_EXTENSIONS,(0,a.t)("Browser Extensions")],[y.EVENT_LOCALHOST,(0,a.t)("Localhost")],[y.EVENT_LEGACY_BROWSER,(0,a.t)("Legacy Browser")],[y.EVENT_WEB_CRAWLERS,(0,a.t)("Web Crawlers")],[y.EVENT_IP_ADDRESSES,(0,a.t)("IP Address")],[y.EVENT_CSP,(0,a.t)("Content Security Policy")],[y.EVENT_ERROR_MESSAGES,(0,a.t)("Error Message")],[y.EVENT_TRANSACTION,(0,a.t)("Transaction")]],rule:e,onSubmit:function({sampleRate:s,conditions:r,submitRules:o}){if(!(0,B.ri)(s))return;const a={id:0,type:i?R.TRACE:R.TRANSACTION,condition:{op:_.AND,inner:r.length?r.map(M):[]},sampleRate:s/100},l=e?n.map((t=>L()(t,e)?a:t)):[...n,a],[d,c]=p()(l,(e=>e.type===R.TRACE)),u=[...t,...d,...c],m=u.findIndex((e=>e===a));o(u,m)},onChange:function({conditions:e}){d(!!e.length)},extraFields:(0,re.tZ)(Fe.Z,{label:(0,a.t)("Tracing"),inline:!1,flexibleControlStateSize:!0,stacked:!0,showHelpInTooltip:!0,children:(0,re.tZ)(G.Z,{title:(0,a.t)("This field can only be edited if there are no match conditions"),disabled:!l,popperStyle:(0,x.iv)("@media (min-width: ",r.breakpoints[0],"){max-width:370px;}",""),children:(0,re.BX)(He,{onClick:l?void 0:()=>o(!i),children:[(0,re.tZ)(Ye,{isChecked:i,isDisabled:l}),(0,a._N)("Include all related transactions by trace ID. This can span across multiple projects. All related errors will remain. [link:Learn more about tracing].",{link:(0,re.tZ)(g.Z,{href:C,onClick:e=>e.stopPropagation()})})]})})})})}Ge.displayName="TransactionRuleModal";const qe=Ge,He=(0,P.Z)("div",{target:"ejbmws91"})("display:grid;grid-template-columns:max-content 1fr;grid-gap:",(0,H.Z)(1),";cursor:",(e=>e.onClick?"pointer":"not-allowed"),";"),Ye=(0,P.Z)(Xe.Z,{target:"ejbmws90"})("margin-top:",(0,H.Z)(.5),";");function Qe({type:e,...t}){return"error"===e?(0,re.tZ)(ze,{...t}):(0,re.tZ)(qe,{...t})}Qe.displayName="Modal";const Ke=Qe;var Je=n("./app/styles/overflowEllipsis.tsx"),$e=n("../node_modules/react-dom/index.js"),et=n("../node_modules/@dnd-kit/core/dist/core.esm.js"),tt=n("../node_modules/@dnd-kit/sortable/dist/sortable.esm.js");function nt({value:e,dragging:t,index:n,transform:s,listeners:r,sorting:i,transition:o,forwardRef:a,attributes:l,renderItem:d,wrapperStyle:c,innerWrapperStyle:u}){return(0,re.tZ)(ot,{ref:a,style:{...c,transition:o,"--translate-x":s?"".concat(Math.round(s.x),"px"):void 0,"--translate-y":s?"".concat(Math.round(s.y),"px"):void 0,"--scale-x":null!=s&&s.scaleX?"".concat(s.scaleX):void 0,"--scale-y":null!=s&&s.scaleY?"".concat(s.scaleY):void 0},children:(0,re.tZ)(at,{style:u,children:d({dragging:Boolean(t),sorting:Boolean(i),listeners:r,transform:s,transition:o,value:e,index:n,attributes:l})})})}nt.displayName="Item";const st=nt,rt="0 0 0 calc(1px / var(--scale-x, 1)) rgba(63, 63, 68, 0.05)",it="".concat(rt,", ").concat("0 1px calc(3px / var(--scale-x, 1)) 0 rgba(34, 33, 81, 0.15)"),ot=(0,P.Z)("div",{target:"e1puudz31"})("transform:translate3d(var(--translate-x, 0), var(--translate-y, 0), 0) scaleX(var(--scale-x, 1)) scaleY(var(--scale-y, 1));transform-origin:0 0;touch-action:manipulation;--box-shadow:",it,";--box-shadow-picked-up:",rt,",-1px 0 15px 0 rgba(34, 33, 81, 0.01),0px 15px 15px 0 rgba(34, 33, 81, 0.25);"),at=(0,P.Z)("div",{target:"e1puudz30"})("background-color:",(e=>e.theme.background),";animation:pop 200ms cubic-bezier(0.18, 0.67, 0.6, 1.22);box-shadow:var(--box-shadow-picked-up);opacity:1;:focus{box-shadow:0 0px 4px 1px rgba(76, 159, 254, 1),",it,";}@keyframes pop{0%{transform:scale(1);box-shadow:var(--box-shadow);}100%{box-shadow:var(--box-shadow-picked-up);}}");function lt({id:e,index:t,renderItem:n,disabled:s,wrapperStyle:r,innerWrapperStyle:i}){const{attributes:o,isSorting:a,isDragging:l,listeners:d,setNodeRef:c,overIndex:u,transform:p,transition:m}=(0,tt.nB)({id:e,disabled:s});return(0,re.tZ)(st,{forwardRef:c,value:e,sorting:a,renderItem:n,index:t,transform:p,transition:m,listeners:d,attributes:o,wrapperStyle:r({id:e,index:t,isDragging:l,isSorting:a}),innerWrapperStyle:i({id:e,index:t,isDragging:l,isSorting:a,overIndex:u,isDragOverlay:!1})})}lt.displayName="SortableItem";const dt=lt;class ct extends c.Component{constructor(...e){super(...e),(0,d.Z)(this,"state",{}),(0,d.Z)(this,"handleChangeActive",(e=>{this.setState({activeId:e})}))}render(){const{activeId:e}=this.state,{items:t,onUpdateItems:n,renderItem:s,disabled:r,wrapperStyle:i,innerWrapperStyle:o}=this.props,a=t.indexOf.bind(t),l=e?a(e):-1;return(0,re.BX)(et.LB,{onDragStart:({active:e})=>{e&&this.handleChangeActive(e.id)},onDragEnd:({over:e})=>{if(this.handleChangeActive(void 0),e){const s=a(e.id);l!==s&&n({activeIndex:l,overIndex:s,reorderedItems:(0,tt.Rp)(t,l,s)})}},onDragCancel:()=>this.handleChangeActive(void 0),children:[(0,re.tZ)(tt.Fo,{items:t,strategy:tt.qw,children:t.map(((e,t)=>(0,re.tZ)(dt,{id:e,index:t,renderItem:s,disabled:r,wrapperStyle:i,innerWrapperStyle:o},e)))}),(0,$e.createPortal)((0,re.tZ)(et.y9,{children:e?(0,re.tZ)(st,{value:t[l],renderItem:s,wrapperStyle:i({id:t[l],index:l,isDragging:!0,isSorting:!1}),innerWrapperStyle:o({id:t[l],index:l,isSorting:null!==e,isDragging:!0,overIndex:-1,isDragOverlay:!0})}):null}),document.body)]})}}ct.displayName="DraggableList",(0,d.Z)(ct,"defaultProps",{disabled:!1,wrapperStyle:()=>({}),innerWrapperStyle:()=>({})});const ut=ct;var pt=n("./app/icons/iconGrabbable.tsx");const mt=e=>"\n> * {\n  :nth-child(-n + 5):nth-child(5n - 1) {\n    text-align: center;\n  }\n  @media (max-width: ".concat(e.breakpoints[0],") {\n    :nth-child(5n - 4),\n    :nth-child(5n - 3) {\n      display: none;\n    }\n  }\n}\ngrid-template-columns: 2fr 1.5fr 1fr;\n@media (min-width: ").concat(e.breakpoints[0],") {\n  grid-template-columns: 0.5fr 1.5fr 2fr 1.5fr 1fr;\n}\n@media (min-width: ").concat(e.breakpoints[2],") {\n  grid-template-columns: 0.5fr 2fr 2.5fr 2fr 1.5fr;\n}\n@media (min-width: ").concat(e.breakpoints[3],") {\n  grid-template-columns: 0.5fr 2fr 3fr 2fr 1fr;\n}\n");var ht=n("./app/components/actions/menuItemActionLink.tsx"),Et=n("./app/components/confirm.tsx"),gt=n("./app/components/dropdownLink.tsx"),Rt=n("./app/icons/index.tsx");const _t=(0,a.t)("Are you sure you wish to delete this dynamic sampling rule?"),St=(0,a.t)("You do not have permission to delete dynamic sampling rules."),yt=(0,a.t)("You do not have permission to edit dynamic sampling rules.");function Tt({disabled:e,onEditRule:t,onDeleteRule:n,onOpenMenuActions:s,isMenuActionsOpen:r}){return(0,re.BX)(c.Fragment,{children:[(0,re.BX)(Nt,{gap:1,children:[(0,re.tZ)(U.ZP,{label:(0,a.t)("Edit Rule"),size:"small",onClick:t,icon:(0,re.tZ)(Rt.yl,{}),disabled:e,title:e?yt:void 0}),(0,re.tZ)(Et.Z,{priority:"danger",message:_t,onConfirm:n,disabled:e,children:(0,re.tZ)(U.ZP,{label:(0,a.t)("Delete Rule"),size:"small",icon:(0,re.tZ)(Rt.Fz,{}),title:e?St:void 0})})]}),(0,re.BX)(ft,{caret:!1,customTitle:(0,re.tZ)(U.ZP,{label:(0,a.t)("Actions"),icon:(0,re.tZ)(Rt.YR,{size:"sm"}),size:"xsmall",onClick:s}),isOpen:r,anchorRight:!0,children:[(0,re.tZ)(ht.Z,{shouldConfirm:!1,icon:(0,re.tZ)(Rt.Dj,{size:"xs"}),title:(0,a.t)("Edit"),onClick:e?e=>{null==e||e.stopPropagation()}:t,disabled:e,children:(0,re.tZ)(G.Z,{disabled:!e,title:yt,containerDisplayMode:"block",children:(0,a.t)("Edit")})}),(0,re.tZ)(ht.Z,{onAction:n,message:_t,icon:(0,re.tZ)(Rt.Dj,{size:"xs"}),title:(0,a.t)("Delete"),disabled:e,priority:"danger",shouldConfirm:!0,children:(0,re.tZ)(G.Z,{disabled:!e,title:St,containerDisplayMode:"block",children:(0,a.t)("Delete")})})]})]})}Tt.displayName="Actions";const At=Tt,Nt=(0,P.Z)(z.ZP,{target:"e1a3egcn1"})("justify-content:flex-end;flex:1;display:none;@media (min-width: ",(e=>e.theme.breakpoints[2]),"){display:grid;}"),ft=(0,P.Z)(gt.Z,{target:"e1a3egcn0"})("display:flex;align-items:center;transition:none;@media (min-width: ",(e=>e.theme.breakpoints[2]),"){display:none;}"),Zt=function({condition:e}){function t(e){var t,n;return Array.isArray(e)?(0,re.tZ)(c.Fragment,{children:[...e].map(((t,n)=>{var s,r;return(0,re.BX)(c.Fragment,{children:[(0,re.tZ)(vt,{children:null!==(s=null===(r=I[t])||void 0===r?void 0:r.title)&&void 0!==s?s:t}),n!==e.length-1&&(0,re.tZ)(wt,{children:","})]},t)}))}):(0,re.tZ)(vt,{children:null!==(t=null===(n=I[String(e)])||void 0===n?void 0:n.title)&&void 0!==t?t:String(e)})}switch(e.op){case _.AND:{const{inner:n}=e;return n.length?(0,re.tZ)(bt,{children:n.map((({value:e,name:n},s)=>(0,re.BX)("div",{children:[(0,re.tZ)(xt,{children:O(n)}),t(e)]},s)))}):(0,re.tZ)(xt,{children:(0,a.t)("All")})}default:return v.Tb(new Error("Unknown dynamic sampling condition operator")),null}},bt=(0,P.Z)("div",{target:"e5dv9sd3"})("display:grid;grid-gap:",(0,H.Z)(1.5),";"),xt=(0,P.Z)("span",{target:"e5dv9sd2"})("margin-right:",(0,H.Z)(1),";"),vt=(0,P.Z)("span",{target:"e5dv9sd1"})("word-break:break-all;white-space:pre-wrap;color:",(e=>e.theme.gray300),";"),wt=(0,P.Z)(vt,{target:"e5dv9sd0"})("padding-right:",(0,H.Z)(.5),";");function Ct({sampleRate:e}){return(0,re.tZ)(Ot,{children:"".concat(100*e,"%")})}Ct.displayName="SampleRate";const It=Ct,Ot=(0,P.Z)("div",{target:"e17oa8sb0"})({name:"1h3cbh4",styles:"white-space:pre-wrap;word-break:break-all"}),Vt=function({type:e}){switch(e){case R.ERROR:return(0,re.tZ)(jt,{children:(0,a.t)("Errors only")});case R.TRANSACTION:return(0,re.tZ)(kt,{children:(0,a.t)("Individual transactions")});case R.TRACE:return(0,re.tZ)(kt,{children:(0,a.t)("Transaction traces")});default:return v.Tb(new Error("Unknown dynamic sampling rule type")),null}},jt=(0,P.Z)("div",{target:"enki2wy1"})("color:",(e=>e.theme.pink300),";white-space:pre-wrap;"),kt=(0,P.Z)(jt,{target:"enki2wy0"})("color:",(e=>e.theme.linkColor),";");class Mt extends c.Component{constructor(...e){super(...e),(0,d.Z)(this,"state",{isMenuActionsOpen:!1}),(0,d.Z)(this,"handleChangeMenuAction",(()=>{this.setState((e=>({isMenuActionsOpen:!e.isMenuActionsOpen})))}))}componentDidMount(){this.checkMenuActionsVisibility()}componentDidUpdate(){this.checkMenuActionsVisibility()}checkMenuActionsVisibility(){const{dragging:e,sorting:t}=this.props,{isMenuActionsOpen:n}=this.state;(e||t)&&n&&this.setState({isMenuActionsOpen:!1})}render(){const{rule:e,onEditRule:t,onDeleteRule:n,disabled:s,listeners:r,grabAttributes:i}=this.props,{type:o,condition:l,sampleRate:d}=e,{isMenuActionsOpen:c}=this.state;return(0,re.BX)(Lt,{children:[(0,re.tZ)(Pt,{children:(0,re.tZ)(G.Z,{title:s?(0,a.t)("You do not have permission to reorder dynamic sampling rules."):void 0,children:(0,re.tZ)(zt,{...r,disabled:s,...i,children:(0,re.tZ)(pt.L,{})})})}),(0,re.tZ)(Bt,{children:(0,re.tZ)(Vt,{type:o})}),(0,re.tZ)(Bt,{children:(0,re.tZ)(Zt,{condition:l})}),(0,re.tZ)(Ut,{children:(0,re.tZ)(It,{sampleRate:d})}),(0,re.tZ)(Bt,{children:(0,re.tZ)(At,{onEditRule:t,onDeleteRule:n,disabled:s,onOpenMenuActions:this.handleChangeMenuAction,isMenuActionsOpen:c})})]})}}Mt.displayName="Rule";const Dt=Mt,Lt=(0,P.Z)("div",{target:"el3sh2r4"})("display:grid;align-items:center;",(e=>mt(e.theme)),">*{overflow:visible;:nth-child(5n){justify-content:flex-end;}}"),Bt=(0,P.Z)("div",{target:"el3sh2r3"})("display:flex;align-items:center;padding:",(0,H.Z)(2),";cursor:default;white-space:pre-wrap;word-break:break-all;"),Pt=(0,P.Z)(Bt,{target:"el3sh2r2"})({name:"m8x70k",styles:"cursor:inherit;[role='button']{cursor:grab;}"}),Ut=(0,P.Z)(Bt,{target:"el3sh2r1"})({name:"1gtpzmm",styles:"text-align:center;justify-content:center"}),zt=(0,P.Z)("div",{target:"el3sh2r0"})((e=>e.disabled&&"\n    color: ".concat(e.theme.disabled,";\n    cursor: not-allowed;\n  ")),";outline:none;");class Wt extends c.PureComponent{constructor(...e){super(...e),(0,d.Z)(this,"state",{rules:[]}),(0,d.Z)(this,"handleUpdateRules",(({activeIndex:e,overIndex:t,reorderedItems:n})=>{const{rules:s}=this.state,r=n.map((e=>s.find((t=>String(t.id)===e)))).filter((e=>!!e)),i=s[e].type,o=s[t].type;i!==R.TRACE||o!==R.TRANSACTION?i!==R.TRANSACTION||o!==R.TRACE?this.setState({rules:r}):(0,m.Iw)((0,a.t)("Individual transactions rules cannot be above transaction traces rules")):(0,m.Iw)((0,a.t)("Transaction traces rules cannot be under individual transactions rules"))}))}componentDidMount(){this.getRules()}componentDidUpdate(e){L()(e.rules,this.props.rules)?L()(this.props.rules,this.state.rules)||this.handleUpdateRulesParent():this.getRules()}getRules(){this.setState({rules:this.props.rules})}handleUpdateRulesParent(){const{onUpdateRules:e}=this.props,{rules:t}=this.state;e(t)}render(){const{onEditRule:e,onDeleteRule:t,disabled:n,emptyMessage:s}=this.props,{rules:r}=this.state;return(0,re.tZ)(Ft,{headers:["",(0,a.t)("Type"),(0,a.t)("Conditions"),(0,a.t)("Rate"),""],isEmpty:!r.length,emptyMessage:s,children:(0,re.tZ)(ut,{disabled:n,items:r.map((e=>String(e.id))),onUpdateItems:this.handleUpdateRules,wrapperStyle:({isDragging:e,isSorting:t,index:n})=>e?{cursor:"grabbing"}:t?{}:{transform:"none",transformOrigin:"0","--box-shadow":"none","--box-shadow-picked-up":"none",overflow:"visible",position:"relative",zIndex:r.length-n,cursor:"default"},renderItem:({value:s,listeners:i,attributes:o,dragging:a,sorting:l})=>{const d=r.find((e=>String(e.id)===s));return d?(0,re.tZ)(Dt,{rule:d,onEditRule:e(d),onDeleteRule:t(d),disabled:n,listeners:i,grabAttributes:o,dragging:a,sorting:l}):null}})})}}Wt.displayName="Rules";const Xt=Wt,Ft=(0,P.Z)(o.KB,{target:"e15ewxcp0"})("overflow:visible;margin-bottom:0;border:none;border-bottom-right-radius:0;border-bottom-left-radius:0;",(e=>mt(e.theme)),">*{",Je.Z,";:not(:last-child){border-bottom:1px solid ",(e=>e.theme.border),";}:nth-child(n + 6){",(e=>e.isEmpty?"\n              display: block;\n              grid-column: 1/-1;\n            ":"\n              display: grid;\n              grid-column: 1/-1;\n              padding: 0;\n            "),";}}");function Gt({rules:e,onAddRule:t,onEditRule:n,onDeleteRule:s,onUpdateRules:r,isErrorPanel:i,disabled:l}){const d=i?(0,a.t)("error"):(0,a.t)("transaction");return(0,re.BX)(o.s_,{children:[(0,re.tZ)(Xt,{rules:e,onEditRule:n,onDeleteRule:s,disabled:l,onUpdateRules:r,emptyMessage:(0,a.t)("There are no %s rules to display",d)}),(0,re.tZ)(Ht,{children:(0,re.BX)(Yt,{gap:1,children:[(0,re.tZ)(U.ZP,{href:C,external:!0,children:(0,a.t)("Read the docs")}),(0,re.tZ)(Qt,{priority:"primary",onClick:t,disabled:l,title:l?(0,a.t)("You do not have permission to add dynamic sampling rules."):void 0,children:(0,a.t)("Add %s rule",d)})]})})]})}Gt.displayName="RulesPanel";const qt=Gt,Ht=(0,P.Z)(o.jH,{target:"e1lsth6w2"})("padding:",(0,H.Z)(1)," ",(0,H.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){display:flex;align-items:center;justify-content:flex-end;}"),Yt=(0,P.Z)(z.ZP,{target:"e1lsth6w1"})("@media (max-width: ",(e=>e.theme.breakpoints[0]),"){grid-auto-flow:row;grid-row-gap:",(0,H.Z)(1),";}"),Qt=(0,P.Z)(U.ZP,{target:"e1lsth6w0"})("@media (max-width: ",(e=>e.theme.breakpoints[0]),"){width:100%;}");class Kt extends N.Z{constructor(...e){super(...e),(0,d.Z)(this,"successfullySubmitted",((e,t)=>{this.setState({projectDetails:e}),t&&(0,m.S9)(t)})),(0,d.Z)(this,"handleOpenRule",((e,t)=>()=>{const{organization:n,project:s}=this.props,{errorRules:r,transactionRules:i}=this.state;return(0,h.openModal)((o=>(0,re.tZ)(Ke,{...o,type:e,api:this.api,organization:n,project:s,rule:t,errorRules:r,transactionRules:i,onSubmitSuccess:this.successfullySubmitted})),{modalCss:V})})),(0,d.Z)(this,"handleAddRule",(e=>()=>{"errorRules"!==e?this.handleOpenRule("transaction")():this.handleOpenRule("error")()})),(0,d.Z)(this,"handleEditRule",(e=>()=>{e.type!==R.ERROR?this.handleOpenRule("transaction",e)():this.handleOpenRule("error",e)()})),(0,d.Z)(this,"handleDeleteRule",(e=>()=>{const{errorRules:t,transactionRules:n}=this.state,s=[...e.type===R.ERROR?t.filter((t=>t.id!==e.id)):t,...e.type!==R.ERROR?n.filter((t=>t.id!==e.id)):n];this.submitRules(s,(0,a.t)("Successfully deleted dynamic sampling rule"),(0,a.t)("An error occurred while deleting dynamic sampling rule"))})),(0,d.Z)(this,"handleUpdateRules",(e=>{var t;if(!e.length)return;const{errorRules:n,transactionRules:s}=this.state;(null===(t=e[0])||void 0===t?void 0:t.type)!==R.ERROR?this.submitRules([...n,...e]):this.submitRules([...e,...s])}))}getTitle(){return(0,a.t)("Filters & Sampling")}getDefaultState(){return{...super.getDefaultState(),errorRules:[],transactionRules:[],projectDetails:null}}getEndpoints(){const{organization:e,project:t}=this.props;return[["projectDetails","/projects/".concat(e.slug,"/").concat(t.slug,"/")]]}componentDidMount(){this.getRules()}componentDidUpdate(e,t){t.projectDetails===this.state.projectDetails||this.getRules()}getRules(){var e;const{projectDetails:t}=this.state;if(!t)return;const{dynamicSampling:n}=t,s=null!==(e=null==n?void 0:n.rules)&&void 0!==e?e:[],[r,i]=p()(s,(e=>e.type===R.ERROR));this.setState({errorRules:r,transactionRules:i})}async submitRules(e,t,n){const{organization:s,project:r}=this.props;try{const n=await this.api.requestPromise("/projects/".concat(s.slug,"/").concat(r.slug,"/"),{method:"PUT",data:{dynamicSampling:{rules:e}}});this.successfullySubmitted(n,t)}catch(e){this.getRules(),n&&(0,m.Iw)(n)}}renderBody(){const{errorRules:e,transactionRules:t}=this.state,{hasAccess:n}=this.props,s=!n;return[...e,...t].some((e=>e.condition.op!==_.AND))?(0,re.tZ)(E.Z,{type:"error",children:(0,a.t)("A condition operator has been found that is not yet supported.")}):(0,re.BX)(c.Fragment,{children:[(0,re.tZ)(f.Z,{title:this.getTitle()}),(0,re.tZ)(b.Z,{}),(0,re.tZ)(Z.Z,{children:(0,a._N)("Manage the inbound data you want to store. To change the sampling rate or rate limits, [link:update your SDK configuration]. The rules added below will apply on top of your SDK configuration. Any new rule may take a few minutes to propagate.",{link:(0,re.tZ)(g.Z,{href:C})})}),(0,re.tZ)(qt,{rules:e,disabled:s,onAddRule:this.handleAddRule("errorRules"),onEditRule:this.handleEditRule,onDeleteRule:this.handleDeleteRule,onUpdateRules:this.handleUpdateRules,isErrorPanel:!0}),(0,re.tZ)(Z.Z,{children:(0,a.t)("Rules for traces should precede rules for individual transactions.")}),(0,re.tZ)(qt,{rules:t,disabled:s,onAddRule:this.handleAddRule("transactionRules"),onEditRule:this.handleEditRule,onDeleteRule:this.handleDeleteRule,onUpdateRules:this.handleUpdateRules})]})}}const Jt=(0,A.Z)(Kt),$t=({organization:e,...t})=>(0,re.tZ)(r.Z,{features:["filters-and-sampling"],organization:e,renderDisabled:()=>(0,re.tZ)(i.Z,{alert:o.aU,features:e.features,featureName:(0,a.t)("Filters & Sampling")}),children:(0,re.tZ)(s.Z,{organization:e,access:["project:write"],children:({hasAccess:n})=>(0,re.tZ)(Jt,{...t,hasAccess:n,organization:e})})});$t.displayName="Index";const en=(0,l.Z)($t)},"../node_modules/lodash/_baseDifference.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),r=n("../node_modules/lodash/_arrayIncludes.js"),i=n("../node_modules/lodash/_arrayIncludesWith.js"),o=n("../node_modules/lodash/_arrayMap.js"),a=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,n,d){var c=-1,u=r,p=!0,m=e.length,h=[],E=t.length;if(!m)return h;n&&(t=o(t,a(n))),d?(u=i,p=!1):t.length>=200&&(u=l,p=!1,t=new s(t));e:for(;++c<m;){var g=e[c],R=null==n?g:n(g);if(g=d||0!==g?g:0,p&&R==R){for(var _=E;_--;)if(t[_]===R)continue e;h.push(g)}else u(t,R,d)||h.push(g)}return h}},"../node_modules/lodash/_baseIntersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),r=n("../node_modules/lodash/_arrayIncludes.js"),i=n("../node_modules/lodash/_arrayIncludesWith.js"),o=n("../node_modules/lodash/_arrayMap.js"),a=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js"),d=Math.min;e.exports=function(e,t,n){for(var c=n?i:r,u=e[0].length,p=e.length,m=p,h=Array(p),E=1/0,g=[];m--;){var R=e[m];m&&t&&(R=o(R,a(t))),E=d(R.length,E),h[m]=!n&&(t||u>=120&&R.length>=120)?new s(m&&R):void 0}R=e[0];var _=-1,S=h[0];e:for(;++_<u&&g.length<E;){var y=R[_],T=t?t(y):y;if(y=n||0!==y?y:0,!(S?l(S,T):c(g,T,n))){for(m=p;--m;){var A=h[m];if(!(A?l(A,T):c(e[m],T,n)))continue e}S&&S.push(T),g.push(y)}}return g}},"../node_modules/lodash/_baseXor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_baseDifference.js"),r=n("../node_modules/lodash/_baseFlatten.js"),i=n("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t,n){var o=e.length;if(o<2)return o?i(e[0]):[];for(var a=-1,l=Array(o);++a<o;)for(var d=e[a],c=-1;++c<o;)c!=a&&(l[a]=s(l[a]||d,e[c],t,n));return i(r(l,1),t,n)}},"../node_modules/lodash/_castArrayLikeObject.js":(e,t,n)=>{var s=n("../node_modules/lodash/isArrayLikeObject.js");e.exports=function(e){return s(e)?e:[]}},"../node_modules/lodash/intersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayMap.js"),r=n("../node_modules/lodash/_baseIntersection.js"),i=n("../node_modules/lodash/_baseRest.js"),o=n("../node_modules/lodash/_castArrayLikeObject.js"),a=i((function(e){var t=s(e,o);return t.length&&t[0]===e[0]?r(t):[]}));e.exports=a},"../node_modules/lodash/xor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayFilter.js"),r=n("../node_modules/lodash/_baseRest.js"),i=n("../node_modules/lodash/_baseXor.js"),o=n("../node_modules/lodash/isArrayLikeObject.js"),a=r((function(e){return i(s(e,o))}));e.exports=a}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_filtersAndSampling_index_tsx.649565419b2c0b7ae8b4308ca1dce73a.js.map