"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_projectInstall_newProject_tsx"],{"./app/utils/slugify.tsx":(t,e,a)=>{function s(t){return"string"==typeof t?t.toLowerCase().replace(" ","-"):""}a.d(e,{Z:()=>s}),a("../node_modules/core-js/modules/es.string.replace.js")},"./app/utils/withTeams.tsx":(t,e,a)=>{a.d(e,{Z:()=>i}),a("../node_modules/react/index.js");var s=a("./app/utils/getDisplayName.tsx"),r=a("./app/utils/useTeams.tsx"),o=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const i=t=>{const e=e=>{const{teams:a}=(0,r.Z)();return(0,o.tZ)(t,{teams:a,...e})};return e.displayName="withTeams(".concat((0,s.Z)(t),")"),e}},"./app/views/projectInstall/newProject.tsx":(t,e,a)=>{a.r(e),a.d(e,{default:()=>H});var s=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=a("../node_modules/react-document-title/index.js"),o=a.n(r),i=a("./app/styles/space.tsx"),n=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),l=a("../node_modules/react/index.js"),c=a("../node_modules/react-router/es/index.js"),d=a("../node_modules/@sentry/minimal/esm/index.js"),p=a("../node_modules/platformicons/build/index.js"),m=a("./app/actionCreators/modal.tsx"),u=a("./app/actions/projectActions.tsx"),h=a("./app/components/alert.tsx"),g=a("./app/components/button.tsx"),x=a("./app/components/forms/teamSelector.tsx"),Z=a("./app/components/pageHeading.tsx"),f=a("./app/components/platformPicker.tsx"),j=a("./app/components/tooltip.tsx"),y=a("./app/data/platformCategories.tsx"),v=a("./app/icons/index.tsx"),b=a("./app/locale.tsx"),w=a("./app/styles/input.tsx"),P=a("./app/utils/analytics.tsx"),C=a("./app/utils/getPlatformName.tsx"),_=a("./app/utils/slugify.tsx"),S=a("./app/utils/withApi.tsx"),N=a("./app/utils/withOrganization.tsx"),F=a("./app/utils/withTeams.tsx"),k=a("./app/views/projectInstall/issueAlertOptions.tsx"),T=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class z extends l.Component{constructor(t,e){super(t,e),(0,n.Z)(this,"createProject",(async t=>{t.preventDefault();const{organization:e,api:a}=this.props,{projectName:s,platform:r,team:o,dataFragment:i}=this.state,{slug:n}=e,{shouldCreateCustomRule:l,name:p,conditions:m,actions:h,actionMatch:g,frequency:x,defaultRules:Z}=i||{};this.setState({inFlight:!0}),s||d.$e((t=>{t.setExtra("props",this.props),t.setExtra("state",this.state),d.uT("No project name")}));try{const t=await a.requestPromise("/teams/".concat(n,"/").concat(o,"/projects/"),{method:"POST",data:{name:s,platform:r,default_rules:null==Z||Z}});let i;l&&(i=(await a.requestPromise("/projects/".concat(e.slug,"/").concat(t.slug,"/rules/"),{method:"POST",data:{name:p,conditions:m,actions:h,actionMatch:g,frequency:x}})).id),this.trackIssueAlertOptionSelectedEvent(t,Z,l,i),u.Z.createSuccess(t);const d=r||"other",f="/".concat(e.slug,"/").concat(t.slug,"/getting-started/").concat(d,"/");c.browserHistory.push(f)}catch(t){this.setState({inFlight:!1,error:t.responseJSON.detail}),403!==t.status&&409!==t.status&&d.$e((e=>{e.setExtra("err",t),e.setExtra("props",this.props),e.setExtra("state",this.state),d.uT("Project creation failed")}))}})),(0,n.Z)(this,"setPlatform",(t=>this.setState((({projectName:e,platform:a})=>({platform:t,projectName:!e||a&&(0,C.Z)(a)===e?(0,C.Z)(t)||"":e})))));const{teams:a,location:s}=t,{query:r}=s,o=a.filter((t=>t.hasAccess)),i=r.team||o.length&&o[0].slug,l=(0,C.Z)(r.platform)?r.platform:"";this.state={error:!1,projectName:(0,C.Z)(l)||"",team:i,platform:l,inFlight:!1,dataFragment:void 0}}get defaultCategory(){const{query:t}=this.props.location;return e=t.category,null===(a=y.ZP.find((({id:t})=>t===e)))||void 0===a?void 0:a.id;var e,a}renderProjectForm(){const{organization:t}=this.props,{projectName:e,platform:a,team:s}=this.state,r=(0,T.BX)(B,{onSubmit:this.createProject,children:[(0,T.BX)("div",{children:[(0,T.tZ)(X,{children:(0,b.t)("Project name")}),(0,T.BX)(O,{children:[(0,T.tZ)(E,{platform:null!=a?a:""}),(0,T.tZ)("input",{type:"text",name:"name",placeholder:(0,b.t)("Project name"),autoComplete:"off",value:e,onChange:t=>this.setState({projectName:(0,_.Z)(t.target.value)})})]})]}),(0,T.BX)("div",{children:[(0,T.tZ)(X,{children:(0,b.t)("Team")}),(0,T.BX)(q,{children:[(0,T.tZ)(x.Z,{name:"select-team",clearable:!1,value:s,placeholder:(0,b.t)("Select a Team"),onChange:t=>this.setState({team:t.value}),teamFilter:t=>t.hasAccess}),(0,T.tZ)(j.Z,{title:(0,b.t)("Create a team"),children:(0,T.tZ)(g.ZP,{borderless:!0,"data-test-id":"create-team",type:"button",icon:(0,T.tZ)(v.N_,{isCircled:!0}),onClick:()=>(0,m.openCreateTeamModal)({organization:t,onClose:({slug:t})=>this.setState({team:t})})})})]})]}),(0,T.tZ)("div",{children:(0,T.tZ)(g.ZP,{"data-test-id":"create-project",priority:"primary",disabled:!this.canSubmitForm,children:(0,b.t)("Create Project")})})]});return(0,T.BX)(l.Fragment,{children:[(0,T.tZ)(Z.Z,{withMargins:!0,children:(0,b.t)("Give your project a name")}),r]})}get canSubmitForm(){var t;const{projectName:e,team:a,inFlight:s}=this.state,{shouldCreateCustomRule:r,conditions:o}=this.state.dataFragment||{};return!s&&a&&""!==e&&(!r||(null==o||null===(t=o.every)||void 0===t?void 0:t.call(o,(t=>t.value))))}trackIssueAlertOptionSelectedEvent(t,e,a,s){const{organization:r}=this.props;let o={eventKey:"new_project.alert_rule_selected",eventName:"New Project Alert Rule Selected",organization_id:r.id,project_id:t.id,rule_type:e?"Default":a?"Custom":"No Rule"};void 0!==s&&(o={...o,custom_rule_id:s}),(0,P.ec)(o)}render(){const{platform:t,error:e}=this.state;return(0,T.BX)(l.Fragment,{children:[e&&(0,T.tZ)(h.Z,{type:"error",children:e}),(0,T.BX)("div",{"data-test-id":"onboarding-info",children:[(0,T.tZ)(Z.Z,{withMargins:!0,children:(0,b.t)("Create a new Project")}),(0,T.tZ)(I,{children:(0,b.t)("Projects allow you to scope error and transaction events to a specific\n               application in your organization. For example, you might have separate\n               projects for your API server and frontend client.")}),(0,T.tZ)(Z.Z,{withMargins:!0,children:(0,b.t)("Choose a platform")}),(0,T.tZ)(f.Z,{platform:t,defaultCategory:this.defaultCategory,setPlatform:this.setPlatform,organization:this.props.organization,showOther:!0}),(0,T.tZ)(k.Z,{onChange:t=>{this.setState({dataFragment:t})}}),this.renderProjectForm()]})]})}}z.displayName="CreateProject";const A=(0,S.Z)((0,c.withRouter)((0,N.Z)((0,F.Z)(z)))),B=(0,s.Z)("form",{target:"e1icdt8d5"})("display:grid;grid-template-columns:300px minmax(250px, max-content) max-content;grid-gap:",(0,i.Z)(2),";align-items:end;padding:",(0,i.Z)(3)," 0;box-shadow:0 -1px 0 rgba(0, 0, 0, 0.1);background:",(t=>t.theme.background),";"),X=(0,s.Z)("div",{target:"e1icdt8d4"})("font-size:",(t=>t.theme.fontSizeExtraLarge),";margin-bottom:",(0,i.Z)(1),";"),E=(0,s.Z)(p.v,{target:"e1icdt8d3"})("margin-right:",(0,i.Z)(1),";"),O=(0,s.Z)("div",{target:"e1icdt8d2"})((t=>(0,w.T)(t)),";padding:5px 10px;display:flex;align-items:center;input{background:",(t=>t.theme.background),";border:0;outline:0;flex:1;}"),q=(0,s.Z)("div",{target:"e1icdt8d1"})({name:"1gijyrs",styles:"display:grid;grid-template-columns:1fr min-content;align-items:center"}),I=(0,s.Z)("p",{target:"e1icdt8d0"})("color:",(t=>t.theme.subText),";max-width:760px;"),M=()=>(0,T.tZ)(R,{children:(0,T.tZ)("div",{className:"container",children:(0,T.BX)(D,{children:[(0,T.tZ)(o(),{title:"Sentry"}),(0,T.tZ)(A,{})]})})});M.displayName="NewProject";const R=(0,s.Z)("div",{target:"escx7041"})("flex:1;background:",(t=>t.theme.background),";margin-bottom:-",(0,i.Z)(3),";"),D=(0,s.Z)("div",{target:"escx7040"})("margin-top:",(0,i.Z)(3),";"),H=M}}]);
//# sourceMappingURL=../sourcemaps/app_views_projectInstall_newProject_tsx.d918304ecceb228b96a5cad7f33978c1.js.map