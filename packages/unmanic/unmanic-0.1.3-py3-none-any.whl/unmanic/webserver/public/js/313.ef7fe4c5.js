(self["webpackChunkunmanic_frontend"]=self["webpackChunkunmanic_frontend"]||[]).push([[313],{5313:(e,l,n)=>{"use strict";n.r(l),n.d(l,{default:()=>N});var t=n(3673),a=n(2323);const r={class:"q-pa-none"},i={class:"row"},s={class:"col q-ma-sm"},o={class:"q-pa-md",style:{"max-width":"500px"}},c={class:"q-mb-none"},u={class:"q-gutter-sm"},b={class:"q-mb-none"},d={class:"q-gutter-sm"},y={key:2,class:"sub-setting"},m={class:"q-gutter-sm"},g={class:"q-gutter-sm"},p={class:"q-gutter-sm"},h={class:"q-mb-none"},S={class:"q-gutter-sm"},k={class:"q-mb-none"},w={class:"q-gutter-sm"},f={key:0},_={class:"row"},q=(0,t.Wm)("div",{class:"col-6 text-center"},null,-1),v={class:"col-6 text-center"},W=(0,t.Uk)(" Workers ");function L(e,l,n,L,$,P){const V=(0,t.up)("q-skeleton"),T=(0,t.up)("q-icon"),j=(0,t.up)("q-input"),Q=(0,t.up)("q-separator"),F=(0,t.up)("q-toggle"),O=(0,t.up)("q-btn"),Z=(0,t.up)("q-form"),C=(0,t.up)("q-card"),H=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(H,{padding:""},{default:(0,t.w5)((()=>[(0,t.Wm)("div",r,[(0,t.Wm)("div",i,[(0,t.Wm)("div",s,[(0,t.Wm)("div",o,[(0,t.Wm)(Z,{onSubmit:P.save,class:"q-gutter-md"},{default:(0,t.w5)((()=>[(0,t.Wm)("h5",c,(0,a.zw)(e.$t("components.settings.library.pathConfiguration")),1),(0,t.Wm)("div",u,[null===$.libraryPath?((0,t.wg)(),(0,t.j4)(V,{key:0,type:"QInput"})):((0,t.wg)(),(0,t.j4)(j,{key:1,readonly:"",outlined:"",color:"primary",modelValue:$.libraryPath,"onUpdate:modelValue":l[1]||(l[1]=e=>$.libraryPath=e),label:e.$t("components.settings.library.path"),placeholder:$.libraryPath,onClick:P.updateLibraryWithDirectoryBrowser},{append:(0,t.w5)((()=>[(0,t.Wm)(T,{onClick:P.updateLibraryWithDirectoryBrowser,class:"cursor-pointer",name:"folder_open"},null,8,["onClick"])])),_:1},8,["modelValue","label","placeholder","onClick"]))]),(0,t.Wm)(Q,{class:"q-my-lg"}),(0,t.Wm)("h5",b,(0,a.zw)(e.$t("components.settings.library.libraryScanner")),1),(0,t.Wm)("div",d,[null===$.enableLibraryScanner?((0,t.wg)(),(0,t.j4)(V,{key:0,type:"QToggle"})):((0,t.wg)(),(0,t.j4)(F,{key:1,modelValue:$.enableLibraryScanner,"onUpdate:modelValue":l[2]||(l[2]=e=>$.enableLibraryScanner=e),label:e.$t("components.settings.library.enableLibraryScanner")},null,8,["modelValue","label"])),$.enableLibraryScanner?((0,t.wg)(),(0,t.j4)("div",y,[(0,t.Wm)("div",m,[null===$.libraryScanSchedule?((0,t.wg)(),(0,t.j4)(V,{key:0,type:"QInput"})):(0,t.kq)("",!0),$.enableLibraryScanner&&null!==$.libraryScanSchedule?((0,t.wg)(),(0,t.j4)(j,{key:1,outlined:"",type:"number",modelValue:$.libraryScanSchedule,"onUpdate:modelValue":l[3]||(l[3]=e=>$.libraryScanSchedule=e),label:e.$t("components.settings.library.libraryScannerSchedule"),"lazy-rules":"",rules:[l=>null!==l&&""!==l||e.$t("components.settings.library.libraryScannerScheduleNotValid"),l=>l>0||e.$t("components.settings.pleaseEnterAValidNumber")]},null,8,["modelValue","label","rules"])):(0,t.kq)("",!0)])])):(0,t.kq)("",!0)]),(0,t.Wm)("div",g,[null===$.runLibraryScanOnStart?((0,t.wg)(),(0,t.j4)(V,{key:0,type:"QToggle"})):(0,t.kq)("",!0),null!==$.runLibraryScanOnStart?((0,t.wg)(),(0,t.j4)(F,{key:1,modelValue:$.runLibraryScanOnStart,"onUpdate:modelValue":l[4]||(l[4]=e=>$.runLibraryScanOnStart=e),label:e.$t("components.settings.library.runLibraryScanOnStart")},null,8,["modelValue","label"])):(0,t.kq)("",!0)]),(0,t.Wm)("div",p,[null===$.libraryScanFollowSymlinks?((0,t.wg)(),(0,t.j4)(V,{key:0,type:"QToggle"})):(0,t.kq)("",!0),null!==$.libraryScanFollowSymlinks?((0,t.wg)(),(0,t.j4)(F,{key:1,modelValue:$.libraryScanFollowSymlinks,"onUpdate:modelValue":l[5]||(l[5]=e=>$.libraryScanFollowSymlinks=e),label:e.$t("components.settings.library.followSymlinks")},null,8,["modelValue","label"])):(0,t.kq)("",!0)]),(0,t.Wm)(Q,{class:"q-my-lg"}),(0,t.Wm)("h5",h,(0,a.zw)(e.$t("components.settings.library.fileMonitor")),1),(0,t.Wm)("div",S,[null===$.enableLibraryFileMonitor?((0,t.wg)(),(0,t.j4)(V,{key:0,type:"QToggle"})):((0,t.wg)(),(0,t.j4)(F,{key:1,modelValue:$.enableLibraryFileMonitor,"onUpdate:modelValue":l[6]||(l[6]=e=>$.enableLibraryFileMonitor=e),label:e.$t("components.settings.library.enableLibraryFileMonitor")},null,8,["modelValue","label"]))]),(0,t.Wm)(Q,{class:"q-my-lg"}),(0,t.Wm)("h5",k,(0,a.zw)(e.$t("components.settings.library.pendingTasks")),1),(0,t.Wm)("div",w,[null===$.clearPendingTasksOnStart?((0,t.wg)(),(0,t.j4)(V,{key:0,type:"QToggle"})):((0,t.wg)(),(0,t.j4)(F,{key:1,modelValue:$.clearPendingTasksOnStart,"onUpdate:modelValue":l[7]||(l[7]=e=>$.clearPendingTasksOnStart=e),label:e.$t("components.settings.library.clearPendingTasksOnStart")},null,8,["modelValue","label"]))]),(0,t.Wm)("div",null,[(0,t.Wm)(O,{label:e.$t("navigation.submit"),type:"submit",color:"secondary"},null,8,["label"])])])),_:1},8,["onSubmit"])])])]),e.$q.platform.is.mobile?((0,t.wg)(),(0,t.j4)("div",f,[(0,t.Wm)(Q,{class:"q-mb-lg"}),(0,t.Wm)("div",_,[q,(0,t.Wm)("div",v,[(0,t.Wm)(C,{flat:"",bordered:"",onClick:l[8]||(l[8]=l=>e.$router.push("/ui/settings-workers")),class:"bg-grey-1 q-ma-xs"},{default:(0,t.w5)((()=>[(0,t.Wm)(O,{"icon-right":"navigate_next",flat:""},{default:(0,t.w5)((()=>[W])),_:1})])),_:1})])])])):(0,t.kq)("",!0)])])),_:1})}var $=n(4190),P=n(1959),V=n(8825),T=n(5948),j=n(1536),Q=n(52),F=n.n(Q),O=n(7689);const Z={name:"SettingsLibrary",setup(){(0,V.Z)();const{t:e}=(0,T.QT)();let l=null,n=(0,$.A)(e);function a(){l=n.init()}function r(){n.close()}(0,t.bv)((()=>{a()})),(0,t.Ah)((()=>{r()}))},data(){return{libraryPath:(0,P.iH)(null),enableLibraryScanner:(0,P.iH)(null),libraryScanSchedule:(0,P.iH)(null),libraryScanFollowSymlinks:(0,P.iH)(null),runLibraryScanOnStart:(0,P.iH)(null),enableLibraryFileMonitor:(0,P.iH)(null),clearPendingTasksOnStart:(0,P.iH)(null)}},methods:{updateLibraryWithDirectoryBrowser:function(){this.$q.dialog({component:j.Z,componentProps:{dialogHeader:this.$t("headers.selectDirectory"),initialPath:this.libraryPath,listType:"directories"}}).onOk((e=>{"undefined"!==typeof e.selectedPath&&null!==e.selectedPath&&(this.libraryPath=e.selectedPath)})).onDismiss((()=>{}))},fetchSettings:function(){F()({method:"get",url:(0,O.J4)("v2","settings/read")}).then((e=>{this.libraryPath=e.data.settings.library_path,this.enableLibraryScanner=e.data.settings.enable_library_scanner,this.libraryScanSchedule=e.data.settings.schedule_full_scan_minutes,this.libraryScanFollowSymlinks=e.data.settings.follow_symlinks,this.runLibraryScanOnStart=e.data.settings.run_full_scan_on_start,this.enableLibraryFileMonitor=e.data.settings.enable_inotify,this.clearPendingTasksOnStart=e.data.settings.clear_pending_tasks_on_restart})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToFetchSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))},save:function(){let e={settings:{library_path:this.libraryPath,enable_library_scanner:this.enableLibraryScanner,schedule_full_scan_minutes:this.libraryScanSchedule,follow_symlinks:this.libraryScanFollowSymlinks,run_full_scan_on_start:this.runLibraryScanOnStart,enable_inotify:this.enableLibraryFileMonitor,clear_pending_tasks_on_restart:this.clearPendingTasksOnStart}};F()({method:"post",url:(0,O.J4)("v2","settings/write"),data:e}).then((e=>{this.fetchSettings(),this.$q.notify({color:"positive",position:"top",icon:"cloud_done",message:this.$t("notifications.saved"),timeout:200})})).catch((()=>{this.$q.notify({color:"negative",position:"top",message:this.$t("notifications.failedToSaveSettings"),icon:"report_problem",actions:[{icon:"close",color:"white"}]})}))}},created(){this.fetchSettings()}};var C=n(4379),H=n(5269),M=n(4103),U=n(4842),x=n(4554),z=n(5869),D=n(8886),B=n(2165),I=n(151),A=n(7518),J=n.n(A);Z.render=L;const N=Z;J()(Z,"components",{QPage:C.Z,QForm:H.Z,QSkeleton:M.ZP,QInput:U.Z,QIcon:x.Z,QSeparator:z.Z,QToggle:D.Z,QBtn:B.Z,QCard:I.Z})}}]);