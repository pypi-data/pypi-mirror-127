(self.webpackChunkatoti_jupyterlab=self.webpackChunkatoti_jupyterlab||[]).push([[846],{10846:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var l=s(39030),n=s(56271),a=s.n(n),o=s(53521),c=s(7560),r=s(98537),i=s.n(r),u=s(2689),d=s.n(u),p=s(95479),m=s(13423);const b=e=>{const t=[];return e.forEach((e=>{const s=e.name;t.includes(s)||(e.showlegend=!0,t.push(s))})),e};function h({cube:e,data:t,metaData:s,widgetState:{colors:l,isTextVisible:n,mapping:a,opacity:c=1}}){if(!e||!t||!s)return[];const r={},u={},m={mapping:{},numberOfUsedAutomaticColors:0},{attributesRedirection:h}=s,y=a.size.length>0;let g=0;const x=a.horizontalSubplots.length+a.verticalSubplots.length>0;(0,p.IG)(t,s.hierarchyIndicesInCellSet,(({cell:e,cellIndex:t,columnIndex:d,tuple:p,rowIndex:b})=>{if(p){const y=(0,o._F)(p,{levelIndices:s.levelIndicesPerField,mapping:a,attributesRedirection:h}),x=[...y.color,...y.horizontalSubplots,...y.verticalSubplots],I=y.splitBy,f=(({membersPerAttribute:e,pointKey:t,traceKey:a})=>(u[a]||(u[a]=function({traceKey:e,membersPerAttribute:t}){const a=(0,o.Ym)(t.color,0),r=Object.values(u).some((e=>e.name===a)),i=(0,o.he)({accumulator:m,colorway:s.colorway,colors:l,traceName:a});return{_key:e,hoverinfo:"none",legendgroup:a,mode:n?"text+markers":"markers",name:a,cellsIndices:[],showlegend:!r,text:[],textposition:"top center",type:"scatter",marker:{size:[],color:i},x:[],y:[],opacity:c}}({traceKey:a,membersPerAttribute:e})),i()(r,{[a]:{[t]:{}}}),r[a][t]))({membersPerAttribute:y,traceKey:(0,o.Lj)(x),pointKey:(0,o.Lj)(I)});if(f.cellsIndices||(f.cellsIndices=[]),null!==t&&f.cellsIndices.push({rowIndex:b,columnIndex:d,cellIndex:t}),e){const t=e.value;if(y.xValues.length>0)f.x=t;else if(y.yValues.length>0)f.y=t;else if(y.size.length>0){const e=Math.abs(t);f.size=e,e>g&&(g=e)}y.splitBy.length>0&&(f.text=(0,o.KT)(y.splitBy))}}})),Object.entries(u).forEach((([e,t])=>{const s=r[e];y||(t.marker.size=15),Object.values(s).forEach((e=>{const{cellsIndices:s,x:l,y:n,size:a,text:o}=e;t.cellsIndices.push(s),t.x.push(l),t.y.push(n),t.text.push(o),y&&t.marker.size.push(100*a/g)}))}));const I=Object.values(u);if(I.forEach((e=>{var t;e.axisIndices=d()(null===(t=e.x)||void 0===t?void 0:t.length)})),x){const e=s.subplots,t=(0,o.$)({traces:I,subplotsMetaData:e});return(0,o.Mr)(t,e),b(t),t}return b(I),I}const y=(0,o.dC)((0,o.i)((0,o.H9)((0,n.memo)((e=>{const{cube:t,data:s,metaData:r,widgetState:i,onLoaded:u}=e,d=(0,n.useMemo)((()=>(0,l.TS)(null==i?void 0:i.mapping)),[null==i?void 0:i.mapping]);(0,o.ge)({isEmpty:d,onLoaded:u});const p=(0,n.useMemo)((()=>h({cube:t,data:s,metaData:r,widgetState:i})),[t,s,r,i]),b=(0,n.useMemo)((()=>(e=>e?(0,m.IM)(o.bR,(0,o.S5)(e.subplots),(0,o.lH)(e.subplots)):{})(r)),[r]);return t&&s&&r&&!d?a().createElement(o.XN,(0,c.Z)({},e,{traces:p,layout:b,cube:t,data:s,metaData:r})):a().createElement(o.MQ,null)})))))}}]);